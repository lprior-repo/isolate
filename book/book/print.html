<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>ZJJ Documentation</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="Parallel Workspace Isolation + Queue Coordination for JJ + Zellij">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ae938929.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/custom-7ff75201.css">
        <link rel="stylesheet" href="theme/stripe-ac131f9c.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex-e337e4e4.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-5719c151.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>‚Üê</kbd> or <kbd>‚Üí</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">ZJJ Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>
                        <a href="https://github.com/lprior-repo/zjj" title="Git repository" aria-label="Git repository">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <h1 id="zjj--parallel-workspace-isolation--queue-coordination"><a class="header" href="#zjj--parallel-workspace-isolation--queue-coordination">ZJJ ‚Äî Parallel Workspace Isolation + Queue Coordination</a></h1>
<div class="hero">
  
<h1>ZJJ</h1>

  
<p>Run multiple parallel workstreams (humans or AI agents) against a single repo without stepping on each other.</p>

</div>

<h2 id="what-is-zjj"><a class="header" href="#what-is-zjj">What is ZJJ?</a></h2>
<p>ZJJ combines three powerful tools to enable <strong>safe parallel development</strong>:</p>
<ul>
<li><strong>JJ (Jujutsu) workspaces</strong> for hard isolation</li>
<li><strong>Zellij</strong> tabs/sessions for fast context switching</li>
<li>A <strong>SQLite-backed state + merge/processing queue</strong> for coordination, retries, and recovery</li>
</ul>
<p>If you want ‚Äúrun 6‚Äì12 coding agents safely‚Äù <em>or</em> ‚Äúwork on 5 features at once without trashing main,‚Äù ZJJ is for that.</p>
<hr>
<h2 id="why-zjj-exists"><a class="header" href="#why-zjj-exists">Why ZJJ Exists</a></h2>
<p>Parallel work is easy to start and hard to finish cleanly:</p>
<ul>
<li>üë• two workers edit the same area ‚Üí conflicts</li>
<li>üìù multiple tasks get half-done ‚Üí you lose track</li>
<li>ü§∑ ‚Äúwho is working on what?‚Äù becomes tribal knowledge</li>
<li>ü§ñ agents can duplicate work or race each other</li>
</ul>
<p>ZJJ fixes this by making parallelism <strong>explicit, isolated, and coordinated</strong>.</p>
<div class="features">
  
<div class="feature">
    
<div class="feature-icon">üîí</div>

    
<h3>Workspace Isolation</h3>

    
<p>Each task gets its own JJ workspace and Zellij tab. No more context switching pain or accidental conflicts.</p>

  </div>

  
<div class="feature">
    
<div class="feature-icon">üìã</div>

    
<h3>Queue Coordination</h3>

    
<p>SQLite-backed merge queue ensures only one worker claims a given entry at a time. Built-in retries and recovery.</p>

  </div>

  
<div class="feature">
    
<div class="feature-icon">‚ö°</div>

    
<h3>Fast Switching</h3>

    
<p>Jump between workspaces instantly with Zellij integration. Keep your flow state.</p>

  </div>

  
<div class="feature">
    
<div class="feature-icon">ü§ñ</div>

    
<h3>AI-First Design</h3>

    
<p>Run 6-12 AI agents in parallel, each in isolated workspaces with queue-based coordination.</p>

  </div>

</div>

<hr>
<h2 id="before--after"><a class="header" href="#before--after">Before &amp; After</a></h2>
<p><strong>Before</strong>: 6 agents race on the same working copy ‚Üí duplicated effort + conflicts</p>
<p><strong>After</strong>: each agent gets an isolated workspace + the queue enforces safe claiming/landing</p>
<hr>
<h2 id="mental-model"><a class="header" href="#mental-model">Mental Model</a></h2>
<p>ZJJ has three core concepts:</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Concept</th><th>What It Is</th><th>Example</th></tr>
</thead>
<tbody>
<tr><td><strong>Session</strong></td><td>Named isolated workspace (+ optional bead/issue) + optional Zellij tab</td><td><code>zjj add auth-refactor --bead BD-123</code></td></tr>
<tr><td><strong>Queue entry</strong></td><td>Unit of work tied to a workspace that a worker/agent can claim and process</td><td><code>zjj queue --add feature-a --bead BD-101 --priority 3</code></td></tr>
<tr><td><strong>Done</strong></td><td>Finish the work and land it back to main</td><td><code>zjj done</code></td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="quick-example"><a class="header" href="#quick-example">Quick Example</a></h2>
<pre><code class="language-bash"># 1) inside a JJ repo
zjj init

# 2) create an isolated session
zjj add auth-refactor --bead BD-123

# 3) jump into it (Zellij tab)
zjj focus auth-refactor

# 4) keep it synced with main
zjj sync auth-refactor

# 5) finish and land the work
zjj done

# 6) optionally clean it up
zjj remove auth-refactor
</code></pre>
<hr>
<h2 id="multi-agent-example"><a class="header" href="#multi-agent-example">Multi-Agent Example</a></h2>
<pre><code class="language-bash"># Add multiple work items
zjj queue --add feature-a --bead BD-101 --priority 3
zjj queue --add feature-b --bead BD-102 --priority 5 --agent agent-002

# Start workers (these can be human-driven or agent-driven wrappers)
zjj queue worker --loop
</code></pre>
<p>ZJJ ensures only one worker claims a given entry at a time, and provides:</p>
<ul>
<li>‚úÖ retries for failures</li>
<li>‚úÖ cancel/remove operations</li>
<li>‚úÖ reclaiming stale leases when workers crash</li>
</ul>
<hr>
<h2 id="next-steps"><a class="header" href="#next-steps">Next Steps</a></h2>
<div class="quickstart-cards">
  
<div class="card">
    
<h4>üöÄ Quick Start</h4>

    
<p>Get up and running in 5 minutes</p>

    <a href="#quick-start">Start Here ‚Üí</a>
  </div>

  
<div class="card">
    
<h4>üìñ User Guide</h4>

    
<p>Learn workspace management and queue coordination</p>

    <a href="#workspace-management">Read the Guide ‚Üí</a>
  </div>

  
<div class="card">
    
<h4>ü§ñ AI Agents</h4>

    
<p>Set up AI agents for parallel development</p>

    <a href="#ai-agent-overview">AI Guide ‚Üí</a>
  </div>

  
<div class="card">
    
<h4>üìö Reference</h4>

    
<p>Complete command and API reference</p>

    <a href="#command-reference">Browse Docs ‚Üí</a>
  </div>

</div>

<hr>
<h2 id="key-features"><a class="header" href="#key-features">Key Features</a></h2>
<ul>
<li>‚ú® <strong>Isolated Workspaces</strong>: Each task in its own JJ workspace</li>
<li>üîÑ <strong>Smart Syncing</strong>: Keep workspaces in sync with main</li>
<li>üìä <strong>Queue Management</strong>: Claim, process, complete work items</li>
<li>üéØ <strong>Bead Integration</strong>: Track issues through the workflow</li>
<li>üîç <strong>Status Visibility</strong>: Know exactly what‚Äôs happening where</li>
<li>üé® <strong>Zellij Integration</strong>: Fast tab switching between workspaces</li>
<li>üõ°Ô∏è <strong>Recovery</strong>: Built-in corruption detection and recovery</li>
<li>ü§ñ <strong>AI-Ready</strong>: Designed for multi-agent parallel workflows</li>
<li>üì¶ <strong>SQLite Backend</strong>: Reliable, simple, local state management</li>
<li>üîê <strong>Safe Parallelism</strong>: No conflicts, no trampling</li>
</ul>
<hr>
<h2 id="who-should-use-zjj"><a class="header" href="#who-should-use-zjj">Who Should Use ZJJ?</a></h2>
<ul>
<li><strong>Solo developers</strong> managing multiple features simultaneously</li>
<li><strong>Teams</strong> coordinating parallel work streams</li>
<li><strong>AI agents</strong> running automated coding workflows</li>
<li><strong>Open source maintainers</strong> juggling multiple PRs</li>
<li><strong>Anyone</strong> tired of git branch confusion and merge conflicts</li>
</ul>
<hr>
<h2 id="license"><a class="header" href="#license">License</a></h2>
<p>MIT License - see <a href="https://github.com/lprior-repo/zjj/blob/main/LICENSE">LICENSE</a> for details.</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="quick-start"><a class="header" href="#quick-start">Quick Start</a></h1>
<p>Get up and running with ZJJ in 5 minutes.</p>
<hr>
<h2 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h2>
<p>Before you start, make sure you have:</p>
<ul>
<li>‚úÖ <strong>JJ (Jujutsu)</strong> - <a href="https://github.com/martinvonz/jj#installation">Install from here</a></li>
<li>‚úÖ <strong>Zellij</strong> - <a href="https://zellij.dev/download">Install from here</a></li>
<li>‚úÖ <strong>Rust</strong> 1.80 or later - <a href="https://rustup.rs/">Install from here</a></li>
</ul>
<div class="info">
üí° <strong>Tip</strong>: ZJJ requires a JJ repository to work. If you don't have one yet, run <code>jj init</code> in your project directory.
</div>

<hr>
<h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<h3 id="option-1-from-source-recommended"><a class="header" href="#option-1-from-source-recommended">Option 1: From Source (Recommended)</a></h3>
<pre><code class="language-bash"># Clone the repository
git clone https://github.com/lprior-repo/zjj.git
cd zjj

# Install Moon (if not already installed)
curl -fsSL https://moonrepo.dev/install/moon.sh | bash

# Build with Moon
moon run :build

# Install the binary
moon run :install

# Verify installation
zjj --version
</code></pre>
<h3 id="option-2-from-cratesio"><a class="header" href="#option-2-from-cratesio">Option 2: From crates.io</a></h3>
<pre><code class="language-bash">cargo install zjj
</code></pre>
<div class="warning">
‚ö†Ô∏è <strong>Note</strong>: The crates.io version may lag behind the latest features. Building from source is recommended for the best experience.
</div>

<hr>
<h2 id="60-second-workflow"><a class="header" href="#60-second-workflow">60-Second Workflow</a></h2>
<p>Here‚Äôs a complete workflow from start to finish:</p>
<h3 id="1-initialize-zjj"><a class="header" href="#1-initialize-zjj">1. Initialize ZJJ</a></h3>
<pre><code class="language-bash"># Inside a JJ repository
zjj init
</code></pre>
<p>This creates the <code>.zjj/</code> directory with the state database.</p>
<h3 id="2-create-an-isolated-session"><a class="header" href="#2-create-an-isolated-session">2. Create an Isolated Session</a></h3>
<pre><code class="language-bash"># Create a session for your work
zjj add auth-refactor --bead BD-123
</code></pre>
<p>This creates:</p>
<ul>
<li>A new JJ workspace named <code>auth-refactor</code></li>
<li>A Zellij tab for this workspace</li>
<li>Optional association with bead/issue <code>BD-123</code></li>
</ul>
<h3 id="3-jump-into-your-workspace"><a class="header" href="#3-jump-into-your-workspace">3. Jump Into Your Workspace</a></h3>
<pre><code class="language-bash"># Switch to the session's Zellij tab
zjj focus auth-refactor
</code></pre>
<p>Or check where you are:</p>
<pre><code class="language-bash">zjj whereami
# Output: workspace:auth-refactor
</code></pre>
<h3 id="4-do-your-work"><a class="header" href="#4-do-your-work">4. Do Your Work</a></h3>
<p>Make changes in your isolated workspace. Your main branch stays clean!</p>
<pre><code class="language-bash"># Edit files
vim src/auth.rs

# Check status
zjj status auth-refactor
</code></pre>
<h3 id="5-keep-synced-with-main"><a class="header" href="#5-keep-synced-with-main">5. Keep Synced with Main</a></h3>
<pre><code class="language-bash"># Rebase your workspace onto main
zjj sync auth-refactor
</code></pre>
<p>This keeps your workspace up to date with the latest changes from main.</p>
<h3 id="6-complete-and-land-your-work"><a class="header" href="#6-complete-and-land-your-work">6. Complete and Land Your Work</a></h3>
<pre><code class="language-bash"># Finish and merge to main
zjj done
</code></pre>
<p>This:</p>
<ul>
<li>Merges your changes to main</li>
<li>Pushes to remote (if configured)</li>
<li>Cleans up the workspace</li>
</ul>
<h3 id="7-clean-up-optional"><a class="header" href="#7-clean-up-optional">7. Clean Up (Optional)</a></h3>
<pre><code class="language-bash"># Remove the session
zjj remove auth-refactor
</code></pre>
<hr>
<h2 id="multi-agent-quick-start"><a class="header" href="#multi-agent-quick-start">Multi-Agent Quick Start</a></h2>
<p>Want to run multiple agents in parallel? Here‚Äôs how:</p>
<h3 id="1-add-work-items-to-the-queue"><a class="header" href="#1-add-work-items-to-the-queue">1. Add Work Items to the Queue</a></h3>
<pre><code class="language-bash">zjj queue --add feature-a --bead BD-101 --priority 3
zjj queue --add feature-b --bead BD-102 --priority 5
zjj queue --add feature-c --bead BD-103 --priority 1
</code></pre>
<h3 id="2-list-queue-items"><a class="header" href="#2-list-queue-items">2. List Queue Items</a></h3>
<pre><code class="language-bash">zjj queue --list
</code></pre>
<h3 id="3-start-a-queue-worker"><a class="header" href="#3-start-a-queue-worker">3. Start a Queue Worker</a></h3>
<pre><code class="language-bash"># Run once
zjj queue worker --once

# Or run continuously
zjj queue worker --loop
</code></pre>
<h3 id="4-monitor-progress"><a class="header" href="#4-monitor-progress">4. Monitor Progress</a></h3>
<pre><code class="language-bash"># Check queue status
zjj queue --status
</code></pre>
<hr>
<h2 id="common-commands"><a class="header" href="#common-commands">Common Commands</a></h2>
<p>Here are the commands you‚Äôll use most:</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Command</th><th>What It Does</th></tr>
</thead>
<tbody>
<tr><td><code>zjj whereami</code></td><td>Check current location (main or workspace)</td></tr>
<tr><td><code>zjj add &lt;name&gt;</code></td><td>Create new session + workspace + tab</td></tr>
<tr><td><code>zjj list</code></td><td>List all sessions</td></tr>
<tr><td><code>zjj status [name]</code></td><td>Show detailed session status</td></tr>
<tr><td><code>zjj focus &lt;name&gt;</code></td><td>Switch to session‚Äôs Zellij tab</td></tr>
<tr><td><code>zjj sync [name]</code></td><td>Rebase workspace onto main</td></tr>
<tr><td><code>zjj done</code></td><td>Complete work and merge to main</td></tr>
<tr><td><code>zjj remove &lt;name&gt;</code></td><td>Remove session and workspace</td></tr>
</tbody>
</table>
</div>
<div class="note">
‚ú® <strong>Pro Tip</strong>: All commands support <code>--json</code> for machine-readable output!
</div>

<hr>
<h2 id="keyboard-shortcuts"><a class="header" href="#keyboard-shortcuts">Keyboard Shortcuts</a></h2>
<p>When working with Zellij:</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Shortcut</th><th>Action</th></tr>
</thead>
<tbody>
<tr><td><code>Ctrl+p</code> then <code>t</code></td><td>New tab</td></tr>
<tr><td><code>Ctrl+p</code> then <code>n</code></td><td>Next tab</td></tr>
<tr><td><code>Ctrl+p</code> then <code>h/l</code></td><td>Navigate tabs</td></tr>
<tr><td><code>Ctrl+p</code> then <code>w</code></td><td>Close tab</td></tr>
</tbody>
</table>
</div>
<div class="info">
üí° <strong>Tip</strong>: Use <code>zjj focus &lt;name&gt;</code> to jump directly to a session's tab instead of navigating manually.
</div>

<hr>
<h2 id="configuration"><a class="header" href="#configuration">Configuration</a></h2>
<p>ZJJ stores configuration in <code>.zjj/config.toml</code>. You can modify it directly or use:</p>
<pre><code class="language-bash"># View configuration
zjj config

# Set a value
zjj config key value
</code></pre>
<h3 id="common-settings"><a class="header" href="#common-settings">Common Settings</a></h3>
<pre><code class="language-toml">[recovery]
policy = "warn"  # Options: silent, warn, fail-fast
log_recovered = true

[queue]
default_priority = 5
stale_timeout_seconds = 3600
</code></pre>
<hr>
<h2 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h2>
<h3 id="database-corruption-detected"><a class="header" href="#database-corruption-detected">‚ÄúDatabase corruption detected‚Äù</a></h3>
<p>ZJJ has built-in recovery. Check <code>.zjj/recovery.log</code> for details.</p>
<pre><code class="language-bash">zjj doctor
</code></pre>
<h3 id="not-in-a-jj-repository"><a class="header" href="#not-in-a-jj-repository">‚ÄúNot in a JJ repository‚Äù</a></h3>
<p>Make sure you‚Äôre in a JJ repository:</p>
<pre><code class="language-bash">jj init  # If starting fresh
# or
jj git clone &lt;url&gt;  # If cloning an existing repo
</code></pre>
<h3 id="zellij-not-found"><a class="header" href="#zellij-not-found">‚ÄúZellij not found‚Äù</a></h3>
<p>Install Zellij:</p>
<pre><code class="language-bash"># macOS
brew install zellij

# Linux
cargo install zellij

# Or download from https://zellij.dev/download
</code></pre>
<hr>
<h2 id="next-steps-1"><a class="header" href="#next-steps-1">Next Steps</a></h2>
<p>Now that you‚Äôre set up, explore:</p>
<ul>
<li><strong><a href="#workspace-management">Workspace Management</a></strong> - Deep dive into sessions</li>
<li><strong><a href="#queue-coordination">Queue Coordination</a></strong> - Learn queue operations</li>
<li><strong><a href="#ai-agent-overview">AI Agent Guide</a></strong> - Set up AI agents</li>
<li><strong><a href="#command-reference">Command Reference</a></strong> - Complete command list</li>
</ul>
<hr>
<h2 id="getting-help"><a class="header" href="#getting-help">Getting Help</a></h2>
<ul>
<li>üìñ Read the <a href="#workspace-management">User Guide</a></li>
<li>üêõ <a href="https://github.com/lprior-repo/zjj/issues">Report issues</a></li>
<li>üí¨ <a href="https://github.com/lprior-repo/zjj/discussions">Discussions</a></li>
<li>üìß <a href="mailto:lewis@example.com">Email support</a></li>
</ul>
<hr>
<div class="page-footer">
  
<p>Ready to dive deeper? Check out the <a href="#workspace-management">User Guide</a>.</p>

</div>

<div style="break-before: page; page-break-before: always;"></div>
<h1 id="installation-1"><a class="header" href="#installation-1">Installation</a></h1>
<p>This guide covers installing ZJJ and its prerequisites.</p>
<hr>
<h2 id="prerequisites-1"><a class="header" href="#prerequisites-1">Prerequisites</a></h2>
<p>Before installing ZJJ, you need:</p>
<h3 id="required-tools"><a class="header" href="#required-tools">Required Tools</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Tool</th><th>Purpose</th><th>Installation Link</th></tr>
</thead>
<tbody>
<tr><td><strong>JJ (Jujutsu)</strong></td><td>Version control</td><td><a href="https://github.com/martinvonz/jj#installation">Install JJ</a></td></tr>
<tr><td><strong>Zellij</strong></td><td>Terminal multiplexer</td><td><a href="https://zellij.dev/download">Install Zellij</a></td></tr>
<tr><td><strong>Rust</strong> 1.80+</td><td>Build toolchain</td><td><a href="https://rustup.rs/">Install Rust</a></td></tr>
</tbody>
</table>
</div>
<h3 id="optional-tools"><a class="header" href="#optional-tools">Optional Tools</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Tool</th><th>Purpose</th><th>Installation Link</th></tr>
</thead>
<tbody>
<tr><td><strong>Moon</strong></td><td>Build system (for development)</td><td><a href="https://moonrepo.dev/docs/install">Install Moon</a></td></tr>
<tr><td><strong>bazel-remote</strong></td><td>Local caching (for development)</td><td>See setup below</td></tr>
</tbody>
</table>
</div>
<div class="info">
üí° <strong>Tip</strong>: If you're just using ZJJ, you only need JJ, Zellij, and Rust. Moon and bazel-remote are only needed if you're building from source or contributing.
</div>

<hr>
<h2 id="installation-options"><a class="header" href="#installation-options">Installation Options</a></h2>
<h3 id="option-1-from-source-recommended-1"><a class="header" href="#option-1-from-source-recommended-1">Option 1: From Source (Recommended)</a></h3>
<p>This gives you the latest features and allows you to contribute.</p>
<pre><code class="language-bash"># Clone the repository
git clone https://github.com/lprior-repo/zjj.git
cd zjj

# Install Moon (if not already installed)
curl -fsSL https://moonrepo.dev/install/moon.sh | bash

# Build with Moon
moon run :build

# Install the binary
moon run :install

# Or copy manually
sudo cp target/release/zjj /usr/local/bin/

# Verify installation
zjj --version
</code></pre>
<h3 id="option-2-from-cratesio-1"><a class="header" href="#option-2-from-cratesio-1">Option 2: From crates.io</a></h3>
<pre><code class="language-bash">cargo install zjj
</code></pre>
<div class="warning">
‚ö†Ô∏è <strong>Warning</strong>: The crates.io version may lag behind the latest GitHub release. Building from source is recommended for the best experience.
</div>

<hr>
<h2 id="verifying-installation"><a class="header" href="#verifying-installation">Verifying Installation</a></h2>
<p>After installation, verify everything works:</p>
<pre><code class="language-bash"># Check ZJJ version
zjj --version

# Check JJ is installed
jj --version

# Check Zellij is installed
zellij --version

# Run system health check
zjj doctor
</code></pre>
<hr>
<h2 id="installing-prerequisites"><a class="header" href="#installing-prerequisites">Installing Prerequisites</a></h2>
<h3 id="installing-jj-jujutsu"><a class="header" href="#installing-jj-jujutsu">Installing JJ (Jujutsu)</a></h3>
<p><strong>macOS:</strong></p>
<pre><code class="language-bash">brew install jj
</code></pre>
<p><strong>Linux:</strong></p>
<pre><code class="language-bash"># Arch Linux
yay -S jujutsu

# Ubuntu/Debian (via cargo)
cargo install --locked jj-cli
</code></pre>
<h3 id="installing-zellij"><a class="header" href="#installing-zellij">Installing Zellij</a></h3>
<p><strong>macOS:</strong></p>
<pre><code class="language-bash">brew install zellij
</code></pre>
<p><strong>Linux:</strong></p>
<pre><code class="language-bash"># Via cargo
cargo install --locked zellij

# Or via package manager
sudo pacman -S zellij  # Arch Linux
</code></pre>
<h3 id="installing-rust"><a class="header" href="#installing-rust">Installing Rust</a></h3>
<p>Visit <a href="https://rustup.rs/">https://rustup.rs/</a> and run:</p>
<pre><code class="language-bash">curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
</code></pre>
<hr>
<h2 id="post-installation-setup"><a class="header" href="#post-installation-setup">Post-Installation Setup</a></h2>
<h3 id="initialize-zjj-in-a-repository"><a class="header" href="#initialize-zjj-in-a-repository">Initialize ZJJ in a Repository</a></h3>
<pre><code class="language-bash"># Navigate to a JJ repository
cd /path/to/your/repo

# If not a JJ repo yet
jj init

# Initialize ZJJ
zjj init
</code></pre>
<hr>
<h2 id="next-steps-2"><a class="header" href="#next-steps-2">Next Steps</a></h2>
<ul>
<li><strong><a href="#quick-start">Quick Start Guide</a></strong> - Get running in 5 minutes</li>
<li><strong><a href="#core-concepts">Core Concepts</a></strong> - Understand sessions and queues</li>
<li><strong><a href="#workspace-management">User Guide</a></strong> - Learn all the features</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="core-concepts"><a class="header" href="#core-concepts">Core Concepts</a></h1>
<p>Understanding the three core concepts of ZJJ.</p>
<hr>
<h2 id="the-mental-model"><a class="header" href="#the-mental-model">The Mental Model</a></h2>
<p>ZJJ has three fundamental concepts that work together:</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Concept</th><th>Description</th><th>Commands</th></tr>
</thead>
<tbody>
<tr><td><strong>Session</strong></td><td>Named isolated workspace + optional Zellij tab + optional bead association</td><td><code>zjj add</code>, <code>zjj focus</code>, <code>zjj done</code></td></tr>
<tr><td><strong>Queue Entry</strong></td><td>Unit of work that workers/agents can claim and process</td><td><code>zjj queue --add</code>, <code>zjj queue worker</code></td></tr>
<tr><td><strong>Done</strong></td><td>Complete work and land it back to main</td><td><code>zjj done</code></td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="sessions"><a class="header" href="#sessions">Sessions</a></h2>
<p>A <strong>session</strong> represents an isolated piece of work. When you create a session, ZJJ:</p>
<ol>
<li>Creates a new JJ workspace (isolated from main)</li>
<li>Creates a Zellij tab for that workspace (optional)</li>
<li>Associates it with a bead/issue (optional)</li>
<li>Tracks its state in the database</li>
</ol>
<h3 id="session-lifecycle"><a class="header" href="#session-lifecycle">Session Lifecycle</a></h3>
<pre class="mermaid">graph LR
    A[Create] --&gt; B[Work]
    B --&gt; C[Sync]
    C --&gt; B
    B --&gt; D[Done]
    D --&gt; E[Remove]
</pre>

<h3 id="example"><a class="header" href="#example">Example</a></h3>
<pre><code class="language-bash"># Create a session
zjj add auth-refactor --bead BD-123

# Work on it
zjj focus auth-refactor
# ... make changes ...

# Keep synced
zjj sync auth-refactor

# Finish
zjj done

# Clean up
zjj remove auth-refactor
</code></pre>
<hr>
<h2 id="queue-entries"><a class="header" href="#queue-entries">Queue Entries</a></h2>
<p>A <strong>queue entry</strong> is a work item in the merge/processing queue. Multiple workers (human or AI) can process queue entries in parallel safely.</p>
<h3 id="queue-properties"><a class="header" href="#queue-properties">Queue Properties</a></h3>
<ul>
<li><strong>Priority</strong> - Higher priority entries processed first</li>
<li><strong>Status</strong> - <code>pending</code>, <code>processing</code>, <code>completed</code>, <code>failed</code></li>
<li><strong>Lease</strong> - Worker claims entry with time-limited lease</li>
<li><strong>Retry</strong> - Failed entries can be retried</li>
<li><strong>Stale Reclaim</strong> - Abandoned entries can be reclaimed</li>
</ul>
<h3 id="example-1"><a class="header" href="#example-1">Example</a></h3>
<pre><code class="language-bash"># Add work to queue
zjj queue --add feature-a --bead BD-101 --priority 3
zjj queue --add feature-b --bead BD-102 --priority 5

# List queue
zjj queue --list

# Process queue (worker)
zjj queue worker --loop
</code></pre>
<hr>
<h2 id="workspaces-vs-sessions-vs-queue"><a class="header" href="#workspaces-vs-sessions-vs-queue">Workspaces vs Sessions vs Queue</a></h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Aspect</th><th>Workspace</th><th>Session</th><th>Queue Entry</th></tr>
</thead>
<tbody>
<tr><td><strong>What</strong></td><td>JJ workspace (branch)</td><td>Workspace + Zellij tab + metadata</td><td>Work item in queue</td></tr>
<tr><td><strong>When</strong></td><td>Created automatically with session</td><td>Created by <code>zjj add</code></td><td>Created by <code>zjj queue --add</code></td></tr>
<tr><td><strong>Purpose</strong></td><td>Isolation</td><td>User interface to workspace</td><td>Coordination</td></tr>
<tr><td><strong>Lifecycle</strong></td><td>Managed by JJ</td><td>Managed by ZJJ</td><td>Managed by queue</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="integration"><a class="header" href="#integration">Integration</a></h2>
<p>How these concepts work together:</p>
<pre class="mermaid">graph TD
    A[Queue Entry] --&gt;|Claims| B[Session]
    B --&gt;|Creates| C[JJ Workspace]
    B --&gt;|Creates| D[Zellij Tab]
    B --&gt;|Associates| E[Bead/Issue]
    C --&gt;|Work| F[Changes]
    F --&gt;|Done| G[Merge to Main]
    A --&gt;|Complete| H[Mark Done]
</pre>

<p><strong>Flow:</strong></p>
<ol>
<li>Queue entry exists for work</li>
<li>Worker claims entry, creates session</li>
<li>Session creates workspace + tab</li>
<li>Work happens in isolation</li>
<li>Changes merged to main</li>
<li>Entry marked complete</li>
</ol>
<hr>
<h2 id="next-steps-3"><a class="header" href="#next-steps-3">Next Steps</a></h2>
<ul>
<li><strong><a href="#workspace-management">User Guide - Workspaces</a></strong> - Detailed workspace management</li>
<li><strong><a href="#queue-coordination">User Guide - Queue</a></strong> - Queue coordination</li>
<li><strong><a href="#issue-tracking-beads">User Guide - Beads</a></strong> - Issue tracking integration</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="your-first-workspace"><a class="header" href="#your-first-workspace">Your First Workspace</a></h1>
<p>Let‚Äôs create your first isolated workspace and do some work.</p>
<hr>
<h2 id="prerequisites-2"><a class="header" href="#prerequisites-2">Prerequisites</a></h2>
<p>Make sure you have:</p>
<ul>
<li>ZJJ installed and verified (<code>zjj --version</code>)</li>
<li>A JJ repository initialized (<code>jj status</code> works)</li>
<li>ZJJ initialized in the repo (<code>zjj init</code>)</li>
</ul>
<hr>
<h2 id="step-1-check-your-location"><a class="header" href="#step-1-check-your-location">Step 1: Check Your Location</a></h2>
<p>Always start by checking where you are:</p>
<pre><code class="language-bash">zjj whereami
</code></pre>
<p>Expected output:</p>
<pre><code>Location: main branch
</code></pre>
<hr>
<h2 id="step-2-create-a-session"><a class="header" href="#step-2-create-a-session">Step 2: Create a Session</a></h2>
<pre><code class="language-bash">zjj add my-first-feature
</code></pre>
<p>This creates:</p>
<ul>
<li>A new JJ workspace named <code>my-first-feature</code></li>
<li>A Zellij tab for this workspace</li>
<li>An entry in the ZJJ database</li>
</ul>
<hr>
<h2 id="step-3-switch-to-your-workspace"><a class="header" href="#step-3-switch-to-your-workspace">Step 3: Switch to Your Workspace</a></h2>
<pre><code class="language-bash">zjj focus my-first-feature
</code></pre>
<p>This switches your Zellij tab to the workspace. Verify:</p>
<pre><code class="language-bash">zjj whereami
</code></pre>
<p>Expected output:</p>
<pre><code>Location: workspace 'my-first-feature'
</code></pre>
<hr>
<h2 id="step-4-make-changes"><a class="header" href="#step-4-make-changes">Step 4: Make Changes</a></h2>
<p>Now make some changes to your code:</p>
<pre><code class="language-bash"># Edit a file
echo "# My First Feature" &gt; feature.md

# Check JJ status
jj status
</code></pre>
<p>You‚Äôll see your changes in the workspace.</p>
<hr>
<h2 id="step-5-check-session-status"><a class="header" href="#step-5-check-session-status">Step 5: Check Session Status</a></h2>
<pre><code class="language-bash">zjj status my-first-feature
</code></pre>
<p>This shows:</p>
<ul>
<li>Branch name</li>
<li>Changes (modified, added, deleted)</li>
<li>Diff statistics</li>
</ul>
<hr>
<h2 id="step-6-sync-with-main-optional"><a class="header" href="#step-6-sync-with-main-optional">Step 6: Sync with Main (Optional)</a></h2>
<p>If main has moved forward:</p>
<pre><code class="language-bash">zjj sync my-first-feature
</code></pre>
<p>This rebases your workspace onto the latest main.</p>
<hr>
<h2 id="step-7-complete-your-work"><a class="header" href="#step-7-complete-your-work">Step 7: Complete Your Work</a></h2>
<p>When you‚Äôre done:</p>
<pre><code class="language-bash">zjj done
</code></pre>
<p>This:</p>
<ul>
<li>Commits your changes</li>
<li>Merges to main</li>
<li>Pushes to remote (if configured)</li>
</ul>
<hr>
<h2 id="step-8-clean-up"><a class="header" href="#step-8-clean-up">Step 8: Clean Up</a></h2>
<pre><code class="language-bash">zjj remove my-first-feature
</code></pre>
<p>This removes the session and workspace.</p>
<hr>
<h2 id="common-workflow"><a class="header" href="#common-workflow">Common Workflow</a></h2>
<p>Here‚Äôs the typical daily workflow:</p>
<pre><code class="language-bash"># Morning: create session for today's work
zjj add fix-bug-123 --bead BD-123

# Focus on it
zjj focus fix-bug-123

# Work...
# ... make changes ...

# Sync with main periodically
zjj sync fix-bug-123

# End of day: finish up
zjj done

# Clean up
zjj remove fix-bug-123
</code></pre>
<hr>
<h2 id="multiple-workspaces"><a class="header" href="#multiple-workspaces">Multiple Workspaces</a></h2>
<p>You can have multiple workspaces active:</p>
<pre><code class="language-bash"># Create multiple sessions
zjj add feature-a --bead BD-101
zjj add feature-b --bead BD-102
zjj add bugfix-c --bead BD-103

# List them all
zjj list

# Switch between them
zjj focus feature-a
zjj focus feature-b
zjj focus bugfix-c

# Or use interactive switch
zjj switch
</code></pre>
<hr>
<h2 id="next-steps-4"><a class="header" href="#next-steps-4">Next Steps</a></h2>
<ul>
<li><strong><a href="#workspace-management">User Guide - Workspaces</a></strong> - Detailed workspace management</li>
<li><strong><a href="#queue-coordination">User Guide - Queue</a></strong> - Multi-worker coordination</li>
<li><strong><a href="#command-reference">Command Reference</a></strong> - All available commands</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="workspace-management"><a class="header" href="#workspace-management">Workspace Management</a></h1>
<p>Complete guide to managing isolated workspaces with ZJJ.</p>
<hr>
<h2 id="what-is-a-workspace"><a class="header" href="#what-is-a-workspace">What is a Workspace?</a></h2>
<p>A workspace is an isolated JJ working copy where you can make changes without affecting main. In ZJJ, workspaces are:</p>
<ul>
<li><strong>Isolated</strong> - Changes don‚Äôt affect other workspaces or main</li>
<li><strong>Persistent</strong> - They exist until explicitly removed</li>
<li><strong>Synchronized</strong> - Can be kept in sync with main</li>
<li><strong>Integrated</strong> - Connected to Zellij tabs for easy switching</li>
</ul>
<hr>
<h2 id="creating-workspaces"><a class="header" href="#creating-workspaces">Creating Workspaces</a></h2>
<h3 id="basic-creation"><a class="header" href="#basic-creation">Basic Creation</a></h3>
<pre><code class="language-bash">zjj add &lt;name&gt;
</code></pre>
<p>This creates a minimal workspace.</p>
<h3 id="with-bead-association"><a class="header" href="#with-bead-association">With Bead Association</a></h3>
<pre><code class="language-bash">zjj add &lt;name&gt; --bead &lt;BEAD_ID&gt;
</code></pre>
<p>Associates the workspace with an issue/bead for tracking.</p>
<h3 id="example-2"><a class="header" href="#example-2">Example</a></h3>
<pre><code class="language-bash"># Simple workspace
zjj add feature-auth

# With issue tracking
zjj add fix-login --bead BD-123

# With custom settings
zjj add experiment --no-tab
</code></pre>
<hr>
<h2 id="listing-workspaces"><a class="header" href="#listing-workspaces">Listing Workspaces</a></h2>
<pre><code class="language-bash"># Simple list
zjj list

# Verbose (shows paths and bead titles)
zjj list --verbose

# JSON output
zjj list --json
</code></pre>
<hr>
<h2 id="switching-workspaces"><a class="header" href="#switching-workspaces">Switching Workspaces</a></h2>
<pre><code class="language-bash"># Direct switch
zjj focus &lt;name&gt;

# Interactive picker
zjj switch

# Via whereami check
zjj whereami  # See where you are
zjj focus other-workspace  # Switch
</code></pre>
<hr>
<h2 id="syncing-workspaces"><a class="header" href="#syncing-workspaces">Syncing Workspaces</a></h2>
<p>Keep your workspace up to date with main:</p>
<pre><code class="language-bash"># Sync specific workspace
zjj sync &lt;name&gt;

# Sync current workspace
zjj sync

# Sync all workspaces
zjj sync --all
</code></pre>
<p>This rebases your workspace onto the latest main.</p>
<hr>
<h2 id="completing-work"><a class="header" href="#completing-work">Completing Work</a></h2>
<p>When you‚Äôre done:</p>
<pre><code class="language-bash">zjj done
</code></pre>
<p>This:</p>
<ol>
<li>Commits your changes</li>
<li>Merges to main</li>
<li>Pushes to remote (if configured)</li>
<li>Updates bead status (if associated)</li>
</ol>
<hr>
<h2 id="removing-workspaces"><a class="header" href="#removing-workspaces">Removing Workspaces</a></h2>
<pre><code class="language-bash">zjj remove &lt;name&gt;
</code></pre>
<p>This deletes the workspace and cleans up the session.</p>
<hr>
<h2 id="best-practices"><a class="header" href="#best-practices">Best Practices</a></h2>
<h3 id="naming-conventions"><a class="header" href="#naming-conventions">Naming Conventions</a></h3>
<ul>
<li>Use descriptive names: <code>feature-auth-refactor</code> not <code>temp</code></li>
<li>Include issue ID: <code>fix-BD-123-login-bug</code></li>
<li>Use lowercase with hyphens: <code>my-feature</code> not <code>My_Feature</code></li>
</ul>
<h3 id="sync-regularly"><a class="header" href="#sync-regularly">Sync Regularly</a></h3>
<pre><code class="language-bash"># Good: sync before major work
zjj sync my-feature

# Better: sync at start of day
zjj sync --all
</code></pre>
<h3 id="clean-up"><a class="header" href="#clean-up">Clean Up</a></h3>
<p>Remove workspaces when done:</p>
<pre><code class="language-bash">zjj remove old-feature
</code></pre>
<p>Or clean all stale sessions:</p>
<pre><code class="language-bash">zjj clean
</code></pre>
<hr>
<h2 id="advanced-usage"><a class="header" href="#advanced-usage">Advanced Usage</a></h2>
<h3 id="multiple-workspaces-1"><a class="header" href="#multiple-workspaces-1">Multiple Workspaces</a></h3>
<p>Work on multiple features simultaneously:</p>
<pre><code class="language-bash">zjj add feature-a --bead BD-101
zjj add feature-b --bead BD-102  
zjj add hotfix-c --bead BD-103

# Switch between them
zjj focus feature-a
# ... work ...
zjj focus hotfix-c
# ... work ...
zjj focus feature-b
</code></pre>
<h3 id="workspace-status"><a class="header" href="#workspace-status">Workspace Status</a></h3>
<p>Check detailed status:</p>
<pre><code class="language-bash">zjj status &lt;name&gt;
</code></pre>
<p>Shows:</p>
<ul>
<li>Branch name</li>
<li>Changes (M/A/D/R counts)</li>
<li>Diff statistics (+/- lines)</li>
<li>Associated bead info</li>
</ul>
<hr>
<h2 id="troubleshooting-1"><a class="header" href="#troubleshooting-1">Troubleshooting</a></h2>
<h3 id="workspace-not-found"><a class="header" href="#workspace-not-found">‚ÄúWorkspace not found‚Äù</a></h3>
<pre><code class="language-bash">zjj list  # Check it exists
zjj add my-workspace  # Create if missing
</code></pre>
<h3 id="conflicts-during-sync"><a class="header" href="#conflicts-during-sync">‚ÄúConflicts during sync‚Äù</a></h3>
<pre><code class="language-bash">zjj sync my-workspace
# If conflicts occur, resolve in JJ:
jj resolve
# Then try sync again
</code></pre>
<h3 id="cant-remove-workspace"><a class="header" href="#cant-remove-workspace">‚ÄúCan‚Äôt remove workspace‚Äù</a></h3>
<pre><code class="language-bash">zjj status my-workspace  # Check if in use
zjj remove my-workspace --force  # Force removal
</code></pre>
<hr>
<h2 id="see-also"><a class="header" href="#see-also">See Also</a></h2>
<ul>
<li><strong><a href="#creating-sessions">Creating Sessions</a></strong> - Detailed session creation</li>
<li><strong><a href="#switching-workspaces-1">Switching Workspaces</a></strong> - Advanced switching</li>
<li><strong><a href="#syncing-with-main">Syncing</a></strong> - Sync strategies</li>
<li><strong><a href="#completing-work-1">Completing Work</a></strong> - Finishing up</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="creating-sessions"><a class="header" href="#creating-sessions">Creating Sessions</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="switching-workspaces-1"><a class="header" href="#switching-workspaces-1">Switching Workspaces</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="syncing-with-main"><a class="header" href="#syncing-with-main">Syncing with Main</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="completing-work-1"><a class="header" href="#completing-work-1">Completing Work</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="queue-coordination"><a class="header" href="#queue-coordination">Queue Coordination</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="adding-work-items"><a class="header" href="#adding-work-items">Adding Work Items</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="queue-workers"><a class="header" href="#queue-workers">Queue Workers</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="multi-agent-workflows"><a class="header" href="#multi-agent-workflows">Multi-Agent Workflows</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="issue-tracking-beads"><a class="header" href="#issue-tracking-beads">Issue Tracking (Beads)</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="triaging-work"><a class="header" href="#triaging-work">Triaging Work</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="claiming-issues"><a class="header" href="#claiming-issues">Claiming Issues</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="bead-lifecycle"><a class="header" href="#bead-lifecycle">Bead Lifecycle</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="version-control-jj"><a class="header" href="#version-control-jj">Version Control (JJ)</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="basic-workflow"><a class="header" href="#basic-workflow">Basic Workflow</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="stacking-changes"><a class="header" href="#stacking-changes">Stacking Changes</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="conflict-resolution"><a class="header" href="#conflict-resolution">Conflict Resolution</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="terminal-multiplexing-zellij"><a class="header" href="#terminal-multiplexing-zellij">Terminal Multiplexing (Zellij)</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="layouts"><a class="header" href="#layouts">Layouts</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="tab-management"><a class="header" href="#tab-management">Tab Management</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="ai-agent-overview"><a href="#ai-agent-overview" class="header">AI Agent Overview</a></h1>
<h2 id="quick-start-3-commands"><a class="header" href="#quick-start-3-commands">Quick Start (3 commands)</a></h2>
<pre><code class="language-bash">zjj whereami        # Check: "main" or "workspace:&lt;name&gt;"
zjj work my-task    # Start: Create workspace
zjj done            # Finish: Merge and cleanup
</code></pre>
<p>Or use the AI helpers:</p>
<pre><code class="language-bash">zjj ai status       # Full status with guided next action
zjj ai workflow     # 7-step parallel agent workflow
zjj ai quick-start  # Minimum commands reference
</code></pre>
<hr>
<h2 id="7-absolute-mandatory-rules"><a class="header" href="#7-absolute-mandatory-rules">7 Absolute Mandatory Rules</a></h2>
<h3 id="1-no_clippy_edits"><a class="header" href="#1-no_clippy_edits">1. NO_CLIPPY_EDITS</a></h3>
<p><strong>NEVER modify clippy or linting configuration files. EVER.</strong></p>
<p>Files: <code>.clippy.toml</code>, <code>clippy.toml</code>, <code>#![allow(...)]</code>, <code>#![deny(...)]</code>, <code>Cargo.toml</code> lint sections, <code>moon.yml</code> lint rules.</p>
<p><strong>Fix the code, not the rules.</strong></p>
<h3 id="2-moon_only"><a class="header" href="#2-moon_only">2. MOON_ONLY</a></h3>
<p><strong>NEVER use raw cargo commands. ALWAYS use Moon.</strong></p>
<ul>
<li>‚ùå NEVER: <code>cargo fmt</code>, <code>cargo clippy</code>, <code>cargo test</code>, <code>cargo build</code></li>
<li>‚úÖ ALWAYS: <code>moon run :quick</code>, <code>moon run :test</code>, <code>moon run :build</code>, <code>moon run :ci</code>, <code>moon run :fmt-fix</code>, <code>moon run :check</code></li>
</ul>
<p><strong>Why:</strong> Moon provides 98.5% faster builds via persistent caching and parallel execution.</p>
<h3 id="3-codanna_only"><a class="header" href="#3-codanna_only">3. CODANNA_ONLY</a></h3>
<p><strong>NEVER use Grep/Glob/Read for exploration. ALWAYS use Codanna.</strong></p>
<ul>
<li>‚ùå NEVER: <code>Grep</code>, <code>Glob</code>, <code>Read</code> for code exploration</li>
<li>‚úÖ ALWAYS: <code>mcp__codanna__semantic_search_with_context</code>, <code>find_symbol</code>, <code>search_symbols</code>, <code>search_documents</code>, <code>get_calls</code>, <code>find_callers</code>, <code>analyze_impact</code></li>
</ul>
<p><strong>Why:</strong> Codanna is pre-indexed with semantic understanding. 90% fewer tokens, 10x faster.</p>
<h3 id="4-zero_unwrap_zero_expect_zero_panic"><a class="header" href="#4-zero_unwrap_zero_expect_zero_panic">4. ZERO_UNWRAP_ZERO_EXPECT_ZERO_PANIC</a></h3>
<p><strong>ZERO unwrap. ZERO expect. ZERO panic. EVER.</strong></p>
<hr>
<h2 id="next-steps-5"><a class="header" href="#next-steps-5">Next Steps</a></h2>
<ul>
<li><strong><a href="#7-mandatory-rules">7 Mandatory Rules</a></strong> - Critical constraints for all agents</li>
<li><strong><a href="#quick-reference">Quick Reference</a></strong> - 90% of workflows</li>
<li><strong><a href="#parallel-workflow">Parallel Workflow</a></strong> - Multi-agent coordination</li>
<li><strong><a href="#session-completion">Session Completion</a></strong> - Landing the plane</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="7-mandatory-rules"><a href="#7-mandatory-rules" class="header">7 Mandatory Rules</a></h1>
<p><strong>COMPLETELY FORBIDDEN:</strong></p>
<ul>
<li>‚ùå <code>unwrap()</code> - under NO circumstances</li>
<li>‚ùå <code>unwrap_or()</code> - NO variants allowed</li>
<li>‚ùå <code>unwrap_or_else()</code> - NO variants allowed</li>
<li>‚ùå <code>unwrap_or_default()</code> - NO variants allowed</li>
<li>‚ùå <code>expect()</code> - under NO circumstances</li>
<li>‚ùå <code>expect_err()</code> - NO variants allowed</li>
<li>‚ùå <code>panic!()</code> - under NO circumstances</li>
<li>‚ùå <code>todo!()</code> - under NO circumstances</li>
<li>‚ùå <code>unimplemented!()</code> - under NO circumstances</li>
</ul>
<p><strong>REQUIRED:</strong></p>
<ul>
<li>‚úÖ <code>Result&lt;T, Error&gt;</code> for all fallible operations</li>
<li>‚úÖ <code>map</code>, <code>and_then</code>, <code>?</code> operator for error propagation</li>
<li>‚úÖ Railway-Oriented Programming patterns</li>
<li>‚úÖ <strong>USE functional-rust-generator SKILL for ALL Rust implementation</strong></li>
</ul>
<p><strong>Why:</strong> Panic-based code is unmaintainable and crashes in production. Unwrap variants are panics in disguise. Expect is just panic with a message.</p>
<h3 id="5-git_push_mandatory"><a class="header" href="#5-git_push_mandatory">5. GIT_PUSH_MANDATORY</a></h3>
<p><strong>Work is NOT done until <code>git push</code> succeeds.</strong></p>
<ul>
<li>‚ùå NEVER: Stop before pushing, say ‚Äúready to push when you are‚Äù, leave work stranded locally</li>
<li>‚úÖ ALWAYS: Push yourself, verify <code>git status</code> shows ‚Äúup to date‚Äù, resolve and retry on failure</li>
</ul>
<p><strong>Why:</strong> Unpushed work = lost work. ‚ÄúI‚Äôll push later‚Äù = stranded commits.</p>
<h3 id="6-br_sync"><a class="header" href="#6-br_sync">6. BR_SYNC</a></h3>
<p><strong><code>br</code> never runs git commands. You must commit bead changes manually.</strong></p>
<p>After <code>br sync --flush-only</code>, you MUST run:</p>
<pre><code class="language-bash">git add .beads/
git commit -m "sync beads"
</code></pre>
<p><strong>Why:</strong> Beads is non-invasive by design. It modifies JSONL only. You must commit those changes.</p>
<h3 id="7-functional_rust_skill"><a class="header" href="#7-functional_rust_skill">7. FUNCTIONAL_RUST_SKILL</a></h3>
<p><strong>ALWAYS load and use functional-rust-generator skill for ANY Rust implementation.</strong></p>
<ul>
<li>‚úÖ ALWAYS: Load <code>functional-rust-generator</code> skill before writing Rust code</li>
<li>‚úÖ This skill enforces zero unwrap/expect/panic patterns</li>
<li>‚úÖ Uses Railway-Oriented Programming</li>
<li>‚úÖ Provides functional patterns: <code>map</code>, <code>and_then</code>, <code>?</code></li>
</ul>
<p><strong>Why:</strong> The skill exists for a reason - it enforces these patterns automatically. Don‚Äôt reinvent the wheel.</p>
<hr>
<h2 id="quick-reference-90-of-workflows"><a class="header" href="#quick-reference-90-of-workflows">Quick Reference: 90% of Workflows</a></h2>
<h3 id="code-search-codanna"><a class="header" href="#code-search-codanna">Code Search (Codanna)</a></h3>
<pre><code class="language-jsonl">{"tool": "semantic_search_with_context", "when": "Natural language query ‚Üí full context", "call": "mcp__codanna__semantic_search_with_context(query=\"your intent\", limit: 5)"}
{"tool": "find_symbol", "when": "Know exact name", "call": "mcp__codanna__find_symbol(name=\"ExactName\")"}
{"tool": "search_symbols", "when": "Fuzzy pattern search", "call": "mcp__codanna__search_symbols(query=\"pattern\", kind:\"Struct|Function|Trait\", lang:\"rust\", limit: 10)"}
{"tool": "search_documents", "when": "Search markdown docs", "call": "mcp__codanna__search_documents(query=\"topic\", limit: 5)"}
{"tool": "analyze_impact", "when": "Dependency graph", "call": "mcp__codanna__analyze_impact(symbol_id: 123)"}
</code></pre>
<p><strong>Workflow:</strong> semantic_search ‚Üí find_symbol ‚Üí search_symbols ‚Üí search_documents ‚Üí analyze_impact</p>
<p><strong>When to reindex:</strong> Codanna returns no results, search seems outdated, or after large code changes.</p>
<pre><code class="language-bash">codanna index &amp;&amp; codanna documents index --collection docs
# Current stats: 5,592 symbols, 817 doc chunks
</code></pre>
<h3 id="build-moon"><a class="header" href="#build-moon">Build (Moon)</a></h3>
<pre><code class="language-jsonl">{"cmd": "moon run :quick", "use": "Fast check (6-7ms cached)", "frequency": "Every edit"}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="quick-reference"><a href="#quick-reference" class="header">Quick Reference</a></h1>
<p>{‚Äúcmd‚Äù: ‚Äúmoon run :fmt-fix‚Äù, ‚Äúuse‚Äù: ‚ÄúAuto-fix formatting‚Äù, ‚Äúfrequency‚Äù: ‚ÄúBefore commit‚Äù}
{‚Äúcmd‚Äù: ‚Äúmoon run :test‚Äù, ‚Äúuse‚Äù: ‚ÄúRun tests‚Äù, ‚Äúfrequency‚Äù: ‚ÄúAfter changes‚Äù}
{‚Äúcmd‚Äù: ‚Äúmoon run :check‚Äù, ‚Äúuse‚Äù: ‚ÄúType check only‚Äù, ‚Äúfrequency‚Äù: ‚ÄúQuick validation‚Äù}</p>
<pre><code>
### Issue Tracking (Beads)

```jsonl
{"cmd": "bv --robot-triage", "use": "Find what to work on (entry point)", "frequency": "Start of session"}
{"cmd": "bv --robot-next", "use": "Top pick + claim command", "frequency": "Quick pick"}
{"cmd": "br ready", "use": "List available work", "frequency": "As needed"}
{"cmd": "br show &lt;id&gt;", "use": "View issue details", "frequency": "Before claiming"}
{"cmd": "br update &lt;id&gt; --status in_progress", "use": "Claim work", "frequency": "When starting"}
{"cmd": "br close &lt;id&gt;", "use": "Complete work", "frequency": "When done"}
</code></pre>
<h3 id="workspace-zjj"><a class="header" href="#workspace-zjj">Workspace (zjj)</a></h3>
<pre><code class="language-jsonl">{"cmd": "zjj add &lt;name&gt;", "use": "Create session + Zellij tab", "frequency": "New work"}
{"cmd": "zjj focus &lt;name&gt;", "use": "Switch to session tab", "frequency": "Context switch"}
{"cmd": "zjj remove &lt;name&gt;", "use": "Close tab + workspace", "frequency": "Work complete"}
{"cmd": "zjj list", "use": "Show all sessions", "frequency": "Status check"}
{"cmd": "zjj whereami", "use": "Check current location", "frequency": "Orient yourself"}
{"cmd": "zjj work &lt;name&gt;", "use": "Create workspace (simpler than add)", "frequency": "New work"}
{"cmd": "zjj done", "use": "Complete and merge work", "frequency": "Finish work"}
</code></pre>
<hr>
<h2 id="7-step-parallel-agent-workflow"><a class="header" href="#7-step-parallel-agent-workflow">7-Step Parallel Agent Workflow</a></h2>
<p>Each autonomous agent follows this pipeline:</p>
<pre><code class="language-jsonl">{"step": "1", "name": "TRIAGE", "cmd": "bv --robot-triage --robot-triage-by-track", "output": "Parallel execution tracks", "tool": "bv"}
{"step": "2", "name": "CLAIM", "cmd": "br update &lt;bead-id&gt; --status in_progress", "output": "Reserve bead", "tool": "br"}
{"step": "3", "name": "ISOLATE", "skill": "zjj", "output": "Spawn isolated JJ workspace + Zellij tab", "tool": "Skill tool"}
{"step": "4", "name": "IMPLEMENT", "skill": "functional-rust-generator (Rust) | tdd15-gleam (Gleam)", "output": "ZERO unwrap/expect/panic, Railway-Oriented Programming", "tool": "Skill tool"}
{"step": "5", "name": "REVIEW", "skill": "red-queen", "output": "Adversarial QA, regression hunting", "tool": "Skill tool"}
{"step": "6", "name": "LAND", "skill": "landing-skill", "output": "Moon quick check, commit, sync, push (MANDATORY)", "tool": "Skill tool"}
{"step": "7", "name": "MERGE", "skill": "zjj", "output": "jj rebase -d main, cleanup, tab switch", "tool": "Skill tool"}
</code></pre>
<h3 id="subagent-template"><a class="header" href="#subagent-template">Subagent Template</a></h3>
<pre><code class="language-markdown">**BEAD**: &lt;bead-id&gt; - "&lt;title&gt;"

**WORKFLOW**:
1. CLAIM: `br update &lt;bead-id&gt; --status in_progress`
2. ISOLATE: zjj skill ‚Üí "&lt;session-name&gt;"
3. IMPLEMENT: functional-rust-generator skill (Rust) or tdd15-gleam skill (Gleam)
  - **ZERO unwrap(), unwrap_or(), unwrap_or_else(), unwrap_or_default()**
  - **ZERO expect(), expect_err()**
  - **ZERO panic!(), todo!(), unimplemented!()**
  - Railway-Oriented Programming
  - map, and_then, ? operator
4. REVIEW: red-queen skill (adversarial QA)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="parallel-workflow"><a href="#parallel-workflow" class="header">Parallel Workflow</a></h1>
<ol start="6">
<li>MERGE: zjj skill (merge to main)</li>
</ol>
<p><strong>CRITICAL CONSTRAINTS</strong>:</p>
<ul>
<li><strong>ZERO unwrap/expect/panic variants</strong> (see rule 4)</li>
<li>Zero unwraps/panics, Moon only, work NOT done until git push succeeds</li>
<li><strong>ALWAYS use functional-rust-generator skill for Rust</strong> (rule 7)</li>
</ul>
<p>Report final status with bead ID.</p>
<pre><code>
### Parallel Execution Example

```bash
# Get parallel tracks
bv --robot-triage --robot-triage-by-track

# Spawn 8 agents via Task tool
# Each gets unique bead from different track
# All run simultaneously in isolated workspaces
# Orchestrator monitors from clean context
</code></pre>
<h3 id="benefits"><a class="header" href="#benefits">Benefits</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Benefit</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><strong>Isolation</strong></td><td>Each agent works in separate JJ workspace</td></tr>
<tr><td><strong>Parallel</strong></td><td>8x throughput with no conflicts</td></tr>
<tr><td><strong>Deterministic</strong></td><td>bv precomputes dependencies and execution tracks</td></tr>
<tr><td><strong>Quality</strong></td><td>Red-queen ensures adversarial testing on each change</td></tr>
<tr><td><strong>Clean handoff</strong></td><td>landing-skill guarantees all work pushed before completion</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="session-completion-landing-the-plane"><a class="header" href="#session-completion-landing-the-plane">Session Completion (Landing the Plane)</a></h2>
<h3 id="critical-work-is-not-done-until-git-push-succeeds"><a class="header" href="#critical-work-is-not-done-until-git-push-succeeds">CRITICAL: Work is NOT Done Until <code>git push</code> Succeeds</a></h3>
<p><strong>MANDATORY WORKFLOW (All 7 Steps Required)</strong></p>
<pre><code class="language-jsonl">{"step": "1", "action": "File issues", "details": "Create issues for anything that needs follow-up", "tool": "br"}
{"step": "2", "action": "Run quality gates", "details": "If code changed: moon run :quick (6-7ms) OR moon run :ci (full)", "tool": "moon"}
{"step": "3", "action": "Update issues", "details": "Close finished work, update in-progress items", "tool": "br"}
{"step": "4", "action": "COMMIT AND PUSH (MANDATORY)", "details": "git add &lt;files&gt; | git commit -m 'desc' | br sync | git pull --rebase | git push | git status (must show 'up to date')", "tool": "git, br"}
{"step": "5", "action": "Verify cache", "details": "systemctl --user is-active bazel-remote (expect 'active')", "tool": "systemctl"}
{"step": "6", "action": "Clean up", "details": "Clear stashes, prune remote branches", "tool": "git"}
{"step": "7", "action": "Hand off", "details": "Provide context for next session", "output": "Summary message"}
</code></pre>
<h3 id="example-session-end"><a class="header" href="#example-session-end">Example Session End</a></h3>
<pre><code class="language-bash"># 1. File any follow-up work
br create "Need to add error handling for edge case"

# 2. Quality gates
moon run :quick

# 3. Update issues
br close 123
br update 456 --status done

# 4. COMMIT AND PUSH (MANDATORY)
git add crates/zjj-core/src/error.rs
git commit -m "fix: add error handling for edge case"
br sync --flush-only
git add .beads/
git commit -m "sync beads"
git pull --rebase
git push
git status # MUST show: "Your branch is up to date with 'origin/main'"

# 5. Verify cache
systemctl --user is-active bazel-remote # Output: active

# 6. Clean up
git stash clear
git remote prune origin

# 7. Hand off
# "Completed bead #123 (error handling). Bead #456 in progress. Cache healthy. No conflicts."
</code></pre>
<h3 id="what-ready-to-push-when-you-are-means"><a class="header" href="#what-ready-to-push-when-you-are-means">What ‚ÄúReady to Push When You Are‚Äù Means</a></h3>
<p><strong>DO NOT SAY THIS.</strong> It means:</p>
<ul>
<li>You‚Äôre offloading responsibility</li>
<li>Work might never get pushed</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="session-completion"><a href="#session-completion" class="header">Session Completion</a></h1>
<ul>
<li>Potential merge conflicts accumulate</li>
</ul>
<p><strong>Instead:</strong> Push yourself. Verify <code>git status</code> shows ‚Äúup to date‚Äù. Only then is work complete.</p>
<h3 id="failure-recovery"><a class="header" href="#failure-recovery">Failure Recovery</a></h3>
<p>If <code>git push</code> fails:</p>
<ol>
<li>Check network: <code>ping github.com</code></li>
<li>Check auth: <code>git remote -v</code> &amp;&amp; <code>ssh -T git@github.com</code></li>
<li>Pull rebase: <code>git pull --rebase</code></li>
<li>Resolve conflicts if any</li>
<li>Push again: <code>git push</code></li>
<li>Repeat until success</li>
<li>Only then report completion</li>
</ol>
<hr>
<h2 id="environment-variables"><a class="header" href="#environment-variables">Environment Variables</a></h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Variable</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><code>ZJJ_AGENT_ID</code></td><td>Your agent ID (set by register)</td></tr>
<tr><td><code>ZJJ_SESSION</code></td><td>Current session name</td></tr>
<tr><td><code>ZJJ_WORKSPACE</code></td><td>Current workspace path</td></tr>
<tr><td><code>ZJJ_BEAD_ID</code></td><td>Associated bead ID</td></tr>
<tr><td><code>ZJJ_ACTIVE</code></td><td>‚Äú1‚Äù when in workspace</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="json-output-pattern"><a class="header" href="#json-output-pattern">JSON Output Pattern</a></h2>
<p>All commands support <code>--json</code> and return:</p>
<pre><code class="language-json">{
  "$schema": "zjj://&lt;command&gt;-response/v1",
  "_schema_version": "1.0",
  "schema_type": "single",
  "success": true,
  ...
}
</code></pre>
<hr>
<h2 id="error-handling"><a class="header" href="#error-handling">Error Handling</a></h2>
<p>Exit codes:</p>
<ul>
<li>0: Success</li>
<li>1: Validation error (user input)</li>
<li>2: Not found</li>
<li>3: System error</li>
<li>4: External command error</li>
<li>5: Lock contention</li>
</ul>
<p>Errors include suggestions:</p>
<pre><code class="language-json">{
  "success": false,
  "error": {
    "code": "SESSION_NOT_FOUND",
    "message": "...",
    "suggestion": "Use 'zjj list' to see available sessions"
  }
}
</code></pre>
<hr>
<h2 id="introspection"><a class="header" href="#introspection">Introspection</a></h2>
<pre><code class="language-bash">zjj introspect              # All capabilities
zjj introspect &lt;cmd&gt;        # Command details
zjj introspect --env-vars   # Environment variables
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="environment-variables-1"><a href="#environment-variables-1" class="header">Environment Variables</a></h1>
<pre><code>
---

## Agent Lifecycle

```bash
# Register (optional but recommended)
zjj agent register

# Send heartbeat while working
zjj agent heartbeat --command "implementing"

# Check your status
zjj agent status

# Unregister when done
zjj agent unregister
</code></pre>
<hr>
<h2 id="common-patterns"><a class="header" href="#common-patterns">Common Patterns</a></h2>
<h3 id="start-fresh"><a class="header" href="#start-fresh">Start Fresh</a></h3>
<pre><code class="language-bash">zjj whereami                        # Should return "main"
zjj work feature-auth --idempotent
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="command-reference"><a class="header" href="#command-reference">Command Reference</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="zjj"><a class="header" href="#zjj">zjj</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="zjj-add"><a class="header" href="#zjj-add">zjj add</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="zjj-list"><a class="header" href="#zjj-list">zjj list</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="zjj-status"><a class="header" href="#zjj-status">zjj status</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="zjj-focus"><a class="header" href="#zjj-focus">zjj focus</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="zjj-sync"><a class="header" href="#zjj-sync">zjj sync</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="zjj-done"><a class="header" href="#zjj-done">zjj done</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="zjj-queue"><a class="header" href="#zjj-queue">zjj queue</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="zjj-work"><a class="header" href="#zjj-work">zjj work</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="zjj-whereami"><a class="header" href="#zjj-whereami">zjj whereami</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="configuration-1"><a class="header" href="#configuration-1">Configuration</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="json-output"><a class="header" href="#json-output">JSON Output</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="error-codes"><a class="header" href="#error-codes">Error Codes</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="building-from-source"><a class="header" href="#building-from-source">Building from Source</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="moon-build-system"><a class="header" href="#moon-build-system">Moon Build System</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="rust-standards"><a class="header" href="#rust-standards">Rust Standards</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="error-handling-1"><a class="header" href="#error-handling-1">Error Handling</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="functional-patterns"><a class="header" href="#functional-patterns">Functional Patterns</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="testing"><a class="header" href="#testing">Testing</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="contributing"><a class="header" href="#contributing">Contributing</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="troubleshooting-2"><a class="header" href="#troubleshooting-2">Troubleshooting</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="queue-operations"><a class="header" href="#queue-operations">Queue Operations</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="rollout--rollback"><a class="header" href="#rollout--rollback">Rollout &amp; Rollback</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="performance-tuning"><a class="header" href="#performance-tuning">Performance Tuning</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="faq"><a class="header" href="#faq">FAQ</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="glossary"><a class="header" href="#glossary">Glossary</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="examples"><a class="header" href="#examples">Examples</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="changelog"><a class="header" href="#changelog">Changelog</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>


    </div>
    </body>
</html>
