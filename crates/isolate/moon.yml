$schema: "https://moonrepo.dev/schemas/project.json"

tasks:
  check:
    script: "${MOON_WORKSPACE_ROOT}/tools/run-with-nightly.sh cargo check --workspace --all-features"
  fmt:
    script: "${MOON_WORKSPACE_ROOT}/tools/run-with-nightly.sh cargo fmt --all --check"
  fmt-fix:
    script: "${MOON_WORKSPACE_ROOT}/tools/run-with-nightly.sh cargo fmt --all"
  clippy:
    script: "${MOON_WORKSPACE_ROOT}/tools/run-with-nightly.sh cargo clippy --workspace --all-targets --all-features -- -D warnings"
  build:
    script: "${MOON_WORKSPACE_ROOT}/tools/run-with-nightly.sh cargo build --release --workspace"
  test:
    script: "mise exec -- ${MOON_WORKSPACE_ROOT}/tools/run-with-nightly.sh cargo nextest run --workspace --all-features --no-fail-fast"
  quick:
    script: "${MOON_WORKSPACE_ROOT}/tools/run-with-nightly.sh cargo fmt --all --check && ${MOON_WORKSPACE_ROOT}/tools/run-with-nightly.sh cargo clippy --workspace --all-targets --all-features -- -D warnings"
  ci:
    script: "${MOON_WORKSPACE_ROOT}/tools/run-with-nightly.sh cargo fmt --all --check && ${MOON_WORKSPACE_ROOT}/tools/run-with-nightly.sh cargo clippy --workspace --all-targets --all-features -- -D warnings && ${MOON_WORKSPACE_ROOT}/tools/run-with-nightly.sh cargo check --workspace --all-features && mise exec -- ${MOON_WORKSPACE_ROOT}/tools/run-with-nightly.sh cargo nextest run --workspace --all-features --no-fail-fast"
