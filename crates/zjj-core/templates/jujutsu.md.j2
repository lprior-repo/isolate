# Jujutsu: Version Control

Git alternative optimized for stack-based development and instant branching.

## Core Concepts

- **Working Copy** - Your current changes (automatically tracked)
- **Changes** - Immutable commits (can be rearranged)
- **Bookmarks** - Branch pointers
- **Revisions** - Commits (immutable)

## Quick Start

### Status & Diff

```bash
jj status              # Current state
jj diff                # Your changes
jj log                 # Commit history
```

### Making Changes

```bash
# Edit files (automatically tracked)
vim src/lib.rs

# See what changed
jj diff
jj status

# Describe change
jj describe -m "feat: add validation

- Implement ValidatorBuilder
- Add error types
- Test coverage"

# Start next change
jj new
```

### Remote Operations

```bash
# Fetch latest
jj git fetch --all-remotes

# Push changes
jj git push

# Check if pushed
jj log -r @
```

## Common Commands

### View Information

```bash
jj status                      # Current status
jj diff                        # Changes in working copy
jj diff -r BD-123              # Changes in specific revision
jj log                         # Commit history
jj log -r @                    # Current commit
jj log -r origin/main..@       # Unpushed commits
```

### Managing Changes

```bash
jj describe -m "message"       # Set current commit message
jj describe -e                 # Edit message in editor
jj new                         # Create new change
jj edit -r <revision>          # Edit existing revision
jj squash                      # Squash into parent
jj abandon <revision>          # Discard a commit
```

## Agent Workflow Integration

### ZJJ Workspaces

When working with ZJJ, JJ is managed automatically:

```bash
# Create workspace (zjj runs 'jj workspace add' internally)
zjj add <session-name>

# Workspace is now an isolated JJ branch
# All commits are tracked in the workspace

# Complete work (zjj handles merge/push)
zjj done
```

### Conventional Commits

Use commit messages that link to beads:

```bash
jj describe -m "feat: implement validation

- Implement validator builder
- Add error types
- Add test suite

Closes BD-123"
```

### Working with Remotes

```bash
# Sync with main (done via zjj sync)
zjj sync

# Push (done via zjj done)
zjj done

# Or manually:
jj git fetch --all-remotes
jj git push
```

## Workflow with ZJJ

1. **Create workspace**: `zjj add feature-name` (creates JJ workspace)
2. **Edit and test**: Edit files, `moon run :quick`
3. **Commit**: `jj describe -m "feat: description"`
4. **Repeat**: `jj new`, edit, `moon run :quick`, `jj describe`
5. **Complete**: `zjj done -m "feat: description"` (merges to main)

## Tips

### See What Changed Since Last Push

```bash
jj log -r origin/main..@
```

### Stashing Work in Progress

```bash
jj describe -m "wip: work in progress"
# Continue elsewhere later
```

### Squashing Commits

```bash
# Make several commits, then:
jj squash  # Squashes current into parent
```

## Philosophy

> "Jujutsu treats commits as immutable, composable units. Rearrange them freely before pushing, then they're locked once on remote."

Benefits:
- ✅ Instant branching (just a bookmark)
- ✅ Reorder commits before pushing
- ✅ Stacking features easily
- ✅ Clean history (no merge commits)
- ✅ Deterministic (no conflicts in most cases)

---

**Next**: [Complete Docs Index](00_START_HERE.md)
