Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj/src/cli/handlers/domain.rs:502:
 
     #[test]
     fn test_bead_id_invalid_suffix() {
[31m-        assert!(BeadId::parse("bd-123-456").is_err());  // Hyphens not allowed in hex part
(B[m[31m-        assert!(BeadId::parse("bd-abc_def").is_err());  // Underscores not allowed in hex part
(B[m[32m+        assert!(BeadId::parse("bd-123-456").is_err()); // Hyphens not allowed in hex part
(B[m[32m+        assert!(BeadId::parse("bd-abc_def").is_err()); // Underscores not allowed in hex part
(B[m     }
 
     // AgentId tests
Diff in /home/lewis/src/zjj/crates/zjj/src/cli/handlers/stack.rs:800:
         let stack = result.unwrap();
         assert_eq!(stack.name, SessionName::parse("root").expect("valid"));
         assert_eq!(stack.entries.len(), 2);
[31m-        assert_eq!(stack.entries[0].session, SessionName::parse("root").expect("valid"));
(B[m[32m+        assert_eq!(
(B[m[32m+            stack.entries[0].session,
(B[m[32m+            SessionName::parse("root").expect("valid")
(B[m[32m+        );
(B[m         assert!(matches!(
             stack.entries[0].bead,
             BeadAttachment::Attached { .. }
Diff in /home/lewis/src/zjj/crates/zjj/src/cli/handlers/stack.rs:807:
         ));
[31m-        assert_eq!(stack.entries[1].session, SessionName::parse("child").expect("valid"));
(B[m[32m+        assert_eq!(
(B[m[32m+            stack.entries[1].session,
(B[m[32m+            SessionName::parse("child").expect("valid")
(B[m[32m+        );
(B[m     }
 
     #[test]
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/add.rs:159:
     if json_envelope_mode() {
         return Ok(());
     }
[31m-    let mut issue =
(B[m[31m-        Issue::new(
(B[m[31m-            IssueId::new(id).map_err(|e| anyhow::anyhow!("Invalid issue ID: {e}"))?,
(B[m[31m-            IssueTitle::new(title).map_err(|e| anyhow::anyhow!("Invalid issue title: {e}"))?,
(B[m[31m-            kind,
(B[m[31m-            severity,
(B[m[31m-        )
(B[m[31m-        .map_err(|e| anyhow::anyhow!("{e}"))?;
(B[m[32m+    let mut issue = Issue::new(
(B[m[32m+        IssueId::new(id).map_err(|e| anyhow::anyhow!("Invalid issue ID: {e}"))?,
(B[m[32m+        IssueTitle::new(title).map_err(|e| anyhow::anyhow!("Invalid issue title: {e}"))?,
(B[m[32m+        kind,
(B[m[32m+        severity,
(B[m[32m+    )
(B[m[32m+    .map_err(|e| anyhow::anyhow!("{e}"))?;
(B[m 
     if let Some(s) = session {
[31m-        issue = issue.with_session(SessionName::parse(s.to_string()).map_err(|e| anyhow::anyhow!("{e}"))?);
(B[m[32m+        issue = issue
(B[m[32m+            .with_session(SessionName::parse(s.to_string()).map_err(|e| anyhow::anyhow!("{e}"))?);
(B[m     }
     if let Some(s) = suggestion {
         issue = issue.with_suggestion(s.to_string());
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/diff.rs:489:
             "content": "diff content here",
         });
 
[31m-        let result =
(B[m[31m-            ResultOutput::success(ResultKind::Command, Message::new("Diff for test-session").expect("valid message"))
(B[m[31m-                .expect("Failed to create result")
(B[m[31m-                .with_data(diff_data);
(B[m[32m+        let result = ResultOutput::success(
(B[m[32m+            ResultKind::Command,
(B[m[32m+            Message::new("Diff for test-session").expect("valid message"),
(B[m[32m+        )
(B[m[32m+        .expect("Failed to create result")
(B[m[32m+        .with_data(diff_data);
(B[m 
         assert!(matches!(result.outcome, zjj_core::output::Outcome::Success));
         assert_eq!(result.kind, ResultKind::Command);
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/diff.rs:508:
             "content": "1 file changed, 5 insertions(+), 2 deletions(-)",
         });
 
[31m-        let result =
(B[m[31m-            ResultOutput::success(ResultKind::Command, Message::new("Diff for test-session").expect("valid message"))
(B[m[31m-                .expect("Failed to create result")
(B[m[31m-                .with_data(diff_data);
(B[m[32m+        let result = ResultOutput::success(
(B[m[32m+            ResultKind::Command,
(B[m[32m+            Message::new("Diff for test-session").expect("valid message"),
(B[m[32m+        )
(B[m[32m+        .expect("Failed to create result")
(B[m[32m+        .with_data(diff_data);
(B[m 
         let data = result.data.expect("Data should be present");
         assert_eq!(data["diff_type"], "stat");
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/doctor.rs:1231:
     // Emit summary
     let summary = Summary::new(
         SummaryType::Count,
[31m-        Message::new(format!("Health: {passed} passed, {warnings} warning(s), {errors} error(s)"))?,
(B[m[32m+        Message::new(format!(
(B[m[32m+            "Health: {passed} passed, {warnings} warning(s), {errors} error(s)"
(B[m[32m+        ))?,
(B[m     )?;
     emit_stdout(&OutputLine::Summary(summary))?;
 
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/doctor.rs:1271:
         let description =
             describe_fix(check).unwrap_or_else(|| "No fix description available".to_string());
         let action = Action::new(
[31m-            ActionVerb::new("would_fix").map_err(|e| anyhow::anyhow!("Invalid action verb: {e}"))?,
(B[m[31m-            ActionTarget::new(&check.name).map_err(|e| anyhow::anyhow!("Invalid action target: {e}"))?,
(B[m[32m+            ActionVerb::new("would_fix")
(B[m[32m+                .map_err(|e| anyhow::anyhow!("Invalid action verb: {e}"))?,
(B[m[32m+            ActionTarget::new(&check.name)
(B[m[32m+                .map_err(|e| anyhow::anyhow!("Invalid action target: {e}"))?,
(B[m             ActionStatus::Pending,
         )
         .with_result(description);
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/done/mod.rs:659:
 ) -> Result<Option<String>, DoneError> {
     use newtypes::WorkspaceName;
 
[31m-    let workspace =
(B[m[31m-        WorkspaceName::parse(workspace_name).map_err(|e| DoneError::InvalidState {
(B[m[31m-            reason: e.to_string(),
(B[m[31m-        })?;
(B[m[32m+    let workspace = WorkspaceName::parse(workspace_name).map_err(|e| DoneError::InvalidState {
(B[m[32m+        reason: e.to_string(),
(B[m[32m+    })?;
(B[m 
     bead_repo
         .find_by_workspace(&workspace)
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/done/mod.rs:681:
 ) -> Result<(), DoneError> {
     use newtypes::BeadId;
 
[31m-    let bead_id_newtype =
(B[m[31m-        BeadId::parse(bead_id).map_err(|e| DoneError::BeadUpdateFailed {
(B[m[31m-            reason: e.to_string(),
(B[m[31m-        })?;
(B[m[32m+    let bead_id_newtype = BeadId::parse(bead_id).map_err(|e| DoneError::BeadUpdateFailed {
(B[m[32m+        reason: e.to_string(),
(B[m[32m+    })?;
(B[m 
     bead_repo
         .update_status(&bead_id_newtype, new_status)
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/focus.rs:89:
     .map_err(|e| anyhow::anyhow!("{e}"))?;
 
     if let Some(s) = session {
[31m-        issue = issue.with_session(SessionName::parse(s.to_string()).map_err(|e| anyhow::anyhow!("{e}"))?);
(B[m[32m+        issue = issue
(B[m[32m+            .with_session(SessionName::parse(s.to_string()).map_err(|e| anyhow::anyhow!("{e}"))?);
(B[m     }
     if let Some(s) = suggestion {
         issue = issue.with_suggestion(s.to_string());
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/focus.rs:147:
         run_command("zellij", &["action", "go-to-tab-name", &zellij_tab]).await?;
 
         let action = Action::new(
[31m-            ActionVerb::new("switch-tab").map_err(|e| anyhow::anyhow!("Invalid action verb: {e}"))?,
(B[m[31m-            ActionTarget::new(&zellij_tab).map_err(|e| anyhow::anyhow!("Invalid action target: {e}"))?,
(B[m[32m+            ActionVerb::new("switch-tab")
(B[m[32m+                .map_err(|e| anyhow::anyhow!("Invalid action verb: {e}"))?,
(B[m[32m+            ActionTarget::new(&zellij_tab)
(B[m[32m+                .map_err(|e| anyhow::anyhow!("Invalid action target: {e}"))?,
(B[m             ActionStatus::Completed,
         )
         .with_result(format!("Switched to session '{name}'"));
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/focus.rs:157:
     } else {
         let action = Action::new(
             ActionVerb::new("attach").map_err(|e| anyhow::anyhow!("Invalid action verb: {e}"))?,
[31m-            ActionTarget::new(zellij_tab.clone()).map_err(|e| anyhow::anyhow!("Invalid action target: {e}"))?,
(B[m[32m+            ActionTarget::new(zellij_tab.clone())
(B[m[32m+                .map_err(|e| anyhow::anyhow!("Invalid action target: {e}"))?,
(B[m             ActionStatus::Completed,
         )
         .with_result(format!("Attaching to Zellij session for '{name}'"));
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/focus.rs:401:
 
     #[tokio::test]
     async fn test_result_output_is_valid_jsonl() -> Result<()> {
[31m-        let result = ResultOutput::success(
(B[m[31m-            ResultKind::Command,
(B[m[31m-            Message::new("Focused on session")?,
(B[m[31m-        )?;
(B[m[32m+        let result =
(B[m[32m+            ResultOutput::success(ResultKind::Command, Message::new("Focused on session")?)?;
(B[m 
         let output_line = OutputLine::Result(result);
         let json_str = serde_json::to_string(&output_line)?;
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/list.rs:450:
 
     #[test]
     fn test_output_line_summary_serializes_with_type() {
[31m-        let summary = Summary::new(SummaryType::Count, Message::new("Listed 5 session(s)").expect("summary should be valid"))
(B[m[31m-            .expect("summary should be valid");
(B[m[32m+        let summary = Summary::new(
(B[m[32m+            SummaryType::Count,
(B[m[32m+            Message::new("Listed 5 session(s)").expect("summary should be valid"),
(B[m[32m+        )
(B[m[32m+        .expect("summary should be valid");
(B[m         let line = OutputLine::Summary(summary);
         let json = serde_json::to_string(&line);
         assert!(json.is_ok());
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/prune_invalid/mod.rs:19:
 use anyhow::Result;
 use futures::{StreamExt, TryStreamExt};
 use zjj_core::{
[31m-    output::{emit_stdout, Action, ActionStatus, ActionTarget, ActionVerb, Message, OutputLine, Summary, SummaryType},
(B[m[32m+    output::{
(B[m[32m+        emit_stdout, Action, ActionStatus, ActionTarget, ActionVerb, Message, OutputLine, Summary,
(B[m[32m+        SummaryType,
(B[m[32m+    },
(B[m     OutputFormat,
 };
 
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/prune_invalid/mod.rs:132:
 
         for name in invalid_names {
             let action = Action::new(
[31m-                ActionVerb::new("discovered").map_err(|e| anyhow::anyhow!("Invalid action verb: {e}"))?,
(B[m[31m-                ActionTarget::new(name).map_err(|e| anyhow::anyhow!("Invalid action target: {e}"))?,
(B[m[32m+                ActionVerb::new("discovered")
(B[m[32m+                    .map_err(|e| anyhow::anyhow!("Invalid action verb: {e}"))?,
(B[m[32m+                ActionTarget::new(name)
(B[m[32m+                    .map_err(|e| anyhow::anyhow!("Invalid action target: {e}"))?,
(B[m                 ActionStatus::Pending,
             );
             emit_stdout(&OutputLine::Action(action))?;
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/prune_invalid/mod.rs:159:
 
         for name in invalid_names {
             let action = Action::new(
[31m-                ActionVerb::new("remove").map_err(|e| anyhow::anyhow!("Invalid action verb: {e}"))?,
(B[m[31m-                ActionTarget::new(name).map_err(|e| anyhow::anyhow!("Invalid action target: {e}"))?,
(B[m[32m+                ActionVerb::new("remove")
(B[m[32m+                    .map_err(|e| anyhow::anyhow!("Invalid action verb: {e}"))?,
(B[m[32m+                ActionTarget::new(name)
(B[m[32m+                    .map_err(|e| anyhow::anyhow!("Invalid action target: {e}"))?,
(B[m                 ActionStatus::Skipped,
             );
             emit_stdout(&OutputLine::Action(action))?;
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/prune_invalid/mod.rs:185:
 
         for name in invalid_names {
             let action = Action::new(
[31m-                ActionVerb::new("remove").map_err(|e| anyhow::anyhow!("Invalid action verb: {e}"))?,
(B[m[31m-                ActionTarget::new(name).map_err(|e| anyhow::anyhow!("Invalid action target: {e}"))?,
(B[m[32m+                ActionVerb::new("remove")
(B[m[32m+                    .map_err(|e| anyhow::anyhow!("Invalid action verb: {e}"))?,
(B[m[32m+                ActionTarget::new(name)
(B[m[32m+                    .map_err(|e| anyhow::anyhow!("Invalid action target: {e}"))?,
(B[m                 ActionStatus::Completed,
             );
             emit_stdout(&OutputLine::Action(action))?;
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/queue.rs:15:
 use zjj_core::{
     domain::SessionName,
     output::{
[31m-        emit_stdout, Action, ActionStatus, ActionTarget, ActionVerb, BeadId, Message,
(B[m[31m-        OutputLine, QueueCounts, QueueEntry, QueueEntryId, QueueEntryStatus, QueueSummary,
(B[m[31m-        Summary, SummaryType,
(B[m[32m+        emit_stdout, Action, ActionStatus, ActionTarget, ActionVerb, BeadId, Message, OutputLine,
(B[m[32m+        QueueCounts, QueueEntry, QueueEntryId, QueueEntryStatus, QueueSummary, Summary,
(B[m[32m+        SummaryType,
(B[m     },
     OutputFormat, QueueStatus,
 };
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/queue.rs:236:
 
             emit_stdout(&OutputLine::QueueEntry(entry_with_agent))?;
         } else {
[31m-            let summary = Summary::new(
(B[m[31m-                SummaryType::Info,
(B[m[31m-                Message::new("Queue is empty")?,
(B[m[31m-            )?;
(B[m[32m+            let summary = Summary::new(SummaryType::Info, Message::new("Queue is empty")?)?;
(B[m             emit_stdout(&OutputLine::Summary(summary))?;
         }
     } else {
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/queue.rs:315:
         // Emit action for processing start
         let action = Action::new(
             ActionVerb::new("process").map_err(|e| anyhow::anyhow!("Invalid action verb: {e}"))?,
[31m-            ActionTarget::new(entry.workspace.clone()).map_err(|e| anyhow::anyhow!("Invalid action target: {e}"))?,
(B[m[32m+            ActionTarget::new(entry.workspace.clone())
(B[m[32m+                .map_err(|e| anyhow::anyhow!("Invalid action target: {e}"))?,
(B[m             ActionStatus::InProgress,
         );
         emit_stdout(&OutputLine::Action(action))?;
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/queue.rs:395:
 
             if options.format.is_json() {
                 let action = Action::new(
[31m-                    ActionVerb::new("merge").map_err(|e| anyhow::anyhow!("Invalid action verb: {e}"))?,
(B[m[31m-                    ActionTarget::new(entry.workspace.clone()).map_err(|e| anyhow::anyhow!("Invalid action target: {e}"))?,
(B[m[32m+                    ActionVerb::new("merge")
(B[m[32m+                        .map_err(|e| anyhow::anyhow!("Invalid action verb: {e}"))?,
(B[m[32m+                    ActionTarget::new(entry.workspace.clone())
(B[m[32m+                        .map_err(|e| anyhow::anyhow!("Invalid action target: {e}"))?,
(B[m                     ActionStatus::Completed,
                 )
                 .with_result(format!("merged at {}", merged_sha));
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/queue.rs:414:
 
             if options.format.is_json() {
                 let action = Action::new(
[31m-                    ActionVerb::new("merge").map_err(|e| anyhow::anyhow!("Invalid action verb: {e}"))?,
(B[m[31m-                    ActionTarget::new(entry.workspace.clone()).map_err(|e| anyhow::anyhow!("Invalid action target: {e}"))?,
(B[m[32m+                    ActionVerb::new("merge")
(B[m[32m+                        .map_err(|e| anyhow::anyhow!("Invalid action verb: {e}"))?,
(B[m[32m+                    ActionTarget::new(entry.workspace.clone())
(B[m[32m+                        .map_err(|e| anyhow::anyhow!("Invalid action target: {e}"))?,
(B[m                     ActionStatus::Failed,
                 )
                 .with_result(error_msg.clone());
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/queue.rs:814:
     match status {
         zjj_core::QueueStatus::Pending => QueueEntryStatus::Pending,
         zjj_core::QueueStatus::Claimed => QueueEntryStatus::Claimed,
[31m-        zjj_core::QueueStatus::Rebasing | zjj_core::QueueStatus::Testing | zjj_core::QueueStatus::Merging => {
(B[m[31m-            QueueEntryStatus::InProgress
(B[m[31m-        }
(B[m[32m+        zjj_core::QueueStatus::Rebasing
(B[m[32m+        | zjj_core::QueueStatus::Testing
(B[m[32m+        | zjj_core::QueueStatus::Merging => QueueEntryStatus::InProgress,
(B[m         zjj_core::QueueStatus::ReadyToMerge => QueueEntryStatus::Ready,
         zjj_core::QueueStatus::Merged => QueueEntryStatus::Completed,
[31m-        zjj_core::QueueStatus::FailedRetryable | zjj_core::QueueStatus::FailedTerminal | zjj_core::QueueStatus::Cancelled => {
(B[m[31m-            QueueEntryStatus::Failed
(B[m[31m-        }
(B[m[32m+        zjj_core::QueueStatus::FailedRetryable
(B[m[32m+        | zjj_core::QueueStatus::FailedTerminal
(B[m[32m+        | zjj_core::QueueStatus::Cancelled => QueueEntryStatus::Failed,
(B[m     }
 }
 
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/remove.rs:100:
     .map_err(|e| anyhow::anyhow!("{e}"))?;
 
     if let Some(s) = session {
[31m-        issue = issue.with_session(
(B[m[31m-            SessionName::parse(s.to_string()).map_err(|e| anyhow::anyhow!("{e}"))?,
(B[m[31m-        );
(B[m[32m+        issue = issue
(B[m[32m+            .with_session(SessionName::parse(s.to_string()).map_err(|e| anyhow::anyhow!("{e}"))?);
(B[m     }
     if let Some(s) = suggestion {
         issue = issue.with_suggestion(s.to_string());
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/remove.rs:116:
 const fn remove_error_to_issue_kind(error: &RemoveError) -> IssueKind {
     match error {
         RemoveError::WorkspaceInaccessible { .. } => IssueKind::ResourceNotFound,
[31m-        RemoveError::WorkspaceRemovalFailed { .. }
(B[m[31m-        | RemoveError::ZellijTabCloseFailed { .. } => IssueKind::External,
(B[m[32m+        RemoveError::WorkspaceRemovalFailed { .. } | RemoveError::ZellijTabCloseFailed { .. } => {
(B[m[32m+            IssueKind::External
(B[m[32m+        }
(B[m         RemoveError::DatabaseDeletionFailed { .. } => IssueKind::Configuration,
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/session_command.rs:921:
     .map_err(|e| anyhow::anyhow!("{e}"))?;
 
     if let Some(s) = session {
[31m-        issue = issue.with_session(SessionName::parse(s.to_string()).map_err(|e| anyhow::anyhow!("{e}"))?);
(B[m[32m+        issue = issue
(B[m[32m+            .with_session(SessionName::parse(s.to_string()).map_err(|e| anyhow::anyhow!("{e}"))?);
(B[m     }
     if let Some(s) = suggestion {
         issue = issue.with_suggestion(s.to_string());
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/status.rs:15:
 use anyhow::Result;
 use serde::Serialize;
 use zjj_core::output::{
[31m-    emit_stdout, Action, ActionStatus, ActionTarget, ActionVerb, Message, OutputLine, SessionOutput,
(B[m[31m-    Summary, SummaryType,
(B[m[32m+    emit_stdout, Action, ActionStatus, ActionTarget, ActionVerb, Message, OutputLine,
(B[m[32m+    SessionOutput, Summary, SummaryType,
(B[m };
 
 use crate::{commands::get_session_db, session::Session};
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/status.rs:205:
             // Emit error as Issue line
             let error_summary = Summary::new(
                 SummaryType::Status,
[31m-                Message::new(format!("Error: {e}")).map_err(|se| anyhow::anyhow!("Invalid message: {se}"))?,
(B[m[32m+                Message::new(format!("Error: {e}"))
(B[m[32m+                    .map_err(|se| anyhow::anyhow!("Invalid message: {se}"))?,
(B[m             )
             .map_err(|se| anyhow::anyhow!("Failed to create error summary: {se}"))?;
             let _ = emit_stdout(&OutputLine::Summary(error_summary));
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/sync.rs:110:
     )
     .map_err(|e| anyhow::anyhow!("{e}"))?;
     let issue = match session {
[31m-        Some(s) => issue.with_session(SessionName::parse(s.to_string()).map_err(|e| anyhow::anyhow!("{e}"))?),
(B[m[32m+        Some(s) => issue
(B[m[32m+            .with_session(SessionName::parse(s.to_string()).map_err(|e| anyhow::anyhow!("{e}"))?),
(B[m         None => issue,
     };
     let issue = match suggestion {
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/sync.rs:966:
 
     #[test]
     fn test_sync_jsonl_action_output_on_success() -> anyhow::Result<()> {
[31m-        use zjj_core::output::{Action, ActionStatus, ActionVerb, ActionTarget, OutputLine};
(B[m[32m+        use zjj_core::output::{Action, ActionStatus, ActionTarget, ActionVerb, OutputLine};
(B[m 
         let action = Action::new(
             ActionVerb::new("rebase")?,
Diff in /home/lewis/src/zjj/crates/zjj/src/commands/sync.rs:1170:
 
     #[test]
     fn test_sync_jsonl_parseable_by_jq() -> anyhow::Result<()> {
[31m-        use zjj_core::output::{Action, ActionStatus, ActionVerb, ActionTarget, Message, OutputLine, ResultKind, ResultOutput};
(B[m[32m+        use zjj_core::output::{
(B[m[32m+            Action, ActionStatus, ActionTarget, ActionVerb, Message, OutputLine, ResultKind,
(B[m[32m+            ResultOutput,
(B[m[32m+        };
(B[m 
         // Simulate a sync output: Action + Result
         let action = Action::new(
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj/tests/agent_properties.rs:284:
         }
 
         // Bind the agent
[31m-        self.agents
(B[m[31m-            .get_mut(agent_id)
(B[m[31m-            .map_or_else(
(B[m[31m-                || Err(AgentError::NotFound(agent_id.to_string())),
(B[m[31m-                |agent| {
(B[m[31m-                    agent.bind_to_session(session_id, current_time, ttl);
(B[m[31m-                    Ok(())
(B[m[31m-                },
(B[m[31m-            )
(B[m[32m+        self.agents.get_mut(agent_id).map_or_else(
(B[m[32m+            || Err(AgentError::NotFound(agent_id.to_string())),
(B[m[32m+            |agent| {
(B[m[32m+                agent.bind_to_session(session_id, current_time, ttl);
(B[m[32m+                Ok(())
(B[m[32m+            },
(B[m[32m+        )
(B[m     }
 }
 
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj/tests/integration_tests.rs:25:
 
 mod common;
 
[31m-use common::{TestHarness, CommandResult};
(B[m[32m+use common::{CommandResult, TestHarness};
(B[m 
 // ============================================================================
 // WORKFLOW 1: Session → Workspace → Close Lifecycle
Diff in /home/lewis/src/zjj/crates/zjj/tests/integration_tests.rs:75:
     // Initialize and create sessions
     harness.assert_success(&["init"]);
 
[31m-    let sessions = vec![
(B[m[31m-        "feature-payment",
(B[m[31m-        "feature-auth",
(B[m[31m-        "feature-ui",
(B[m[31m-    ];
(B[m[32m+    let sessions = vec!["feature-payment", "feature-auth", "feature-ui"];
(B[m 
     for session in &sessions {
         harness.assert_success(&["add", session, "--no-zellij", "--no-hooks"]);
Diff in /home/lewis/src/zjj/crates/zjj/tests/integration_tests.rs:232:
     // Attempt to dequeue non-existent session
     let result = harness.zjj(&["queue", "dequeue", "nonexistent-session"]);
     // Should fail gracefully
[31m-    assert!(!result.success, "Dequeue should fail for non-existent session");
(B[m[32m+    assert!(
(B[m[32m+        !result.success,
(B[m[32m+        "Dequeue should fail for non-existent session"
(B[m[32m+    );
(B[m }
 
 // ============================================================================
Diff in /home/lewis/src/zjj/crates/zjj/tests/integration_tests.rs:468:
     }
 
     // Add to queue
[31m-    harness.zjj(&["queue", "enqueue", "status-test-1"]).assert_success();
(B[m[32m+    harness
(B[m[32m+        .zjj(&["queue", "enqueue", "status-test-1"])
(B[m[32m+        .assert_success();
(B[m 
     // Get comprehensive status
     let status_result = harness.zjj(&["status", "--json"]);
Diff in /home/lewis/src/zjj/crates/zjj/tests/integration_tests.rs:498:
 
     // Attempt to remove non-existent session
     let remove_result = harness.zjj(&["remove", "non-existent", "--merge"]);
[31m-    assert!(!remove_result.success, "Should fail for non-existent session");
(B[m[32m+    assert!(
(B[m[32m+        !remove_result.success,
(B[m[32m+        "Should fail for non-existent session"
(B[m[32m+    );
(B[m 
     // Verify system is still functional
     let session_name = "recovery-test";
Diff in /home/lewis/src/zjj/crates/zjj/tests/integration_tests.rs:686:
 /// Helper to verify a session does not exist in the list output
 #[allow(dead_code)]
 fn assert_session_not_exists(result: &CommandResult, session_name: &str) {
[31m-    assert!(!result.stdout.contains(session_name),
(B[m[31m-        "Session '{}' should not exist in output: {}", session_name, result.stdout);
(B[m[32m+    assert!(
(B[m[32m+        !result.stdout.contains(session_name),
(B[m[32m+        "Session '{}' should not exist in output: {}",
(B[m[32m+        session_name,
(B[m[32m+        result.stdout
(B[m[32m+    );
(B[m }
 
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj/tests/jsonl_invariant_tests.rs:683:
     use anyhow::Result;
     use zjj_core::{
         output::{
[31m-            Action, ActionStatus, ActionTarget, ActionVerb, Issue, IssueId, IssueKind, IssueSeverity,
(B[m[31m-            IssueTitle, Message, OutputLine, ResultKind, ResultOutput, SessionOutput, Summary,
(B[m[31m-            SummaryType,
(B[m[32m+            Action, ActionStatus, ActionTarget, ActionVerb, Issue, IssueId, IssueKind,
(B[m[32m+            IssueSeverity, IssueTitle, Message, OutputLine, ResultKind, ResultOutput,
(B[m[32m+            SessionOutput, Summary, SummaryType,
(B[m         },
         types::SessionStatus,
         WorkspaceState,
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj/tests/session_feature.rs:24:
 #![allow(clippy::too_many_arguments)]
 #![allow(clippy::bool_assert_comparison)]
 
[31m-mod test_helpers;
(B[m mod steps;
[32m+mod test_helpers;
(B[m 
 pub mod common;
 
Diff in /home/lewis/src/zjj/crates/zjj/tests/session_feature.rs:55:
         // GIVEN
         given_steps::zjj_database_is_initialized(&ctx)
             .expect("GIVEN: database initialization should succeed");
[31m-        given_steps::in_jj_repository(&ctx)
(B[m[31m-            .expect("GIVEN: jj repository setup should succeed");
(B[m[32m+        given_steps::in_jj_repository(&ctx).expect("GIVEN: jj repository setup should succeed");
(B[m         given_steps::no_session_named_exists(&ctx, "feature-auth")
             .await
             .expect("GIVEN: no session should exist initially");
Diff in /home/lewis/src/zjj/crates/zjj/tests/session_feature.rs:93:
         // GIVEN
         given_steps::zjj_database_is_initialized(&ctx)
             .expect("GIVEN: database initialization should succeed");
[31m-        given_steps::in_jj_repository(&ctx)
(B[m[31m-            .expect("GIVEN: jj repository setup should succeed");
(B[m[32m+        given_steps::in_jj_repository(&ctx).expect("GIVEN: jj repository setup should succeed");
(B[m         given_steps::session_named_exists(&ctx, "feature-auth")
             .await
             .expect("GIVEN: session should exist");
Diff in /home/lewis/src/zjj/crates/zjj/tests/session_feature.rs:124:
         // GIVEN
         given_steps::zjj_database_is_initialized(&ctx)
             .expect("GIVEN: database initialization should succeed");
[31m-        given_steps::in_jj_repository(&ctx)
(B[m[31m-            .expect("GIVEN: jj repository setup should succeed");
(B[m[32m+        given_steps::in_jj_repository(&ctx).expect("GIVEN: jj repository setup should succeed");
(B[m         given_steps::no_session_exists(&ctx)
             .await
             .expect("GIVEN: no sessions should exist initially");
Diff in /home/lewis/src/zjj/crates/zjj/tests/session_feature.rs:156:
         // GIVEN
         given_steps::zjj_database_is_initialized(&ctx)
             .expect("GIVEN: database initialization should succeed");
[31m-        given_steps::in_jj_repository(&ctx)
(B[m[31m-            .expect("GIVEN: jj repository setup should succeed");
(B[m[32m+        given_steps::in_jj_repository(&ctx).expect("GIVEN: jj repository setup should succeed");
(B[m         given_steps::session_named_exists_with_status(&ctx, "old-feature", "active")
             .await
             .expect("GIVEN: session should exist with active status");
Diff in /home/lewis/src/zjj/crates/zjj/tests/session_feature.rs:184:
         // GIVEN
         given_steps::zjj_database_is_initialized(&ctx)
             .expect("GIVEN: database initialization should succeed");
[31m-        given_steps::in_jj_repository(&ctx)
(B[m[31m-            .expect("GIVEN: jj repository setup should succeed");
(B[m[32m+        given_steps::in_jj_repository(&ctx).expect("GIVEN: jj repository setup should succeed");
(B[m         given_steps::no_session_named_exists(&ctx, "nonexistent")
             .await
             .expect("GIVEN: session should not exist");
Diff in /home/lewis/src/zjj/crates/zjj/tests/session_feature.rs:216:
         // GIVEN
         given_steps::zjj_database_is_initialized(&ctx)
             .expect("GIVEN: database initialization should succeed");
[31m-        given_steps::in_jj_repository(&ctx)
(B[m[31m-            .expect("GIVEN: jj repository setup should succeed");
(B[m[32m+        given_steps::in_jj_repository(&ctx).expect("GIVEN: jj repository setup should succeed");
(B[m         given_steps::session_named_exists_with_status(&ctx, "feature-sync", "active")
             .await
             .expect("GIVEN: session should exist with active status");
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/aggregate_operations.rs:15:
 
 use criterion::{black_box, criterion_group, criterion_main, BenchmarkId, Criterion};
 use itertools::Itertools;
[31m-use zjj_core::beads::{Assignee, Description, Issue, IssueBuilder, IssueId, Labels, Priority, Title};
(B[m[32m+use zjj_core::beads::{
(B[m[32m+    Assignee, Description, Issue, IssueBuilder, IssueId, Labels, Priority, Title,
(B[m[32m+};
(B[m use zjj_core::domain::aggregates::bead::Bead;
 use zjj_core::domain::identifiers::BeadId;
 
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/aggregate_operations.rs:31:
 /// Create a test issue with full data
 fn test_issue_full() -> Issue {
     let mut issue = Issue::new("test-1", "Test Issue with Description").expect("valid issue");
[31m-    issue.update_description("This is a detailed description of the issue".to_string())
(B[m[32m+    issue
(B[m[32m+        .update_description("This is a detailed description of the issue".to_string())
(B[m         .expect("valid");
     issue.set_priority(Priority::P1);
[31m-    issue.set_labels(vec!["bug".to_string(), "critical".to_string()])
(B[m[32m+    issue
(B[m[32m+        .set_labels(vec!["bug".to_string(), "critical".to_string()])
(B[m         .expect("valid");
[31m-    issue.set_assignee("user@example.com".to_string()).expect("valid");
(B[m     issue
[32m+        .set_assignee("user@example.com".to_string())
(B[m[32m+        .expect("valid");
(B[m[32m+    issue
(B[m }
 
 /// Create a test bead for benchmarks
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/aggregate_operations.rs:61:
 
     group.bench_function("with_description", |b| {
         b.iter(|| {
[31m-            let mut issue = Issue::new(black_box("test-1"), black_box("Test Issue")).expect("valid");
(B[m[32m+            let mut issue =
(B[m[32m+                Issue::new(black_box("test-1"), black_box("Test Issue")).expect("valid");
(B[m             issue.update_description("A description".to_string()).ok();
         });
     });
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/aggregate_operations.rs:68:
 
     group.bench_function("full", |b| {
         b.iter(|| {
[31m-            let mut issue = Issue::new(black_box("test-1"), black_box("Test Issue")).expect("valid");
(B[m[32m+            let mut issue =
(B[m[32m+                Issue::new(black_box("test-1"), black_box("Test Issue")).expect("valid");
(B[m             issue.update_description("A description".to_string()).ok();
             issue.set_priority(Priority::P1);
             issue.set_labels(vec!["bug".to_string()]).ok();
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/aggregate_operations.rs:143:
     group.bench_function("update_description", |b| {
         let mut issue = test_issue();
         b.iter(|| {
[31m-            issue.update_description(black_box("Updated description")).ok();
(B[m[32m+            issue
(B[m[32m+                .update_description(black_box("Updated description"))
(B[m[32m+                .ok();
(B[m         });
     });
 
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/aggregate_operations.rs:175:
     group.bench_function("set_depends_on", |b| {
         let mut issue = test_issue();
         b.iter(|| {
[31m-            issue.set_depends_on(black_box(vec!["dep-1".to_string(), "dep-2".to_string()]))
(B[m[32m+            issue
(B[m[32m+                .set_depends_on(black_box(vec!["dep-1".to_string(), "dep-2".to_string()]))
(B[m                 .ok();
         });
     });
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/aggregate_operations.rs:266:
     group.bench_function("new", |b| {
         let id = BeadId::parse("test-bead").expect("valid");
         b.iter(|| {
[31m-            let _bead = Bead::new(black_box(id.clone()), black_box("Test Bead"), None::<String>);
(B[m[32m+            let _bead = Bead::new(
(B[m[32m+                black_box(id.clone()),
(B[m[32m+                black_box("Test Bead"),
(B[m[32m+                None::<String>,
(B[m[32m+            );
(B[m         });
     });
 
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/aggregate_operations.rs:319:
         });
 
         // Update multiple issues
[31m-        group.bench_with_input(BenchmarkId::new("update_title", count), count, |b, count| {
(B[m[31m-            let issues: Result<Vec<_>, _> = (0..*count)
(B[m[31m-                .map(|i| Issue::new(&format!("test-{}", i), &format!("Issue {}", i)))
(B[m[31m-                .collect();
(B[m[31m-            let mut issues = issues.expect("valid issues");
(B[m[32m+        group.bench_with_input(
(B[m[32m+            BenchmarkId::new("update_title", count),
(B[m[32m+            count,
(B[m[32m+            |b, count| {
(B[m[32m+                let issues: Result<Vec<_>, _> = (0..*count)
(B[m[32m+                    .map(|i| Issue::new(&format!("test-{}", i), &format!("Issue {}", i)))
(B[m[32m+                    .collect();
(B[m[32m+                let mut issues = issues.expect("valid issues");
(B[m 
[31m-            b.iter(|| {
(B[m[31m-                for issue in &mut issues {
(B[m[31m-                    issue.update_title("Updated").ok();
(B[m[31m-                }
(B[m[31m-            });
(B[m[31m-        });
(B[m[32m+                b.iter(|| {
(B[m[32m+                    for issue in &mut issues {
(B[m[32m+                        issue.update_title("Updated").ok();
(B[m[32m+                    }
(B[m[32m+                });
(B[m[32m+            },
(B[m[32m+        );
(B[m 
         // Filter issues
[31m-        group.bench_with_input(BenchmarkId::new("filter_active", count), count, |b, count| {
(B[m[31m-            let issues: Result<Vec<_>, _> = (0..*count)
(B[m[31m-                .map(|i| Issue::new(&format!("test-{}", i), &format!("Issue {}", i)))
(B[m[31m-                .collect();
(B[m[31m-            let issues = issues.expect("valid issues");
(B[m[32m+        group.bench_with_input(
(B[m[32m+            BenchmarkId::new("filter_active", count),
(B[m[32m+            count,
(B[m[32m+            |b, count| {
(B[m[32m+                let issues: Result<Vec<_>, _> = (0..*count)
(B[m[32m+                    .map(|i| Issue::new(&format!("test-{}", i), &format!("Issue {}", i)))
(B[m[32m+                    .collect();
(B[m[32m+                let issues = issues.expect("valid issues");
(B[m 
[31m-            b.iter(|| {
(B[m[31m-                let _active: Vec<_> = issues.iter().filter(|i| i.is_active()).collect();
(B[m[31m-            });
(B[m[31m-        });
(B[m[32m+                b.iter(|| {
(B[m[32m+                    let _active: Vec<_> = issues.iter().filter(|i| i.is_active()).collect();
(B[m[32m+                });
(B[m[32m+            },
(B[m[32m+        );
(B[m     }
 
     group.finish();
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/event_serialization.rs:11:
 //! domain events. Events are used for event sourcing and audit logging,
 //! so serialization performance is critical.
 
[31m-use criterion::{black_box, criterion_group, criterion_main, BenchmarkId, Criterion, Throughput};
(B[m[31m-use zjj_core::domain::events::{
(B[m[31m-    serialize_event, serialize_event_bytes, DomainEvent,
(B[m[31m-};
(B[m[31m-use zjj_core::domain::identifiers::{AgentId, BeadId, SessionName, WorkspaceName};
(B[m use chrono::Utc;
[32m+use criterion::{black_box, criterion_group, criterion_main, BenchmarkId, Criterion, Throughput};
(B[m use std::path::PathBuf;
[32m+use zjj_core::domain::events::{serialize_event, serialize_event_bytes, DomainEvent};
(B[m[32m+use zjj_core::domain::identifiers::{AgentId, BeadId, SessionName, WorkspaceName};
(B[m 
 // ============================================================================
 // FIXTURES
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/event_serialization.rs:308:
             events.iter().map(|e| serialize_event(e)).collect();
         let json_batch = json_batch.expect("serialization failed");
 
[31m-        group.bench_with_input(BenchmarkId::from_parameter(size), &json_batch, |b, batch| {
(B[m[31m-            b.iter(|| {
(B[m[31m-                let _results: Result<Vec<DomainEvent>, _> =
(B[m[31m-                    batch.iter().map(|j| serde_json::from_str(j)).collect();
(B[m[31m-            });
(B[m[31m-        });
(B[m[32m+        group.bench_with_input(
(B[m[32m+            BenchmarkId::from_parameter(size),
(B[m[32m+            &json_batch,
(B[m[32m+            |b, batch| {
(B[m[32m+                b.iter(|| {
(B[m[32m+                    let _results: Result<Vec<DomainEvent>, _> =
(B[m[32m+                        batch.iter().map(|j| serde_json::from_str(j)).collect();
(B[m[32m+                });
(B[m[32m+            },
(B[m[32m+        );
(B[m     }
 
     group.finish();
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/identifier_parsing.rs:12:
 //! during construction, ensuring the type cannot represent invalid states.
 
 use criterion::{black_box, criterion_group, criterion_main, BenchmarkId, Criterion};
[31m-use zjj_core::domain::identifiers::{
(B[m[31m-    AgentId, QueueEntryId, SessionName, TaskId, WorkspaceName,
(B[m[31m-};
(B[m[32m+use zjj_core::domain::identifiers::{AgentId, QueueEntryId, SessionName, TaskId, WorkspaceName};
(B[m 
 // ============================================================================
 // FIXTURES
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/identifier_parsing.rs:322:
 // ============================================================================
 
 fn bench_bulk_session_name_parsing(c: &mut Criterion) {
[31m-    let names: Vec<String> = (0..100)
(B[m[31m-        .map(|i| format!("session-{:?}", i))
(B[m[31m-        .collect();
(B[m[32m+    let names: Vec<String> = (0..100).map(|i| format!("session-{:?}", i)).collect();
(B[m 
     let mut group = c.benchmark_group("bulk_parsing");
 
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/identifier_parsing.rs:331:
     group.bench_function("parse_100_session_names", |b| {
         b.iter(|| {
[31m-            let _parsed: Result<Vec<_>, _> = names
(B[m[31m-                .iter()
(B[m[31m-                .map(|n| SessionName::parse(n))
(B[m[31m-                .collect();
(B[m[32m+            let _parsed: Result<Vec<_>, _> = names.iter().map(|n| SessionName::parse(n)).collect();
(B[m         });
     });
 
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/identifier_parsing.rs:340:
     // Compare with iterator approach (more idiomatic)
     group.bench_function("parse_100_session_names_iter", |b| {
         b.iter(|| {
[31m-            let _parsed: Result<Vec<_>, _> = names
(B[m[31m-                .iter()
(B[m[31m-                .map(|n| SessionName::parse(n))
(B[m[31m-                .collect();
(B[m[32m+            let _parsed: Result<Vec<_>, _> = names.iter().map(|n| SessionName::parse(n)).collect();
(B[m         });
     });
 
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/repository_operations.rs:12:
 //! identify bottlenecks in persistence operations.
 
 use criterion::{black_box, criterion_group, criterion_main, BenchmarkId, Criterion};
[31m-use zjj_core::domain::identifiers::{SessionId, SessionName, WorkspaceName};
(B[m[31m-use zjj_core::domain::repository::{SessionRepository, WorkspaceRepository};
(B[m use std::path::PathBuf;
 use std::sync::{Arc, Mutex};
[32m+use zjj_core::domain::identifiers::{SessionId, SessionName, WorkspaceName};
(B[m[32m+use zjj_core::domain::repository::{SessionRepository, WorkspaceRepository};
(B[m 
 // ============================================================================
 // MOCK REPOSITORY IMPLEMENTATION
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/repository_operations.rs:41:
 }
 
 impl SessionRepository for MockSessionRepo {
[31m-    fn load(&self, id: &SessionId) -> zjj_core::domain::repository::RepositoryResult<zjj_core::domain::repository::Session> {
(B[m[32m+    fn load(
(B[m[32m+        &self,
(B[m[32m+        id: &SessionId,
(B[m[32m+    ) -> zjj_core::domain::repository::RepositoryResult<zjj_core::domain::repository::Session> {
(B[m         self.sessions
             .lock()
[31m-            .map_err(|e| zjj_core::domain::repository::RepositoryError::StorageError(e.to_string()))?
(B[m[32m+            .map_err(|e| {
(B[m[32m+                zjj_core::domain::repository::RepositoryError::StorageError(e.to_string())
(B[m[32m+            })?
(B[m             .iter()
             .find(|s| &s.id == id)
             .cloned()
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/repository_operations.rs:51:
             .ok_or_else(|| zjj_core::domain::repository::RepositoryError::not_found("session", id))
     }
 
[31m-    fn load_by_name(&self, name: &SessionName) -> zjj_core::domain::repository::RepositoryResult<zjj_core::domain::repository::Session> {
(B[m[32m+    fn load_by_name(
(B[m[32m+        &self,
(B[m[32m+        name: &SessionName,
(B[m[32m+    ) -> zjj_core::domain::repository::RepositoryResult<zjj_core::domain::repository::Session> {
(B[m         self.sessions
             .lock()
[31m-            .map_err(|e| zjj_core::domain::repository::RepositoryError::StorageError(e.to_string()))?
(B[m[32m+            .map_err(|e| {
(B[m[32m+                zjj_core::domain::repository::RepositoryError::StorageError(e.to_string())
(B[m[32m+            })?
(B[m             .iter()
             .find(|s| &s.name == name)
             .cloned()
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/repository_operations.rs:61:
[31m-            .ok_or_else(|| zjj_core::domain::repository::RepositoryError::not_found("session", name))
(B[m[32m+            .ok_or_else(|| {
(B[m[32m+                zjj_core::domain::repository::RepositoryError::not_found("session", name)
(B[m[32m+            })
(B[m     }
 
[31m-    fn save(&self, session: &zjj_core::domain::repository::Session) -> zjj_core::domain::repository::RepositoryResult<()> {
(B[m[31m-        let mut sessions = self
(B[m[31m-            .sessions
(B[m[31m-            .lock()
(B[m[31m-            .map_err(|e| zjj_core::domain::repository::RepositoryError::StorageError(e.to_string()))?;
(B[m[32m+    fn save(
(B[m[32m+        &self,
(B[m[32m+        session: &zjj_core::domain::repository::Session,
(B[m[32m+    ) -> zjj_core::domain::repository::RepositoryResult<()> {
(B[m[32m+        let mut sessions = self.sessions.lock().map_err(|e| {
(B[m[32m+            zjj_core::domain::repository::RepositoryError::StorageError(e.to_string())
(B[m[32m+        })?;
(B[m 
         if let Some(pos) = sessions.iter().position(|s| s.id == session.id) {
             sessions[pos] = session.clone();
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/repository_operations.rs:76:
     }
 
     fn delete(&self, id: &SessionId) -> zjj_core::domain::repository::RepositoryResult<()> {
[31m-        let mut sessions = self
(B[m[31m-            .sessions
(B[m[31m-            .lock()
(B[m[31m-            .map_err(|e| zjj_core::domain::repository::RepositoryError::StorageError(e.to_string()))?;
(B[m[32m+        let mut sessions = self.sessions.lock().map_err(|e| {
(B[m[32m+            zjj_core::domain::repository::RepositoryError::StorageError(e.to_string())
(B[m[32m+        })?;
(B[m 
[31m-        let pos = sessions
(B[m[31m-            .iter()
(B[m[31m-            .position(|s| &s.id == id)
(B[m[31m-            .ok_or_else(|| zjj_core::domain::repository::RepositoryError::not_found("session", id))?;
(B[m[32m+        let pos = sessions.iter().position(|s| &s.id == id).ok_or_else(|| {
(B[m[32m+            zjj_core::domain::repository::RepositoryError::not_found("session", id)
(B[m[32m+        })?;
(B[m 
         sessions.remove(pos);
         Ok(())
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/repository_operations.rs:91:
     }
 
[31m-    fn list_all(&self) -> zjj_core::domain::repository::RepositoryResult<Vec<zjj_core::domain::repository::Session>> {
(B[m[32m+    fn list_all(
(B[m[32m+        &self,
(B[m[32m+    ) -> zjj_core::domain::repository::RepositoryResult<Vec<zjj_core::domain::repository::Session>>
(B[m[32m+    {
(B[m         self.sessions
             .lock()
             .map_err(|e| zjj_core::domain::repository::RepositoryError::StorageError(e.to_string()))
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/repository_operations.rs:97:
             .map(|v| v.clone())
     }
 
[31m-    fn get_current(&self) -> zjj_core::domain::repository::RepositoryResult<Option<zjj_core::domain::repository::Session>> {
(B[m[32m+    fn get_current(
(B[m[32m+        &self,
(B[m[32m+    ) -> zjj_core::domain::repository::RepositoryResult<Option<zjj_core::domain::repository::Session>>
(B[m[32m+    {
(B[m         self.list_all().map(|sessions| sessions.first().cloned())
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/repository_operations.rs:132:
 }
 
 impl WorkspaceRepository for MockWorkspaceRepo {
[31m-    fn load(&self, name: &WorkspaceName) -> zjj_core::domain::repository::RepositoryResult<zjj_core::domain::repository::Workspace> {
(B[m[32m+    fn load(
(B[m[32m+        &self,
(B[m[32m+        name: &WorkspaceName,
(B[m[32m+    ) -> zjj_core::domain::repository::RepositoryResult<zjj_core::domain::repository::Workspace>
(B[m[32m+    {
(B[m         self.workspaces
             .lock()
[31m-            .map_err(|e| zjj_core::domain::repository::RepositoryError::StorageError(e.to_string()))?
(B[m[32m+            .map_err(|e| {
(B[m[32m+                zjj_core::domain::repository::RepositoryError::StorageError(e.to_string())
(B[m[32m+            })?
(B[m             .iter()
             .find(|w| &w.name == name)
             .cloned()
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/repository_operations.rs:142:
[31m-            .ok_or_else(|| zjj_core::domain::repository::RepositoryError::not_found("workspace", name))
(B[m[32m+            .ok_or_else(|| {
(B[m[32m+                zjj_core::domain::repository::RepositoryError::not_found("workspace", name)
(B[m[32m+            })
(B[m     }
 
[31m-    fn save(&self, workspace: &zjj_core::domain::repository::Workspace) -> zjj_core::domain::repository::RepositoryResult<()> {
(B[m[31m-        let mut workspaces = self
(B[m[31m-            .workspaces
(B[m[31m-            .lock()
(B[m[31m-            .map_err(|e| zjj_core::domain::repository::RepositoryError::StorageError(e.to_string()))?;
(B[m[32m+    fn save(
(B[m[32m+        &self,
(B[m[32m+        workspace: &zjj_core::domain::repository::Workspace,
(B[m[32m+    ) -> zjj_core::domain::repository::RepositoryResult<()> {
(B[m[32m+        let mut workspaces = self.workspaces.lock().map_err(|e| {
(B[m[32m+            zjj_core::domain::repository::RepositoryError::StorageError(e.to_string())
(B[m[32m+        })?;
(B[m 
         if let Some(pos) = workspaces.iter().position(|w| w.name == workspace.name) {
             workspaces[pos] = workspace.clone();
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/repository_operations.rs:157:
     }
 
     fn delete(&self, name: &WorkspaceName) -> zjj_core::domain::repository::RepositoryResult<()> {
[31m-        let mut workspaces = self
(B[m[31m-            .workspaces
(B[m[31m-            .lock()
(B[m[31m-            .map_err(|e| zjj_core::domain::repository::RepositoryError::StorageError(e.to_string()))?;
(B[m[32m+        let mut workspaces = self.workspaces.lock().map_err(|e| {
(B[m[32m+            zjj_core::domain::repository::RepositoryError::StorageError(e.to_string())
(B[m[32m+        })?;
(B[m 
         let pos = workspaces
             .iter()
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/repository_operations.rs:167:
             .position(|w| &w.name == name)
[31m-            .ok_or_else(|| zjj_core::domain::repository::RepositoryError::not_found("workspace", name))?;
(B[m[32m+            .ok_or_else(|| {
(B[m[32m+                zjj_core::domain::repository::RepositoryError::not_found("workspace", name)
(B[m[32m+            })?;
(B[m 
         workspaces.remove(pos);
         Ok(())
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/repository_operations.rs:172:
     }
 
[31m-    fn list_all(&self) -> zjj_core::domain::repository::RepositoryResult<Vec<zjj_core::domain::repository::Workspace>> {
(B[m[32m+    fn list_all(
(B[m[32m+        &self,
(B[m[32m+    ) -> zjj_core::domain::repository::RepositoryResult<Vec<zjj_core::domain::repository::Workspace>>
(B[m[32m+    {
(B[m         self.workspaces
             .lock()
             .map_err(|e| zjj_core::domain::repository::RepositoryError::StorageError(e.to_string()))
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/repository_operations.rs:277:
 
     // Load from larger collection
     for count in [10, 50, 100].iter() {
[31m-        group.bench_with_input(BenchmarkId::new("from_collection", count), count, |b, count| {
(B[m[31m-            let sessions = test_sessions(*count);
(B[m[31m-            let id = sessions[0].id.clone();
(B[m[31m-            let repo = MockSessionRepo::with_sessions(sessions);
(B[m[32m+        group.bench_with_input(
(B[m[32m+            BenchmarkId::new("from_collection", count),
(B[m[32m+            count,
(B[m[32m+            |b, count| {
(B[m[32m+                let sessions = test_sessions(*count);
(B[m[32m+                let id = sessions[0].id.clone();
(B[m[32m+                let repo = MockSessionRepo::with_sessions(sessions);
(B[m 
[31m-            b.iter(|| {
(B[m[31m-                let _session = black_box(&repo).load(black_box(&id));
(B[m[31m-            });
(B[m[31m-        });
(B[m[32m+                b.iter(|| {
(B[m[32m+                    let _session = black_box(&repo).load(black_box(&id));
(B[m[32m+                });
(B[m[32m+            },
(B[m[32m+        );
(B[m     }
 
     group.finish();
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/state_machine.rs:83:
     let mut group = c.benchmark_group("issue_state_transition");
 
     for (idx, (from, to)) in transitions.into_iter().enumerate() {
[31m-        group.bench_with_input(BenchmarkId::new("transition", idx), &(from, to), |b, (from, to)| {
(B[m[31m-            b.iter(|| {
(B[m[31m-                let _result = black_box(from).transition_to(black_box(*to));
(B[m[31m-            });
(B[m[31m-        });
(B[m[32m+        group.bench_with_input(
(B[m[32m+            BenchmarkId::new("transition", idx),
(B[m[32m+            &(from, to),
(B[m[32m+            |b, (from, to)| {
(B[m[32m+                b.iter(|| {
(B[m[32m+                    let _result = black_box(from).transition_to(black_box(*to));
(B[m[32m+                });
(B[m[32m+            },
(B[m[32m+        );
(B[m     }
 
     group.finish();
Diff in /home/lewis/src/zjj/crates/zjj-core/benches/state_machine.rs:320:
     group.bench_function("issue_with_blockers", |b| {
         b.iter(|| {
             let mut issue = test_issue();
[31m-            issue.set_blocked_by(vec!["blocker-1".to_string(), "blocker-2".to_string()])
(B[m[32m+            issue
(B[m[32m+                .set_blocked_by(vec!["blocker-1".to_string(), "blocker-2".to_string()])
(B[m                 .expect("valid");
             issue.transition_to(IssueState::Blocked).expect("valid");
             black_box(&issue);
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj-core/src/beads/db.rs:243:
     validate_bead_for_insert(issue)?;
 
     // Serialize optional fields
[31m-    let priority_str = issue.priority.map(|priority| format!("P{}", priority.to_u32()));
(B[m[32m+    let priority_str = issue
(B[m[32m+        .priority
(B[m[32m+        .map(|priority| format!("P{}", priority.to_u32()));
(B[m     let issue_type_str = issue
         .issue_type
         .as_ref()
Diff in /home/lewis/src/zjj/crates/zjj-core/src/beads/db.rs:375:
     }
 
     // Serialize optional fields
[31m-    let priority_str = issue.priority.map(|priority| format!("P{}", priority.to_u32()));
(B[m[32m+    let priority_str = issue
(B[m[32m+        .priority
(B[m[32m+        .map(|priority| format!("P{}", priority.to_u32()));
(B[m     let issue_type_str = issue
         .issue_type
         .as_ref()
Diff in /home/lewis/src/zjj/crates/zjj-core/src/beads/domain.rs:118:
     /// Get the inner string value.
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/beads/domain.rs:192:
     /// Get the inner string value.
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/beads/domain.rs:255:
     /// Get the inner string value.
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/beads/domain.rs:327:
     /// Get the inner string value.
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/beads/domain.rs:775:
         assert!(Labels::new(vec!["label1".to_string(), "label2".to_string()]).is_ok());
 
         // Test exceeding max count
[31m-        let too_many_labels: Vec<String> =
(B[m[31m-            (0..=Labels::MAX_COUNT).map(|i| format!("label{i}")).collect();
(B[m[32m+        let too_many_labels: Vec<String> = (0..=Labels::MAX_COUNT)
(B[m[32m+            .map(|i| format!("label{i}"))
(B[m[32m+            .collect();
(B[m         assert!(Labels::new(too_many_labels).is_err());
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/beads/invariant_tests.rs:41:
         // Mixed separators
         "[a-z0-9]{1,5}[-_][a-z0-9]{1,5}[-_][a-z0-9]{1,5}",
     ]
[31m-    .prop_filter("valid ID", |s| !s.is_empty() && s.len() <= IssueId::MAX_LENGTH)
(B[m[32m+    .prop_filter("valid ID", |s| {
(B[m[32m+        !s.is_empty() && s.len() <= IssueId::MAX_LENGTH
(B[m[32m+    })
(B[m }
 
 /// Generate valid issue IDs for vector contexts (simpler)
Diff in /home/lewis/src/zjj/crates/zjj-core/src/beads/invariant_tests.rs:104:
 
 /// Generate too many labels (exceeds limit)
 fn too_many_labels_strategy() -> impl Strategy<Value = Vec<String>> {
[31m-    prop::collection::vec(label_strategy(), Labels::MAX_COUNT + 1..=Labels::MAX_COUNT + 5)
(B[m[32m+    prop::collection::vec(
(B[m[32m+        label_strategy(),
(B[m[32m+        Labels::MAX_COUNT + 1..=Labels::MAX_COUNT + 5,
(B[m[32m+    )
(B[m }
 
 /// Generate valid issue states
Diff in /home/lewis/src/zjj/crates/zjj-core/src/beads/invariant_tests.rs:212:
     let too_long = "a".repeat(Description::MAX_LENGTH + 1);
     let result = Description::new(&too_long);
     assert!(result.is_err());
[31m-    assert!(matches!(result, Err(DomainError::DescriptionTooLong { .. })));
(B[m[32m+    assert!(matches!(
(B[m[32m+        result,
(B[m[32m+        Err(DomainError::DescriptionTooLong { .. })
(B[m[32m+    ));
(B[m }
 
 #[test]
Diff in /home/lewis/src/zjj/crates/zjj-core/src/beads/state_transition_tests.rs:184:
     for new_state in states {
         let mut test_issue = Issue::new("test-1", "Test Issue").unwrap();
         let result = test_issue.transition_to(new_state.clone());
[31m-        assert!(
(B[m[31m-            result.is_ok(),
(B[m[31m-            "Open -> {:?} should succeed",
(B[m[31m-            new_state
(B[m[31m-        );
(B[m[32m+        assert!(result.is_ok(), "Open -> {:?} should succeed", new_state);
(B[m         assert_eq!(test_issue.state, new_state);
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/beads/state_transition_tests.rs:236:
         issue.transition_to(IssueState::Blocked).unwrap();
 
         let result = issue.transition_to(new_state.clone());
[31m-        assert!(
(B[m[31m-            result.is_ok(),
(B[m[31m-            "Blocked -> {:?} should succeed",
(B[m[31m-            new_state
(B[m[31m-        );
(B[m[32m+        assert!(result.is_ok(), "Blocked -> {:?} should succeed", new_state);
(B[m         assert_eq!(issue.state, new_state);
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/beads/state_transition_tests.rs:262:
         issue.transition_to(IssueState::Deferred).unwrap();
 
         let result = issue.transition_to(new_state.clone());
[31m-        assert!(
(B[m[31m-            result.is_ok(),
(B[m[31m-            "Deferred -> {:?} should succeed",
(B[m[31m-            new_state
(B[m[31m-        );
(B[m[32m+        assert!(result.is_ok(), "Deferred -> {:?} should succeed", new_state);
(B[m         assert_eq!(issue.state, new_state);
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/beads/state_transition_tests.rs:288:
         issue.close();
 
         let result = issue.transition_to(new_state.clone());
[31m-        assert!(
(B[m[31m-            result.is_ok(),
(B[m[31m-            "Closed -> {:?} should succeed",
(B[m[31m-            new_state
(B[m[31m-        );
(B[m[32m+        assert!(result.is_ok(), "Closed -> {:?} should succeed", new_state);
(B[m         assert_eq!(issue.state, new_state);
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/beads/types.rs:162:
     #[must_use]
     pub fn is_blocked(&self) -> bool {
         matches!(self.status, IssueStatus::Blocked)
[31m-            || self
(B[m[31m-                .blocked_by
(B[m[31m-                .as_ref()
(B[m[31m-                .is_some_and(|v| !v.is_empty())
(B[m[32m+            || self.blocked_by.as_ref().is_some_and(|v| !v.is_empty())
(B[m     }
 
     #[must_use]
Diff in /home/lewis/src/zjj/crates/zjj-core/src/cli_contracts/domain_types.rs:78:
 impl TaskId {
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/cli_contracts/domain_types.rs:111:
 impl ConfigKey {
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/cli_contracts/domain_types.rs:181:
 impl ConfigValue {
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/cli_contracts/domain_types.rs:663:
 impl NonEmptyString {
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/coordination/domain_types.rs:133:
     /// Get the underlying string value.
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/coordination/domain_types.rs:222:
     #[test]
     fn test_queue_entry_id_zero_is_invalid() {
         let id = QueueEntryId::new(0);
[31m-        assert!(matches!(id, Err(crate::domain::identifiers::IdentifierError::InvalidFormat { .. })));
(B[m[32m+        assert!(matches!(
(B[m[32m+            id,
(B[m[32m+            Err(crate::domain::identifiers::IdentifierError::InvalidFormat { .. })
(B[m[32m+        ));
(B[m     }
 
     #[test]
Diff in /home/lewis/src/zjj/crates/zjj-core/src/coordination/domain_types.rs:229:
     fn test_queue_entry_id_negative_is_invalid() {
         let id = QueueEntryId::new(-1);
[31m-        assert!(matches!(id, Err(crate::domain::identifiers::IdentifierError::InvalidFormat { .. })));
(B[m[32m+        assert!(matches!(
(B[m[32m+            id,
(B[m[32m+            Err(crate::domain::identifiers::IdentifierError::InvalidFormat { .. })
(B[m[32m+        ));
(B[m     }
 
     #[test]
Diff in /home/lewis/src/zjj/crates/zjj-core/src/coordination/domain_types.rs:244:
     #[test]
     fn test_queue_entry_id_from_str_invalid() {
         let id = "abc".parse::<QueueEntryId>();
[31m-        assert!(matches!(id, Err(crate::domain::identifiers::IdentifierError::InvalidFormat { .. })));
(B[m[32m+        assert!(matches!(
(B[m[32m+            id,
(B[m[32m+            Err(crate::domain::identifiers::IdentifierError::InvalidFormat { .. })
(B[m[32m+        ));
(B[m     }
 
     // --- WorkspaceName Tests ---
Diff in /home/lewis/src/zjj/crates/zjj-core/src/coordination/domain_types.rs:265:
     #[test]
     fn test_workspace_name_empty_is_invalid() {
         let name = WorkspaceName::parse("");
[31m-        assert!(matches!(name, Err(crate::domain::identifiers::IdError::Empty)));
(B[m[32m+        assert!(matches!(
(B[m[32m+            name,
(B[m[32m+            Err(crate::domain::identifiers::IdError::Empty)
(B[m[32m+        ));
(B[m     }
 
     #[test]
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/bead.rs:44:
 
     /// Invalid state transition
     #[error("invalid state transition: {from:?} -> {to:?}")]
[31m-    InvalidStateTransition {
(B[m[31m-        from: BeadState,
(B[m[31m-        to: BeadState,
(B[m[31m-    },
(B[m[32m+    InvalidStateTransition { from: BeadState, to: BeadState },
(B[m 
     /// Cannot modify closed bead
     #[error("cannot modify closed bead")]
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/bead.rs:138:
         title: impl Into<String>,
         description: Option<impl Into<String>>,
     ) -> Result<Self, BeadError> {
[31m-        let title = Title::new(title.into())
(B[m[31m-            .map_err(|e| BeadError::InvalidTitle(e.to_string()))?;
(B[m[32m+        let title = Title::new(title.into()).map_err(|e| BeadError::InvalidTitle(e.to_string()))?;
(B[m         let description = description
             .map(|d| {
[31m-                Description::new(d.into())
(B[m[31m-                    .map_err(|e| BeadError::InvalidDescription(e.to_string()))
(B[m[32m+                Description::new(d.into()).map_err(|e| BeadError::InvalidDescription(e.to_string()))
(B[m             })
             .transpose()?;
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/bead.rs:171:
         state: BeadState,
         timestamps: BeadTimestamps,
     ) -> Result<Self, BeadError> {
[31m-        let title = Title::new(title.into())
(B[m[31m-            .map_err(|e| BeadError::InvalidTitle(e.to_string()))?;
(B[m[32m+        let title = Title::new(title.into()).map_err(|e| BeadError::InvalidTitle(e.to_string()))?;
(B[m         let description = description
             .map(|d| {
[31m-                Description::new(d.into())
(B[m[31m-                    .map_err(|e| BeadError::InvalidDescription(e.to_string()))
(B[m[32m+                Description::new(d.into()).map_err(|e| BeadError::InvalidDescription(e.to_string()))
(B[m             })
             .transpose()?;
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/bead.rs:325:
         }
 
         // Validate transition (using domain logic)
[31m-        let _ = self
(B[m[31m-            .state
(B[m[31m-            .transition_to(new_state)
(B[m[31m-            .map_err(|_| BeadError::InvalidStateTransition {
(B[m[31m-                from: self.state,
(B[m[31m-                to: new_state,
(B[m[31m-            })?;
(B[m[32m+        let _ =
(B[m[32m+            self.state
(B[m[32m+                .transition_to(new_state)
(B[m[32m+                .map_err(|_| BeadError::InvalidStateTransition {
(B[m[32m+                    from: self.state,
(B[m[32m+                    to: new_state,
(B[m[32m+                })?;
(B[m 
         Ok(Self {
             state: new_state,
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/bead.rs:355:
             return Err(BeadError::CannotModifyClosed);
         }
 
[31m-        let title = Title::new(new_title.into())
(B[m[31m-            .map_err(|e| BeadError::InvalidTitle(e.to_string()))?;
(B[m[32m+        let title =
(B[m[32m+            Title::new(new_title.into()).map_err(|e| BeadError::InvalidTitle(e.to_string()))?;
(B[m 
         Ok(Self {
             title,
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/bead.rs:381:
 
         let description = new_description
             .map(|d| {
[31m-                Description::new(d.into())
(B[m[31m-                    .map_err(|e| BeadError::InvalidDescription(e.to_string()))
(B[m[32m+                Description::new(d.into()).map_err(|e| BeadError::InvalidDescription(e.to_string()))
(B[m             })
             .transpose()?;
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/bead.rs:408:
             return Err(BeadError::CannotModifyClosed);
         }
 
[31m-        let title = Title::new(new_title.into())
(B[m[31m-            .map_err(|e| BeadError::InvalidTitle(e.to_string()))?;
(B[m[32m+        let title =
(B[m[32m+            Title::new(new_title.into()).map_err(|e| BeadError::InvalidTitle(e.to_string()))?;
(B[m         let description = new_description
             .map(|d| {
[31m-                Description::new(d.into())
(B[m[31m-                    .map_err(|e| BeadError::InvalidDescription(e.to_string()))
(B[m[32m+                Description::new(d.into()).map_err(|e| BeadError::InvalidDescription(e.to_string()))
(B[m             })
             .transpose()?;
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/queue_entry.rs:60:
 pub enum QueueEntryError {
     /// Invalid claim transition
     #[error("invalid claim transition: {from:?} -> {to:?}")]
[31m-    InvalidClaimTransition {
(B[m[31m-        from: ClaimState,
(B[m[31m-        to: ClaimState,
(B[m[31m-    },
(B[m[32m+    InvalidClaimTransition { from: ClaimState, to: ClaimState },
(B[m 
     /// Entry is not claimed
     #[error("entry is not claimed")]
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/queue_entry.rs:227:
     ///
     /// Returns `QueueEntryError::AlreadyClaimed` if entry is already claimed.
     /// Returns `QueueEntryError::InvalidExpiration` if duration is invalid.
[31m-    pub fn claim(
(B[m[31m-        &self,
(B[m[31m-        agent: AgentId,
(B[m[31m-        claim_duration_secs: i64,
(B[m[31m-    ) -> Result<Self, QueueEntryError> {
(B[m[32m+    pub fn claim(&self, agent: AgentId, claim_duration_secs: i64) -> Result<Self, QueueEntryError> {
(B[m         if !self.is_unclaimed() {
             // Get the holder if it exists
             if let Some(holder) = self.claim_holder() {
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/queue_entry.rs:426:
                 return Err(QueueEntryError::AlreadyClaimed(holder.clone()));
             }
             // Fallback - should not happen in practice
[31m-            let fallback = AgentId::parse("unknown").map_err(|_| QueueEntryError::InvalidExpiration)?;
(B[m[32m+            let fallback =
(B[m[32m+                AgentId::parse("unknown").map_err(|_| QueueEntryError::InvalidExpiration)?;
(B[m             return Err(QueueEntryError::AlreadyClaimed(fallback));
         }
         Ok(())
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/queue_entry.rs:603:
         let claimed = entry.claim(agent, 300).expect("claim valid");
 
         let result = claimed.update_priority(10);
[31m-        assert!(matches!(
(B[m[31m-            result,
(B[m[31m-            Err(QueueEntryError::CannotModify(_))
(B[m[31m-        ));
(B[m[32m+        assert!(matches!(result, Err(QueueEntryError::CannotModify(_))));
(B[m     }
 
     #[test]
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/session.rs:38:
 pub enum SessionError {
     /// Invalid branch transition
     #[error("invalid branch transition: {from:?} -> {to:?}")]
[31m-    InvalidBranchTransition {
(B[m[31m-        from: BranchState,
(B[m[31m-        to: BranchState,
(B[m[31m-    },
(B[m[32m+    InvalidBranchTransition { from: BranchState, to: BranchState },
(B[m 
     /// Invalid parent transition
     #[error("invalid parent transition: {from:?} -> {to:?}")]
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/session.rs:48:
[31m-    InvalidParentTransition {
(B[m[31m-        from: ParentState,
(B[m[31m-        to: ParentState,
(B[m[31m-    },
(B[m[32m+    InvalidParentTransition { from: ParentState, to: ParentState },
(B[m 
     /// Workspace path does not exist
     #[error("workspace path does not exist: {0}")]
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/session.rs:286:
     /// Returns `SessionError::WorkspaceNotFound` if workspace path doesn't exist.
     pub fn validate(&self) -> Result<(), SessionError> {
         if !self.workspace_path.exists() {
[31m-            return Err(SessionError::WorkspaceNotFound(
(B[m[31m-                self.workspace_path.clone(),
(B[m[31m-            ));
(B[m[32m+            return Err(SessionError::WorkspaceNotFound(self.workspace_path.clone()));
(B[m         }
         Ok(())
     }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/session.rs:379:
             Some(ParentState::ChildOf { parent }) => {
                 Session::new_child(id, name, branch, parent, workspace_path)
             }
[31m-            Some(ParentState::Root) | None => {
(B[m[31m-                Session::new_root(id, name, branch, workspace_path)
(B[m[31m-            }
(B[m[32m+            Some(ParentState::Root) | None => Session::new_root(id, name, branch, workspace_path),
(B[m         }
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/session.rs:445:
         let name = SessionName::parse("test").expect("valid name");
         let workspace = PathBuf::from("/tmp");
 
[31m-        let session = Session::new_root(
(B[m[31m-            id,
(B[m[31m-            name,
(B[m[31m-            BranchState::Detached,
(B[m[31m-            workspace,
(B[m[31m-        )
(B[m[31m-        .expect("session created");
(B[m[32m+        let session =
(B[m[32m+            Session::new_root(id, name, BranchState::Detached, workspace).expect("session created");
(B[m 
         // Detached -> OnBranch is valid
         let new_branch = BranchState::OnBranch {
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/session.rs:487:
         let name = SessionName::parse("test").expect("valid name");
         let workspace = PathBuf::from("/tmp");
 
[31m-        let session = Session::new_root(id, name, BranchState::Detached, workspace)
(B[m[31m-            .expect("session created");
(B[m[32m+        let session =
(B[m[32m+            Session::new_root(id, name, BranchState::Detached, workspace).expect("session created");
(B[m 
         // Detached -> Detached is invalid (no self-loop)
         let result = session.transition_branch(BranchState::Detached);
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/session.rs:505:
         let parent1 = SessionName::parse("parent1").expect("valid name");
         let workspace = PathBuf::from("/tmp");
 
[31m-        let session = Session::new_child(
(B[m[31m-            id,
(B[m[31m-            name,
(B[m[31m-            BranchState::Detached,
(B[m[31m-            parent1.clone(),
(B[m[31m-            workspace,
(B[m[31m-        )
(B[m[31m-        .expect("session created");
(B[m[32m+        let session =
(B[m[32m+            Session::new_child(id, name, BranchState::Detached, parent1.clone(), workspace)
(B[m[32m+                .expect("session created");
(B[m 
         // Child can change parent (adoption)
         let parent2 = SessionName::parse("parent2").expect("valid name");
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/session.rs:533:
         let name = SessionName::parse("root").expect("valid name");
         let workspace = PathBuf::from("/tmp");
 
[31m-        let session = Session::new_root(
(B[m[31m-            id,
(B[m[31m-            name,
(B[m[31m-            BranchState::Detached,
(B[m[31m-            workspace,
(B[m[31m-        )
(B[m[31m-        .expect("session created");
(B[m[32m+        let session =
(B[m[32m+            Session::new_root(id, name, BranchState::Detached, workspace).expect("session created");
(B[m 
         // Root cannot become child
         let new_parent = ParentState::ChildOf {
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/session.rs:547:
         };
 
         let result = session.transition_parent(new_parent);
[31m-        assert!(matches!(
(B[m[31m-            result,
(B[m[31m-            Err(SessionError::CannotModifyRootParent)
(B[m[31m-        ));
(B[m[32m+        assert!(matches!(result, Err(SessionError::CannotModifyRootParent)));
(B[m     }
 
     #[test]
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/session.rs:559:
         let name = SessionName::parse("test").expect("valid name");
         let workspace = PathBuf::from("/nonexistent/path/that/does/not/exist");
 
[31m-        let result = Session::new_root(
(B[m[31m-            id,
(B[m[31m-            name,
(B[m[31m-            BranchState::Detached,
(B[m[31m-            workspace,
(B[m[31m-        );
(B[m[32m+        let result = Session::new_root(id, name, BranchState::Detached, workspace);
(B[m 
[31m-        assert!(matches!(
(B[m[31m-            result,
(B[m[31m-            Err(SessionError::WorkspaceNotFound(_))
(B[m[31m-        ));
(B[m[32m+        assert!(matches!(result, Err(SessionError::WorkspaceNotFound(_))));
(B[m     }
 
     #[test]
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/session.rs:600:
         let name2 = SessionName::parse("name2").expect("valid name");
         let workspace = PathBuf::from("/tmp");
 
[31m-        let session = Session::new_root(
(B[m[31m-            id,
(B[m[31m-            name1,
(B[m[31m-            BranchState::Detached,
(B[m[31m-            workspace,
(B[m[31m-        )
(B[m[31m-        .expect("session created");
(B[m[32m+        let session = Session::new_root(id, name1, BranchState::Detached, workspace)
(B[m[32m+            .expect("session created");
(B[m 
         let renamed = session.rename(name2.clone());
         assert_eq!(renamed.name, name2);
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/workspace.rs:365:
     /// - Required fields are missing
     /// - Path doesn't exist
     pub fn build(self) -> Result<Workspace, WorkspaceError> {
[31m-        let name = self.name.ok_or_else(|| WorkspaceError::CannotUse(
(B[m[31m-            WorkspaceState::Creating, // Using existing error for missing name
(B[m[31m-        ))?;
(B[m[31m-        let path = self.path.ok_or_else(|| WorkspaceError::CannotUse(
(B[m[31m-            WorkspaceState::Creating, // Using existing error for missing path
(B[m[31m-        ))?;
(B[m[32m+        let name = self.name.ok_or_else(|| {
(B[m[32m+            WorkspaceError::CannotUse(
(B[m[32m+                WorkspaceState::Creating, // Using existing error for missing name
(B[m[32m+            )
(B[m[32m+        })?;
(B[m[32m+        let path = self.path.ok_or_else(|| {
(B[m[32m+            WorkspaceError::CannotUse(
(B[m[32m+                WorkspaceState::Creating, // Using existing error for missing path
(B[m[32m+            )
(B[m[32m+        })?;
(B[m 
         match self.state {
             Some(state) => Workspace::reconstruct(name, path, state),
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/aggregates/workspace.rs:543:
         let workspace = create_test_workspace();
         let new_path = PathBuf::from("/var/tmp");
 
[31m-        let changed = workspace.change_path(new_path.clone()).expect("path changed");
(B[m[32m+        let changed = workspace
(B[m[32m+            .change_path(new_path.clone())
(B[m[32m+            .expect("path changed");
(B[m         assert_eq!(changed.path, new_path);
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/builders.rs:44:
     AgentAssignment, BaseRef, BeadAttachment, IssueId, IssueScope, IssueTitle, Message,
     PlanDescription, PlanTitle, QueueEntryId, TrainId,
 };
[31m-use crate::types::SessionStatus as TypesSessionStatus;
(B[m[31m-use crate::WorkspaceState as TypesWorkspaceState;
(B[m use crate::output::{
     Action, ActionResult as OutputActionResult, ActionStatus, ActionTarget,
     ActionVerb as OutputActionVerb, ConflictDetail, Issue, IssueKind as OutputIssueKind,
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/builders.rs:52:
[31m-    IssueSeverity, Plan, PlanStep, QueueEntry, QueueEntryStatus, SessionOutput, Stack,
(B[m[31m-    StackEntry, StackEntryStatus, Summary, SummaryType as OutputSummaryType, Train,
(B[m[31m-    TrainAction, TrainStep, TrainStepStatus, TrainStatus,
(B[m[32m+    IssueSeverity, Plan, PlanStep, QueueEntry, QueueEntryStatus, SessionOutput, Stack, StackEntry,
(B[m[32m+    StackEntryStatus, Summary, SummaryType as OutputSummaryType, Train, TrainAction, TrainStatus,
(B[m[32m+    TrainStep, TrainStepStatus,
(B[m };
[32m+use crate::types::SessionStatus as TypesSessionStatus;
(B[m[32m+use crate::WorkspaceState as TypesWorkspaceState;
(B[m 
 // ==============================================================================
 // BUILDER ERROR TYPES
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/builders.rs:68:
     InvalidValue { field: &'static str, reason: String },
 
     /// Collection overflow
[31m-    Overflow { field: &'static str, capacity: usize },
(B[m[32m+    Overflow {
(B[m[32m+        field: &'static str,
(B[m[32m+        capacity: usize,
(B[m[32m+    },
(B[m 
     /// Invalid state transition
     InvalidTransition {
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/builders.rs:227:
     /// Returns `BuilderError::InvalidValue` if validation fails.
     pub fn build(self) -> Result<SessionOutput, BuilderError> {
         // Validate required fields
[31m-        let name = self.name.ok_or(BuilderError::MissingRequired { field: "name" })?;
(B[m[31m-        let status = self.status.ok_or(BuilderError::MissingRequired { field: "status" })?;
(B[m[31m-        let state = self.state.ok_or(BuilderError::MissingRequired { field: "state" })?;
(B[m[31m-        let workspace_path = self
(B[m[31m-            .workspace_path
(B[m[31m-            .ok_or(BuilderError::MissingRequired {
(B[m[31m-                field: "workspace_path",
(B[m[31m-            })?;
(B[m[32m+        let name = self
(B[m[32m+            .name
(B[m[32m+            .ok_or(BuilderError::MissingRequired { field: "name" })?;
(B[m[32m+        let status = self
(B[m[32m+            .status
(B[m[32m+            .ok_or(BuilderError::MissingRequired { field: "status" })?;
(B[m[32m+        let state = self
(B[m[32m+            .state
(B[m[32m+            .ok_or(BuilderError::MissingRequired { field: "state" })?;
(B[m[32m+        let workspace_path = self.workspace_path.ok_or(BuilderError::MissingRequired {
(B[m[32m+            field: "workspace_path",
(B[m[32m+        })?;
(B[m 
         // Convert status to the output type
         let output_status = convert_session_status(status);
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/builders.rs:380:
     ///
     /// Returns `BuilderError::MissingRequired` if any required field is not set.
     pub fn build(self) -> Result<Issue, BuilderError> {
[31m-        let id = self.id.ok_or(BuilderError::MissingRequired { field: "id" })?;
(B[m[32m+        let id = self
(B[m[32m+            .id
(B[m[32m+            .ok_or(BuilderError::MissingRequired { field: "id" })?;
(B[m         let title = self
             .title
             .ok_or(BuilderError::MissingRequired { field: "title" })?;
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/builders.rs:387:
[31m-        let kind = self.kind.ok_or(BuilderError::MissingRequired { field: "kind" })?;
(B[m[32m+        let kind = self
(B[m[32m+            .kind
(B[m[32m+            .ok_or(BuilderError::MissingRequired { field: "kind" })?;
(B[m         let severity = self
             .severity
             .ok_or(BuilderError::MissingRequired { field: "severity" })?;
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/builders.rs:512:
         let title = self
             .title
             .ok_or(BuilderError::MissingRequired { field: "title" })?;
[31m-        let description = self
(B[m[31m-            .description
(B[m[31m-            .ok_or(BuilderError::MissingRequired {
(B[m[31m-                field: "description",
(B[m[31m-            })?;
(B[m[32m+        let description = self.description.ok_or(BuilderError::MissingRequired {
(B[m[32m+            field: "description",
(B[m[32m+        })?;
(B[m 
         let steps = self
             .steps
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/builders.rs:660:
     ///
     /// Returns `BuilderError::MissingRequired` if any required field is not set.
     pub fn build(self) -> Result<QueueEntry, BuilderError> {
[31m-        let id = self.id.ok_or(BuilderError::MissingRequired { field: "id" })?;
(B[m[32m+        let id = self
(B[m[32m+            .id
(B[m[32m+            .ok_or(BuilderError::MissingRequired { field: "id" })?;
(B[m         let session = self
             .session
             .ok_or(BuilderError::MissingRequired { field: "session" })?;
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/builders.rs:787:
     ///
     /// Returns `BuilderError::MissingRequired` if any required field is not set.
     pub fn build(self) -> Result<Stack, BuilderError> {
[31m-        let name = self.name.ok_or(BuilderError::MissingRequired { field: "name" })?;
(B[m[32m+        let name = self
(B[m[32m+            .name
(B[m[32m+            .ok_or(BuilderError::MissingRequired { field: "name" })?;
(B[m         let base_ref = self
             .base_ref
             .ok_or(BuilderError::MissingRequired { field: "base_ref" })?;
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/builders.rs:968:
     ///
     /// Returns `BuilderError::MissingRequired` if any required field is not set.
     pub fn build(self) -> Result<Train, BuilderError> {
[31m-        let id = self.id.ok_or(BuilderError::MissingRequired { field: "id" })?;
(B[m[31m-        let name = self.name.ok_or(BuilderError::MissingRequired { field: "name" })?;
(B[m[32m+        let id = self
(B[m[32m+            .id
(B[m[32m+            .ok_or(BuilderError::MissingRequired { field: "id" })?;
(B[m[32m+        let name = self
(B[m[32m+            .name
(B[m[32m+            .ok_or(BuilderError::MissingRequired { field: "name" })?;
(B[m 
         let steps = self
             .steps
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/builders.rs:1079:
     ///
     /// Returns `BuilderError::MissingRequired` if any required field is not set.
     pub fn build(self) -> Result<crate::domain::agent::AgentInfo, BuilderError> {
[31m-        let id = self.id.ok_or(BuilderError::MissingRequired { field: "id" })?;
(B[m[32m+        let id = self
(B[m[32m+            .id
(B[m[32m+            .ok_or(BuilderError::MissingRequired { field: "id" })?;
(B[m         let state = self
             .state
             .ok_or(BuilderError::MissingRequired { field: "state" })?;
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/builders.rs:1163:
     ///
     /// Returns `BuilderError::MissingRequired` if any required field is not set.
     pub fn build(self) -> Result<crate::domain::workspace::WorkspaceInfo, BuilderError> {
[31m-        let path = self.path.ok_or(BuilderError::MissingRequired { field: "path" })?;
(B[m[32m+        let path = self
(B[m[32m+            .path
(B[m[32m+            .ok_or(BuilderError::MissingRequired { field: "path" })?;
(B[m         let state = self
             .state
             .ok_or(BuilderError::MissingRequired { field: "state" })?;
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/builders.rs:1263:
     ///
     /// Returns `BuilderError::MissingRequired` if any required field is not set.
     pub fn build(self) -> Result<Summary, BuilderError> {
[31m-        let type_field = self
(B[m[31m-            .type_field
(B[m[31m-            .ok_or(BuilderError::MissingRequired {
(B[m[31m-                field: "type_field",
(B[m[31m-            })?;
(B[m[32m+        let type_field = self.type_field.ok_or(BuilderError::MissingRequired {
(B[m[32m+            field: "type_field",
(B[m[32m+        })?;
(B[m         let message = self
             .message
             .ok_or(BuilderError::MissingRequired { field: "message" })?;
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/builders.rs:1376:
     ///
     /// Returns `BuilderError::MissingRequired` if any required field is not set.
     pub fn build(self) -> Result<Action, BuilderError> {
[31m-        let verb = self.verb.ok_or(BuilderError::MissingRequired { field: "verb" })?;
(B[m[32m+        let verb = self
(B[m[32m+            .verb
(B[m[32m+            .ok_or(BuilderError::MissingRequired { field: "verb" })?;
(B[m         let target = self
             .target
             .ok_or(BuilderError::MissingRequired { field: "target" })?;
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/builders.rs:1518:
     ///
     /// Returns `BuilderError::MissingRequired` if any required field is not set.
     pub fn build(self) -> Result<ConflictDetail, BuilderError> {
[31m-        let file = self.file.ok_or(BuilderError::MissingRequired { field: "file" })?;
(B[m[32m+        let file = self
(B[m[32m+            .file
(B[m[32m+            .ok_or(BuilderError::MissingRequired { field: "file" })?;
(B[m 
         let conflict_type = self.conflict_type.unwrap_or(ConflictType::Overlapping);
         let recommended = self.recommended.unwrap_or(ResolutionStrategy::JjResolve);
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/builders.rs:1781:
 
         assert!(result.is_ok());
         let action = result.unwrap();
[31m-        assert!(matches!(action.result, OutputActionResult::Completed { .. }));
(B[m[32m+        assert!(matches!(
(B[m[32m+            action.result,
(B[m[32m+            OutputActionResult::Completed { .. }
(B[m[32m+        ));
(B[m     }
 
     #[test]
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/error_conversion.rs:93:
                 Self::NotFound(format!("workspace not found: {}", path.display()))
             }
             SessionError::NotActive => Self::InvalidInput("session is not active".into()),
[31m-            SessionError::CannotActivate => {
(B[m[31m-                Self::InvalidInput("cannot activate session".into())
(B[m[31m-            }
(B[m[32m+            SessionError::CannotActivate => Self::InvalidInput("cannot activate session".into()),
(B[m             SessionError::CannotModifyRootParent => {
                 Self::InvalidInput("cannot modify parent of root session".into())
             }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/error_conversion.rs:168:
             QueueEntryError::InvalidClaimTransition { from, to } => {
                 Self::InvalidInput(format!("invalid claim transition: {from:?} -> {to:?}"))
             }
[31m-            QueueEntryError::NotClaimed => {
(B[m[31m-                Self::InvalidInput("queue entry is not claimed".into())
(B[m[31m-            }
(B[m[32m+            QueueEntryError::NotClaimed => Self::InvalidInput("queue entry is not claimed".into()),
(B[m             QueueEntryError::AlreadyClaimed(agent) => {
                 Self::Conflict(format!("queue entry already claimed by {agent}"))
             }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/error_conversion.rs:201:
     fn from(err: BuilderError) -> Self {
         match &err {
             BuilderError::MissingRequired { field: _ }
[31m-            | BuilderError::InvalidValue { field: _, reason: _ }
(B[m[31m-            | BuilderError::Overflow { field: _, capacity: _ }
(B[m[31m-            | BuilderError::InvalidTransition { from: _, to: _, reason: _ } => Self::CannotActivate,
(B[m[32m+            | BuilderError::InvalidValue {
(B[m[32m+                field: _,
(B[m[32m+                reason: _,
(B[m[32m+            }
(B[m[32m+            | BuilderError::Overflow {
(B[m[32m+                field: _,
(B[m[32m+                capacity: _,
(B[m[32m+            }
(B[m[32m+            | BuilderError::InvalidTransition {
(B[m[32m+                from: _,
(B[m[32m+                to: _,
(B[m[32m+                reason: _,
(B[m[32m+            } => Self::CannotActivate,
(B[m         }
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/error_conversion.rs:258:
                 Self::InvalidInput(format!("field {field} exceeds capacity of {capacity}"))
             }
             BuilderError::InvalidTransition { from, to, reason } => {
[31m-                Self::InvalidInput(format!(
(B[m[31m-                    "invalid transition from {from} to {to}: {reason}",
(B[m[31m-                ))
(B[m[32m+                Self::InvalidInput(format!("invalid transition from {from} to {to}: {reason}",))
(B[m             }
         }
     }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/error_conversion.rs:295:
                 "workspace not found at {} during {operation} of {entity}",
                 path.display(),
             )),
[31m-            other => RepositoryError::InvalidInput(format!(
(B[m[31m-                "failed to {operation} {entity}: {other}",
(B[m[31m-            )),
(B[m[32m+            other => {
(B[m[32m+                RepositoryError::InvalidInput(format!("failed to {operation} {entity}: {other}",))
(B[m[32m+            }
(B[m         }
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/error_conversion.rs:312:
                 "path not found at {} during {operation} of {entity}",
                 path.display(),
             )),
[31m-            Self::Removed => RepositoryError::NotFound(format!(
(B[m[31m-                "{entity} has been removed during {operation}",
(B[m[31m-            )),
(B[m[31m-            other => RepositoryError::InvalidInput(format!(
(B[m[31m-                "failed to {operation} {entity}: {other}",
(B[m[31m-            )),
(B[m[32m+            Self::Removed => {
(B[m[32m+                RepositoryError::NotFound(format!("{entity} has been removed during {operation}",))
(B[m[32m+            }
(B[m[32m+            other => {
(B[m[32m+                RepositoryError::InvalidInput(format!("failed to {operation} {entity}: {other}",))
(B[m[32m+            }
(B[m         }
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/error_conversion.rs:337:
             Self::NotOwner { actual, expected } => RepositoryError::Conflict(format!(
                 "{entity} claimed by {actual}, not {expected} during {operation}",
             )),
[31m-            other => RepositoryError::InvalidInput(format!(
(B[m[31m-                "failed to {operation} {entity}: {other}",
(B[m[31m-            )),
(B[m[32m+            other => {
(B[m[32m+                RepositoryError::InvalidInput(format!("failed to {operation} {entity}: {other}",))
(B[m[32m+            }
(B[m         }
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/error_conversion.rs:436:
         let session_err: SessionError = err.into();
         assert!(matches!(session_err, SessionError::CannotActivate));
 
[31m-        let err = IdentifierError::TooLong { max: 63, actual: 100 };
(B[m[32m+        let err = IdentifierError::TooLong {
(B[m[32m+            max: 63,
(B[m[32m+            actual: 100,
(B[m[32m+        };
(B[m         let session_err: SessionError = err.into();
         assert!(matches!(session_err, SessionError::CannotActivate));
     }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/error_conversion.rs:472:
 
         let err = IdentifierError::ContainsPathSeparators;
         let workspace_err = err.to_workspace_error();
[31m-        assert!(matches!(
(B[m[31m-            workspace_err,
(B[m[31m-            WorkspaceError::CannotUse(_)
(B[m[31m-        ));
(B[m[32m+        assert!(matches!(workspace_err, WorkspaceError::CannotUse(_)));
(B[m     }
 
     // ===== AggregateError to RepositoryError conversions =====
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/error_conversion.rs:482:
 
     #[test]
     fn test_session_error_to_repository_error() {
[31m-        let err = SessionError::NameAlreadyExists(
(B[m[31m-            SessionName::parse("test").expect("valid name"),
(B[m[31m-        );
(B[m[32m+        let err = SessionError::NameAlreadyExists(SessionName::parse("test").expect("valid name"));
(B[m         let repo_err: RepositoryError = err.into();
         assert!(matches!(repo_err, RepositoryError::Conflict(_)));
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/error_conversion.rs:503:
         let repo_err: RepositoryError = err.into();
         assert!(matches!(repo_err, RepositoryError::NotFound(_)));
 
[31m-        let err = WorkspaceError::NameAlreadyExists(
(B[m[31m-            WorkspaceName::parse("test").expect("valid name"),
(B[m[31m-        );
(B[m[32m+        let err =
(B[m[32m+            WorkspaceError::NameAlreadyExists(WorkspaceName::parse("test").expect("valid name"));
(B[m         let repo_err: RepositoryError = err.into();
         assert!(matches!(repo_err, RepositoryError::Conflict(_)));
     }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/error_conversion.rs:537:
 
     #[test]
     fn test_into_repository_error_with_context() {
[31m-        let err = SessionError::NameAlreadyExists(
(B[m[31m-            SessionName::parse("test").expect("valid name"),
(B[m[31m-        );
(B[m[32m+        let err = SessionError::NameAlreadyExists(SessionName::parse("test").expect("valid name"));
(B[m         let repo_err = err.in_context("session", "create");
         assert!(matches!(repo_err, RepositoryError::Conflict(_)));
         assert!(repo_err.to_string().contains("session"));
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/events.rs:50:
 impl ClaimTimestamps {
     /// Create new claim timestamps.
     #[must_use]
[31m-    pub const fn new(claimed_at: DateTime<Utc>, expires_at: DateTime<Utc>, timestamp: DateTime<Utc>) -> Self {
(B[m[32m+    pub const fn new(
(B[m[32m+        claimed_at: DateTime<Utc>,
(B[m[32m+        expires_at: DateTime<Utc>,
(B[m[32m+        timestamp: DateTime<Utc>,
(B[m[32m+    ) -> Self {
(B[m         Self {
             claimed_at,
             expires_at,
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/identifiers.rs:307:
         .chars()
         .all(|c| c.is_ascii_alphanumeric() || c == '-' || c == '_')
     {
[31m-        return Err(IdentifierError::invalid_characters(
(B[m[31m-            format!("session name '{s}' must contain only letters, numbers, hyphens, or underscores"),
(B[m[31m-        ));
(B[m[32m+        return Err(IdentifierError::invalid_characters(format!(
(B[m[32m+            "session name '{s}' must contain only letters, numbers, hyphens, or underscores"
(B[m[32m+        )));
(B[m     }
 
     Ok(())
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/identifiers.rs:402:
     }
 
     if !s.is_ascii() {
[31m-        return Err(IdentifierError::NotAscii { value: s.to_string() });
(B[m[32m+        return Err(IdentifierError::NotAscii {
(B[m[32m+            value: s.to_string(),
(B[m[32m+        });
(B[m     }
 
     Ok(())
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/identifiers.rs:484:
     /// Get the session name as a string slice
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/identifiers.rs:572:
     /// Get the agent ID as a string slice
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/identifiers.rs:651:
     /// Get the workspace name as a string slice
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/identifiers.rs:724:
     /// Get the task ID as a string slice
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/identifiers.rs:802:
     /// Get the session ID as a string slice
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/identifiers.rs:875:
     /// Get the path as a string slice
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/identifiers.rs:998:
     type Err = IdentifierError;
 
     fn from_str(s: &str) -> Result<Self, Self::Err> {
[31m-        let value = s.parse::<i64>().map_err(|_| IdentifierError::InvalidFormat {
(B[m[31m-            details: format!("cannot parse queue entry ID from '{s}'"),
(B[m[31m-        })?;
(B[m[32m+        let value = s
(B[m[32m+            .parse::<i64>()
(B[m[32m+            .map_err(|_| IdentifierError::InvalidFormat {
(B[m[32m+                details: format!("cannot parse queue entry ID from '{s}'"),
(B[m[32m+            })?;
(B[m         Self::new(value)
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/identifiers.rs:1068:
         let long_name = "a".repeat(64);
         let result = SessionName::parse(&long_name);
         assert!(result.is_err());
[31m-        assert!(matches!(result, Err(IdentifierError::TooLong { max: 63, .. })));
(B[m[32m+        assert!(matches!(
(B[m[32m+            result,
(B[m[32m+            Err(IdentifierError::TooLong { max: 63, .. })
(B[m[32m+        ));
(B[m     }
 
     #[test]
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/identifiers.rs:1255:
     }
 }
 
[31m-    // ===== SessionId Tests =====
(B[m[32m+// ===== SessionId Tests =====
(B[m 
[31m-    #[test]
(B[m[31m-    fn test_valid_session_id() {
(B[m[31m-        assert!(SessionId::parse("session-abc123").is_ok());
(B[m[31m-        assert!(SessionId::parse("sess-123").is_ok());
(B[m[31m-        assert!(SessionId::parse("SESSION_ABC").is_ok());
(B[m[31m-    }
(B[m[32m+#[test]
(B[m[32m+fn test_valid_session_id() {
(B[m[32m+    assert!(SessionId::parse("session-abc123").is_ok());
(B[m[32m+    assert!(SessionId::parse("sess-123").is_ok());
(B[m[32m+    assert!(SessionId::parse("SESSION_ABC").is_ok());
(B[m[32m+}
(B[m 
[31m-    #[test]
(B[m[31m-    fn test_invalid_session_id_empty() {
(B[m[31m-        let result = SessionId::parse("");
(B[m[31m-        assert!(result.is_err());
(B[m[31m-        assert!(matches!(result, Err(IdentifierError::Empty)));
(B[m[31m-    }
(B[m[32m+#[test]
(B[m[32m+fn test_invalid_session_id_empty() {
(B[m[32m+    let result = SessionId::parse("");
(B[m[32m+    assert!(result.is_err());
(B[m[32m+    assert!(matches!(result, Err(IdentifierError::Empty)));
(B[m[32m+}
(B[m 
[31m-    #[test]
(B[m[31m-    fn test_invalid_session_id_non_ascii() {
(B[m[31m-        let result = SessionId::parse("session-abc-日本語");
(B[m[31m-        assert!(result.is_err());
(B[m[31m-    }
(B[m[32m+#[test]
(B[m[32m+fn test_invalid_session_id_non_ascii() {
(B[m[32m+    let result = SessionId::parse("session-abc-日本語");
(B[m[32m+    assert!(result.is_err());
(B[m[32m+}
(B[m 
[31m-    #[test]
(B[m[31m-    fn test_session_id_display() {
(B[m[31m-        match SessionId::parse("session-abc123") {
(B[m[31m-            Ok(id) => {
(B[m[31m-                assert_eq!(id.to_string(), "session-abc123");
(B[m[31m-                assert_eq!(id.as_str(), "session-abc123");
(B[m[31m-            }
(B[m[31m-            Err(e) => panic!("Failed to parse valid session ID: {e}"),
(B[m[32m+#[test]
(B[m[32m+fn test_session_id_display() {
(B[m[32m+    match SessionId::parse("session-abc123") {
(B[m[32m+        Ok(id) => {
(B[m[32m+            assert_eq!(id.to_string(), "session-abc123");
(B[m[32m+            assert_eq!(id.as_str(), "session-abc123");
(B[m         }
[32m+        Err(e) => panic!("Failed to parse valid session ID: {e}"),
(B[m     }
[32m+}
(B[m 
[31m-    // ===== AbsolutePath Tests =====
(B[m[32m+// ===== AbsolutePath Tests =====
(B[m 
[31m-    #[test]
(B[m[31m-    fn test_valid_absolute_path() {
(B[m[31m-        assert!(AbsolutePath::parse("/home/user").is_ok());
(B[m[31m-        assert!(AbsolutePath::parse("/tmp/workspace").is_ok());
(B[m[31m-        assert!(AbsolutePath::parse("/").is_ok());
(B[m[31m-    }
(B[m[32m+#[test]
(B[m[32m+fn test_valid_absolute_path() {
(B[m[32m+    assert!(AbsolutePath::parse("/home/user").is_ok());
(B[m[32m+    assert!(AbsolutePath::parse("/tmp/workspace").is_ok());
(B[m[32m+    assert!(AbsolutePath::parse("/").is_ok());
(B[m[32m+}
(B[m 
[31m-    #[test]
(B[m[31m-    fn test_invalid_absolute_path_empty() {
(B[m[31m-        let result = AbsolutePath::parse("");
(B[m[31m-        assert!(result.is_err());
(B[m[31m-    }
(B[m[32m+#[test]
(B[m[32m+fn test_invalid_absolute_path_empty() {
(B[m[32m+    let result = AbsolutePath::parse("");
(B[m[32m+    assert!(result.is_err());
(B[m[32m+}
(B[m 
[31m-    #[test]
(B[m[31m-    fn test_invalid_absolute_path_relative() {
(B[m[31m-        let result = AbsolutePath::parse("relative/path");
(B[m[31m-        assert!(result.is_err());
(B[m[31m-        assert!(matches!(result, Err(IdentifierError::NotAbsolutePath { .. })));
(B[m[31m-    }
(B[m[32m+#[test]
(B[m[32m+fn test_invalid_absolute_path_relative() {
(B[m[32m+    let result = AbsolutePath::parse("relative/path");
(B[m[32m+    assert!(result.is_err());
(B[m[32m+    assert!(matches!(
(B[m[32m+        result,
(B[m[32m+        Err(IdentifierError::NotAbsolutePath { .. })
(B[m[32m+    ));
(B[m[32m+}
(B[m 
[31m-    #[test]
(B[m[31m-    fn test_invalid_absolute_path_null_bytes() {
(B[m[31m-        let result = AbsolutePath::parse("/path\0with\0nulls");
(B[m[31m-        assert!(result.is_err());
(B[m[31m-        assert!(matches!(result, Err(IdentifierError::NullBytesInPath)));
(B[m[31m-    }
(B[m[32m+#[test]
(B[m[32m+fn test_invalid_absolute_path_null_bytes() {
(B[m[32m+    let result = AbsolutePath::parse("/path\0with\0nulls");
(B[m[32m+    assert!(result.is_err());
(B[m[32m+    assert!(matches!(result, Err(IdentifierError::NullBytesInPath)));
(B[m[32m+}
(B[m 
[31m-    #[test]
(B[m[31m-    fn test_absolute_path_display() {
(B[m[31m-        match AbsolutePath::parse("/home/user/workspace") {
(B[m[31m-            Ok(path) => {
(B[m[31m-                assert_eq!(path.to_string(), "/home/user/workspace");
(B[m[31m-                assert_eq!(path.as_str(), "/home/user/workspace");
(B[m[31m-            }
(B[m[31m-            Err(e) => panic!("Failed to parse valid absolute path: {e}"),
(B[m[32m+#[test]
(B[m[32m+fn test_absolute_path_display() {
(B[m[32m+    match AbsolutePath::parse("/home/user/workspace") {
(B[m[32m+        Ok(path) => {
(B[m[32m+            assert_eq!(path.to_string(), "/home/user/workspace");
(B[m[32m+            assert_eq!(path.as_str(), "/home/user/workspace");
(B[m         }
[32m+        Err(e) => panic!("Failed to parse valid absolute path: {e}"),
(B[m     }
[32m+}
(B[m 
[31m-    #[test]
(B[m[31m-    fn test_absolute_path_to_path_buf() {
(B[m[31m-        match AbsolutePath::parse("/home/user/workspace") {
(B[m[31m-            Ok(path) => {
(B[m[31m-                let path_buf = path.to_path_buf();
(B[m[31m-                assert_eq!(path_buf, std::path::PathBuf::from("/home/user/workspace"));
(B[m[31m-            }
(B[m[31m-            Err(e) => panic!("Failed to parse valid absolute path: {e}"),
(B[m[32m+#[test]
(B[m[32m+fn test_absolute_path_to_path_buf() {
(B[m[32m+    match AbsolutePath::parse("/home/user/workspace") {
(B[m[32m+        Ok(path) => {
(B[m[32m+            let path_buf = path.to_path_buf();
(B[m[32m+            assert_eq!(path_buf, std::path::PathBuf::from("/home/user/workspace"));
(B[m         }
[32m+        Err(e) => panic!("Failed to parse valid absolute path: {e}"),
(B[m     }
[32m+}
(B[m 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/macros_examples.rs:30:
 impl std::fmt::Display for ValidationError {
     fn fmt(&self, f: &mut std::fmt::Formatter<'_>) -> std::fmt::Result {
         match self {
[31m-            ValidationError::TimestampOrdering { created_at, updated_at } => {
(B[m[32m+            ValidationError::TimestampOrdering {
(B[m[32m+                created_at,
(B[m[32m+                updated_at,
(B[m[32m+            } => {
(B[m                 write!(
                     f,
                     "Timestamp ordering violated: updated_at ({updated_at}) < created_at ({created_at})"
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/macros_examples.rs:110:
     );
 
     // Check state is not empty
[31m-    crate::invariant!(
(B[m[31m-        !state.is_empty(),
(B[m[31m-        ValidationError::EmptyState
(B[m[31m-    );
(B[m[32m+    crate::invariant!(!state.is_empty(), ValidationError::EmptyState);
(B[m 
     // Check timestamp ordering
     crate::invariant!(
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/macros_examples.rs:141:
     fn test_empty_title() {
         let now = Utc::now();
         let result = validate_bead_state("", "open", now, now);
[31m-        assert!(matches!(
(B[m[31m-            result,
(B[m[31m-            Err(ValidationError::InvariantViolated(_))
(B[m[31m-        ));
(B[m[32m+        assert!(matches!(result, Err(ValidationError::InvariantViolated(_))));
(B[m     }
 
     #[test]
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/macros_examples.rs:312:
     fn test_non_integer_division() {
         let result = validate_division(10, 3);
         assert!(result.is_err());
[31m-        assert!(result.unwrap_err().to_string().contains("non-integer result"));
(B[m[32m+        assert!(result
(B[m[32m+            .unwrap_err()
(B[m[32m+            .to_string()
(B[m[32m+            .contains("non-integer result"));
(B[m     }
 }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/mod.rs:26:
 pub mod workspace;
 
 pub use aggregates::{
[31m-    Bead, BeadError, BeadState, QueueEntry, QueueEntryError, Session, SessionBuilder,
(B[m[31m-    SessionError, Workspace, WorkspaceBuilder, WorkspaceError,
(B[m[32m+    Bead, BeadError, BeadState, QueueEntry, QueueEntryError, Session, SessionBuilder, SessionError,
(B[m[32m+    Workspace, WorkspaceBuilder, WorkspaceError,
(B[m };
[31m-pub use workspace::WorkspaceState;
(B[m pub use events::{
     DomainEvent, EventMetadata, SessionCompletedEvent, SessionCreatedEvent, SessionFailedEvent,
     StoredEvent,
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/mod.rs:36:
 };
 pub use identifiers::{
[31m-    AbsolutePath, AbsolutePathError, AgentId, AgentIdError, BeadId, BeadIdError, IdentifierError,
(B[m[31m-    IdError, QueueEntryId, QueueEntryIdError, SessionId, SessionIdError, SessionName,
(B[m[32m+    AbsolutePath, AbsolutePathError, AgentId, AgentIdError, BeadId, BeadIdError, IdError,
(B[m[32m+    IdentifierError, QueueEntryId, QueueEntryIdError, SessionId, SessionIdError, SessionName,
(B[m     SessionNameError, TaskId, TaskIdError, WorkspaceName, WorkspaceNameError,
 };
[32m+pub use workspace::WorkspaceState;
(B[m 
 // Re-export repository traits for convenience
 pub use repository::{
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/mod.rs:47:
 };
 
 // Re-export error conversion traits for ergonomic error handling
[31m-pub use error_conversion::{
(B[m[31m-    AggregateErrorExt, IdentifierErrorExt, IntoRepositoryError,
(B[m[31m-};
(B[m[32m+pub use error_conversion::{AggregateErrorExt, IdentifierErrorExt, IntoRepositoryError};
(B[m 
 // Include examples module for documentation and testing
 #[cfg(test)]
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/repository.rs:640:
     ///
     /// Returns `StorageError` on read failure.
     fn list_unclaimed(&self) -> RepositoryResult<Vec<QueueEntry>> {
[31m-        let mut entries = self.list_all()?
(B[m[32m+        let mut entries = self
(B[m[32m+            .list_all()?
(B[m             .into_iter()
             .filter(|e| e.claim_state.is_unclaimed())
             .collect::<Vec<_>>();
Diff in /home/lewis/src/zjj/crates/zjj-core/src/domain/workspace.rs:30:
     /// All valid workspace states
     #[must_use]
     pub const fn all() -> [Self; 5] {
[31m-        [Self::Creating, Self::Ready, Self::Active, Self::Cleaning, Self::Removed]
(B[m[32m+        [
(B[m[32m+            Self::Creating,
(B[m[32m+            Self::Ready,
(B[m[32m+            Self::Active,
(B[m[32m+            Self::Cleaning,
(B[m[32m+            Self::Removed,
(B[m[32m+        ]
(B[m     }
 
     #[must_use]
Diff in /home/lewis/src/zjj/crates/zjj-core/src/hints.rs:806:
 
     use super::*;
     use crate::{
[31m-        domain::{AbsolutePath, SessionId},
(B[m         domain::session::{BranchState, ParentState},
[32m+        domain::{AbsolutePath, SessionId},
(B[m         output::ValidatedMetadata,
         types::SessionName,
         WorkspaceState,
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/domain_types.rs:17:
 use serde::{Deserialize, Serialize};
 
 // Re-export from domain (single source of truth)
[31m-pub use crate::domain::{SessionName, BeadId, QueueEntryId};
(B[m[32m+pub use crate::domain::{BeadId, QueueEntryId, SessionName};
(B[m 
 use super::OutputLineError;
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/domain_types.rs:49:
     /// Get the issue ID as a string slice
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/domain_types.rs:90:
     /// Get the train ID as a string slice
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/domain_types.rs:107:
     }
 }
 
[31m-
(B[m // ═══════════════════════════════════════════════════════════════════════════
 // TEXT NEWTYPES - Validate once, use everywhere
 // ═══════════════════════════════════════════════════════════════════════════
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/domain_types.rs:136:
     /// Get the issue title as a string slice
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/domain_types.rs:177:
     /// Get the plan title as a string slice
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/domain_types.rs:218:
     /// Get the plan description as a string slice
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/domain_types.rs:259:
     /// Get the message as a string slice
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/domain_types.rs:333:
                 }
 
                 // Must start with a letter
[31m-                if !custom.chars().next().is_some_and(|c| c.is_ascii_alphabetic()) {
(B[m[31m-                    return Err(OutputLineError::InvalidWarningCode(
(B[m[31m-                        format!("warning code must start with a letter, got: {custom}"),
(B[m[31m-                    ));
(B[m[32m+                if !custom
(B[m[32m+                    .chars()
(B[m[32m+                    .next()
(B[m[32m+                    .is_some_and(|c| c.is_ascii_alphabetic())
(B[m[32m+                {
(B[m[32m+                    return Err(OutputLineError::InvalidWarningCode(format!(
(B[m[32m+                        "warning code must start with a letter, got: {custom}"
(B[m[32m+                    )));
(B[m                 }
 
                 // All characters must be alphanumeric or underscore
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/domain_types.rs:344:
                     .chars()
                     .all(|c| c.is_ascii_alphanumeric() || c == '_')
                 {
[31m-                    return Err(OutputLineError::InvalidWarningCode(
(B[m[31m-                        format!("warning code must be alphanumeric or underscore, got: {custom}"),
(B[m[31m-                    ));
(B[m[32m+                    return Err(OutputLineError::InvalidWarningCode(format!(
(B[m[32m+                        "warning code must be alphanumeric or underscore, got: {custom}"
(B[m[32m+                    )));
(B[m                 }
 
                 Ok(Self::Custom(custom.to_string()))
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/domain_types.rs:475:
                 // Must be lowercase alphanumeric with hyphens
                 let lower = custom.to_lowercase();
                 if lower != custom {
[31m-                    return Err(OutputLineError::InvalidActionVerb(
(B[m[31m-                        format!("action verb must be lowercase, got: {custom}"),
(B[m[31m-                    ));
(B[m[32m+                    return Err(OutputLineError::InvalidActionVerb(format!(
(B[m[32m+                        "action verb must be lowercase, got: {custom}"
(B[m[32m+                    )));
(B[m                 }
 
                 if !lower
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/domain_types.rs:484:
                     .chars()
                     .all(|c| c.is_ascii_lowercase() || c.is_ascii_digit() || c == '-')
                 {
[31m-                    return Err(OutputLineError::InvalidActionVerb(
(B[m[31m-                        format!(
(B[m[31m-                            "action verb must be lowercase alphanumeric with hyphens, got: {custom}"
(B[m[31m-                        ),
(B[m[31m-                    ));
(B[m[32m+                    return Err(OutputLineError::InvalidActionVerb(format!(
(B[m[32m+                        "action verb must be lowercase alphanumeric with hyphens, got: {custom}"
(B[m[32m+                    )));
(B[m                 }
 
                 // Must start with a letter
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/domain_types.rs:495:
                 if !lower.chars().next().is_some_and(|c| c.is_ascii_lowercase()) {
[31m-                    return Err(OutputLineError::InvalidActionVerb(
(B[m[31m-                        format!("action verb must start with a lowercase letter, got: {custom}"),
(B[m[31m-                    ));
(B[m[32m+                    return Err(OutputLineError::InvalidActionVerb(format!(
(B[m[32m+                        "action verb must start with a lowercase letter, got: {custom}"
(B[m[32m+                    )));
(B[m                 }
 
                 Ok(Self::Custom(lower))
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/domain_types.rs:586:
     /// Get the action target as a string slice
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/domain_types.rs:619:
     /// Get the base reference as a string slice
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/domain_types.rs:652:
     /// Get the command as a string slice
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/domain_types.rs:719:
     /// Convert from boolean (for backward compatibility during migration)
     #[must_use]
     pub const fn from_bool(success: bool) -> Self {
[31m-        if success { Self::Success } else { Self::Failure }
(B[m[32m+        if success {
(B[m[32m+            Self::Success
(B[m[32m+        } else {
(B[m[32m+            Self::Failure
(B[m[32m+        }
(B[m     }
 
     /// Convert to boolean (for backward compatibility during migration)
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/mod.rs:23:
 mod writer;
 
 pub use domain_types::{
[31m-    ActionTarget, ActionResult, ActionVerb, AgentAssignment, BaseRef, BeadAttachment, BeadId, Command,
(B[m[31m-    ExecutionMode, IssueId, IssueScope, IssueTitle, Message, Outcome, PlanDescription, PlanTitle,
(B[m[31m-    QueueEntryId, RecoveryCapability, RecoveryExecution, TrainId, ValidatedMetadata, WarningCode,
(B[m[32m+    ActionResult, ActionTarget, ActionVerb, AgentAssignment, BaseRef, BeadAttachment, BeadId,
(B[m[32m+    Command, ExecutionMode, IssueId, IssueScope, IssueTitle, Message, Outcome, PlanDescription,
(B[m[32m+    PlanTitle, QueueEntryId, RecoveryCapability, RecoveryExecution, TrainId, ValidatedMetadata,
(B[m[32m+    WarningCode,
(B[m };
 pub use test_utils::{OutputEmitter, StdoutEmitter, VecEmitter};
 pub use types::{
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/tests.rs:2:
 
 use std::path::PathBuf;
 
[31m-use super::*;
(B[m use super::domain_types::*;
[32m+use super::*;
(B[m use crate::{types::SessionStatus, WorkspaceState};
 
 // Import domain SessionName for use in tests
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/tests.rs:19:
 
 #[test]
 fn test_summary_new_accepts_valid_message() {
[31m-    let result = Summary::new(SummaryType::Info, Message::new("test message").expect("valid"));
(B[m[32m+    let result = Summary::new(
(B[m[32m+        SummaryType::Info,
(B[m[32m+        Message::new("test message").expect("valid"),
(B[m[32m+    );
(B[m     assert!(result.is_ok());
 }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/tests.rs:264:
 
 #[test]
 fn test_output_line_kind() {
[31m-    let summary =
(B[m[31m-        OutputLine::Summary(Summary::new(SummaryType::Info, Message::new("test").expect("valid")).expect("valid"));
(B[m[32m+    let summary = OutputLine::Summary(
(B[m[32m+        Summary::new(SummaryType::Info, Message::new("test").expect("valid")).expect("valid"),
(B[m[32m+    );
(B[m     assert_eq!(summary.kind(), "summary");
 
     let issue = OutputLine::Issue(
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/tests.rs:331:
         DomainSessionName::parse("session-1").expect("valid"),
         PathBuf::from("/ws/1"),
         StackEntryStatus::Ready,
[31m-        BeadAttachment::Attached { bead_id: BeadId::parse("bd-123").expect("valid") },
(B[m[32m+        BeadAttachment::Attached {
(B[m[32m+            bead_id: BeadId::parse("bd-123").expect("valid"),
(B[m[32m+        },
(B[m     )
     .expect("stack entry");
     assert_eq!(stack.entries.len(), 1);
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/tests.rs:482:
     let mut cursor = Cursor::new(Vec::new());
     let mut writer = JsonlWriter::new(&mut cursor);
 
[31m-    let summary = Summary::new(SummaryType::Info, Message::new("test").expect("valid")).expect("valid");
(B[m[32m+    let summary =
(B[m[32m+        Summary::new(SummaryType::Info, Message::new("test").expect("valid")).expect("valid");
(B[m     writer.emit(&OutputLine::Summary(summary)).expect("emit");
 
     let output = String::from_utf8(cursor.into_inner()).expect("utf8");
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/tests.rs:537:
     let config = JsonlConfig::new().with_flush_on_emit(false);
     let mut writer = JsonlWriter::with_config(&mut cursor, config);
 
[31m-    let summary = Summary::new(SummaryType::Info, Message::new("test").expect("valid")).expect("valid");
(B[m[32m+    let summary =
(B[m[32m+        Summary::new(SummaryType::Info, Message::new("test").expect("valid")).expect("valid");
(B[m     writer.emit(&OutputLine::Summary(summary)).expect("emit");
 
     let output = String::from_utf8(cursor.into_inner()).expect("utf8");
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/tests.rs:549:
     use std::io::Cursor;
 
     let mut cursor = Cursor::new(Vec::new());
[31m-    let summary = Summary::new(SummaryType::Info, Message::new("test").expect("valid")).expect("valid");
(B[m[32m+    let summary =
(B[m[32m+        Summary::new(SummaryType::Info, Message::new("test").expect("valid")).expect("valid");
(B[m 
     emit(&mut cursor, &OutputLine::Summary(summary)).expect("emit");
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/tests.rs:559:
 
 #[test]
 fn test_summary_round_trip_serialization() {
[31m-    let original = Summary::new(SummaryType::Status, Message::new("test message").expect("valid"))
(B[m[31m-        .expect("valid")
(B[m[31m-        .with_details("extra info".to_string());
(B[m[32m+    let original = Summary::new(
(B[m[32m+        SummaryType::Status,
(B[m[32m+        Message::new("test message").expect("valid"),
(B[m[32m+    )
(B[m[32m+    .expect("valid")
(B[m[32m+    .with_details("extra info".to_string());
(B[m 
     let json = serde_json::to_string(&original).expect("serialize");
     let deserialized: Summary = serde_json::from_str(&json).expect("deserialize");
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/tests.rs:623:
         DomainSessionName::parse("session-1").expect("valid"),
         PathBuf::from("/ws/1"),
         StackEntryStatus::Ready,
[31m-        BeadAttachment::Attached { bead_id: BeadId::parse("bd-123").expect("valid") },
(B[m[32m+        BeadAttachment::Attached {
(B[m[32m+            bead_id: BeadId::parse("bd-123").expect("valid"),
(B[m[32m+        },
(B[m     )
     .expect("first stack entry")
     .with_entry(
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/tests.rs:730:
             ActionStatus::Completed,
         )),
         OutputLine::Warning(
[31m-            Warning::new(WarningCode::new("W001").expect("valid warning code"), Message::new("msg").expect("valid")).expect("valid"),
(B[m[32m+            Warning::new(
(B[m[32m+                WarningCode::new("W001").expect("valid warning code"),
(B[m[32m+                Message::new("msg").expect("valid"),
(B[m[32m+            )
(B[m[32m+            .expect("valid"),
(B[m         ),
         OutputLine::Result(
             ResultOutput::success(ResultKind::Command, Message::new("ok").expect("valid"))
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/types.rs:28:
 // Import domain types for semantic validation
 use super::domain_types::{
     ActionResult, ActionTarget, ActionVerb, AgentAssignment, BaseRef, BeadAttachment, BeadId,
[31m-    IssueId, IssueScope, IssueTitle, Message, Outcome, PlanDescription,
(B[m[31m-    PlanTitle, QueueEntryId, RecoveryCapability, RecoveryExecution, TrainId, WarningCode,
(B[m[31m-    SessionName,
(B[m[32m+    IssueId, IssueScope, IssueTitle, Message, Outcome, PlanDescription, PlanTitle, QueueEntryId,
(B[m[32m+    RecoveryCapability, RecoveryExecution, SessionName, TrainId, WarningCode,
(B[m };
 
 #[derive(Debug, Clone, Error)]
Diff in /home/lewis/src/zjj/crates/zjj-core/src/output/types.rs:663:
     /// # Errors
     ///
     /// Returns `OutputLineError::EmptySessionName` if the name is empty.
[31m-    pub fn new(
(B[m[31m-        name: SessionName,
(B[m[31m-        base_ref: BaseRef,
(B[m[31m-    ) -> Result<Self, OutputLineError> {
(B[m[32m+    pub fn new(name: SessionName, base_ref: BaseRef) -> Result<Self, OutputLineError> {
(B[m         Ok(Self {
             name,
             base_ref,
Diff in /home/lewis/src/zjj/crates/zjj-core/src/templates/storage.rs:84:
     /// Get the name as a string slice
     #[must_use]
     pub fn as_str(&self) -> &str {
[31m-
(B[m         &self.0
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/types.rs:275:
     serializer.serialize_str(path.as_str())
 }
 
[31m-fn deserialize_absolute_path<'de, D>(
(B[m[31m-    deserializer: D,
(B[m[31m-) -> std::result::Result<AbsolutePath, D::Error>
(B[m[32m+fn deserialize_absolute_path<'de, D>(deserializer: D) -> std::result::Result<AbsolutePath, D::Error>
(B[m where
     D: Deserializer<'de>,
 {
Diff in /home/lewis/src/zjj/crates/zjj-core/src/validation/domain.rs:91:
     }
 
     // Rule 3: Must start with a letter
[31m-    if !trimmed.chars().next().is_some_and(|c| c.is_ascii_alphabetic()) {
(B[m[32m+    if !trimmed
(B[m[32m+        .chars()
(B[m[32m+        .next()
(B[m[32m+        .is_some_and(|c| c.is_ascii_alphabetic())
(B[m[32m+    {
(B[m         return Err(IdentifierError::invalid_start('a'));
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/src/validation/domain.rs:158:
     }
 
     // Rule 3: Valid characters only
[31m-    if !s.chars().all(|c| {
(B[m[31m-        c.is_ascii_alphanumeric()
(B[m[31m-            || matches!(c, '-' | '_' | '.' | ':')
(B[m[31m-    }) {
(B[m[32m+    if !s
(B[m[32m+        .chars()
(B[m[32m+        .all(|c| c.is_ascii_alphanumeric() || matches!(c, '-' | '_' | '.' | ':'))
(B[m[32m+    {
(B[m         return Err(IdentifierError::invalid_characters(
             "agent ID must contain only letters, numbers, hyphens, underscores, dots, or colons",
         ));
Diff in /home/lewis/src/zjj/crates/zjj-core/src/validation/infrastructure.rs:230:
     // Try to open with write access to check writability
     // Use a read-only open for directories to avoid accidental modification
     if path.is_dir() {
[31m-        match std::fs::OpenOptions::new()
(B[m[31m-            .write(true)
(B[m[31m-            .open(path)
(B[m[31m-        {
(B[m[32m+        match std::fs::OpenOptions::new().write(true).open(path) {
(B[m             Ok(_) => Ok(()),
             Err(_) => Err(Error::ValidationError {
                 message: format!("Directory '{}' is not writable", path.display()),
Diff in /home/lewis/src/zjj/crates/zjj-core/src/validation/infrastructure.rs:245:
     } else {
         // For files, check parent directory writability
         path.parent().map_or_else(
[31m-            || Err(Error::ValidationError {
(B[m[31m-                message: format!("Cannot check writability for path without parent: '{}'", path.display()),
(B[m[31m-                field: None,
(B[m[31m-                value: None,
(B[m[31m-                constraints: Vec::new(),
(B[m[31m-            }),
(B[m[32m+            || {
(B[m[32m+                Err(Error::ValidationError {
(B[m[32m+                    message: format!(
(B[m[32m+                        "Cannot check writability for path without parent: '{}'",
(B[m[32m+                        path.display()
(B[m[32m+                    ),
(B[m[32m+                    field: None,
(B[m[32m+                    value: None,
(B[m[32m+                    constraints: Vec::new(),
(B[m[32m+                })
(B[m[32m+            },
(B[m             validate_is_writable,
         )
     }
Diff in /home/lewis/src/zjj/crates/zjj-core/src/validation/infrastructure.rs:484:
 
     #[test]
     fn test_validate_path_exists_rejects_nonexistent() {
[31m-        let result = validate_path_exists(Path::new(
(B[m[31m-            "/nonexistent/path/that/should/not/exist",
(B[m[31m-        ));
(B[m[32m+        let result = validate_path_exists(Path::new("/nonexistent/path/that/should/not/exist"));
(B[m         assert!(result.is_err());
     }
 
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/cli_properties.rs:45:
 use zjj_core::{
     output::{
         domain_types::{IssueId, IssueTitle, Message},
[31m-        Issue, IssueKind, IssueSeverity, OutputLine, SessionOutput, Summary,
(B[m[31m-        SummaryType,
(B[m[32m+        Issue, IssueKind, IssueSeverity, OutputLine, SessionOutput, Summary, SummaryType,
(B[m     },
     types::SessionStatus,
     WorkspaceState,
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/cli_properties.rs:681:
 fn prop_output_line_kinds_unique() {
     let kinds = vec![
         OutputLine::Summary(
[31m-            Summary::new(SummaryType::Status, Message::new("test").expect("valid message"))
(B[m[31m-                .expect("valid summary"),
(B[m[32m+            Summary::new(
(B[m[32m+                SummaryType::Status,
(B[m[32m+                Message::new("test").expect("valid message"),
(B[m[32m+            )
(B[m[32m+            .expect("valid summary"),
(B[m         )
         .kind(),
         OutputLine::Session(
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_aggregate_invariants.rs:14:
     bead::BeadTimestamps, Bead, BeadError, BeadState, QueueEntry, QueueEntryError, Session,
     SessionError, Workspace, WorkspaceError,
 };
[31m-use zjj_core::domain::identifiers::{
(B[m[31m-    AgentId, BeadId, SessionId, SessionName, WorkspaceName,
(B[m[31m-};
(B[m[32m+use zjj_core::domain::identifiers::{AgentId, BeadId, SessionId, SessionName, WorkspaceName};
(B[m use zjj_core::domain::queue::ClaimState;
 use zjj_core::domain::session::{BranchState, ParentState};
 use zjj_core::domain::workspace::WorkspaceState;
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_aggregate_invariants.rs:143:
         std::path::PathBuf::from("/nonexistent/workspace/path"),
     );
 
[31m-    assert!(matches!(
(B[m[31m-        result,
(B[m[31m-        Err(SessionError::WorkspaceNotFound(_))
(B[m[31m-    ));
(B[m[32m+    assert!(matches!(result, Err(SessionError::WorkspaceNotFound(_))));
(B[m }
 
 #[test]
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_aggregate_invariants.rs:265:
     let name = WorkspaceName::parse("test-workspace").expect("valid name");
 
     // Non-existent path should fail
[31m-    let result = Workspace::create(
(B[m[31m-        name.clone(),
(B[m[31m-        std::path::PathBuf::from("/nonexistent/path"),
(B[m[31m-    );
(B[m[32m+    let result = Workspace::create(name.clone(), std::path::PathBuf::from("/nonexistent/path"));
(B[m 
     assert!(matches!(result, Err(WorkspaceError::PathNotFound(_))));
 
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_aggregate_invariants.rs:286:
 fn test_workspace_invariant_state_transitions() {
     let name = WorkspaceName::parse("test-workspace").expect("valid name");
 
[31m-    let workspace = Workspace::create(name, std::path::PathBuf::from("/tmp"))
(B[m[31m-        .expect("workspace created");
(B[m[32m+    let workspace =
(B[m[32m+        Workspace::create(name, std::path::PathBuf::from("/tmp")).expect("workspace created");
(B[m 
     // Creating -> Ready (valid)
     let ready = workspace.mark_ready().expect("transition valid");
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_aggregate_invariants.rs:311:
 fn test_workspace_invariant_cannot_skip_states() {
     let name = WorkspaceName::parse("test-workspace").expect("valid name");
 
[31m-    let workspace = Workspace::create(name, std::path::PathBuf::from("/tmp"))
(B[m[31m-        .expect("workspace created");
(B[m[32m+    let workspace =
(B[m[32m+        Workspace::create(name, std::path::PathBuf::from("/tmp")).expect("workspace created");
(B[m 
     // Creating -> Active (invalid, must go through Ready first)
     // Use the can_transition_to on the state directly to test this
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_aggregate_invariants.rs:323:
 fn test_workspace_invariant_removed_is_terminal() {
     let name = WorkspaceName::parse("test-workspace").expect("valid name");
 
[31m-    let workspace = Workspace::create(name, std::path::PathBuf::from("/tmp"))
(B[m[31m-        .expect("workspace created");
(B[m[32m+    let workspace =
(B[m[32m+        Workspace::create(name, std::path::PathBuf::from("/tmp")).expect("workspace created");
(B[m 
     let removed = workspace.mark_removed().expect("transition valid");
 
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_aggregate_invariants.rs:383:
 
     // Negative priority should fail
     let result = QueueEntry::new(1, workspace.clone(), None, -1);
[31m-    assert!(matches!(
(B[m[31m-        result,
(B[m[31m-        Err(QueueEntryError::NegativePriority)
(B[m[31m-    ));
(B[m[32m+    assert!(matches!(result, Err(QueueEntryError::NegativePriority)));
(B[m 
     // Zero priority should succeed
     let result = QueueEntry::new(2, workspace.clone(), None, 0);
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_aggregate_invariants.rs:409:
 
     // Second claim should fail
     let result = claimed.claim(AgentId::parse("agent-2").expect("valid agent"), 300);
[31m-    assert!(matches!(
(B[m[31m-        result,
(B[m[31m-        Err(QueueEntryError::AlreadyClaimed(_))
(B[m[31m-    ));
(B[m[32m+    assert!(matches!(result, Err(QueueEntryError::AlreadyClaimed(_))));
(B[m }
 
 #[test]
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_aggregate_invariants.rs:424:
 
     // Negative duration should fail
     let result = entry.claim(agent.clone(), -1);
[31m-    assert!(matches!(
(B[m[31m-        result,
(B[m[31m-        Err(QueueEntryError::InvalidExpiration)
(B[m[31m-    ));
(B[m[32m+    assert!(matches!(result, Err(QueueEntryError::InvalidExpiration)));
(B[m 
     // Zero duration should fail
     let result = entry.claim(AgentId::parse("agent-2").expect("valid agent"), 0);
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_aggregate_invariants.rs:434:
[31m-    assert!(matches!(
(B[m[31m-        result,
(B[m[31m-        Err(QueueEntryError::InvalidExpiration)
(B[m[31m-    ));
(B[m[32m+    assert!(matches!(result, Err(QueueEntryError::InvalidExpiration)));
(B[m 
     // Positive duration should succeed
[31m-    let entry2 = QueueEntry::new(2, WorkspaceName::parse("test-ws2").expect("valid name"), None, 0).expect("entry created");
(B[m[32m+    let entry2 = QueueEntry::new(
(B[m[32m+        2,
(B[m[32m+        WorkspaceName::parse("test-ws2").expect("valid name"),
(B[m[32m+        None,
(B[m[32m+        0,
(B[m[32m+    )
(B[m[32m+    .expect("entry created");
(B[m     let result = entry2.claim(AgentId::parse("agent-3").expect("valid agent"), 300);
     assert!(result.is_ok());
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_aggregate_invariants.rs:457:
     assert!(matches!(result, Err(QueueEntryError::NotOwner { .. })));
 
     // Owner can release (need to re-claim since we already tried to release)
[31m-    let entry2 = QueueEntry::new(2, WorkspaceName::parse("test-ws2").expect("valid name"), None, 0).expect("entry created");
(B[m[32m+    let entry2 = QueueEntry::new(
(B[m[32m+        2,
(B[m[32m+        WorkspaceName::parse("test-ws2").expect("valid name"),
(B[m[32m+        None,
(B[m[32m+        0,
(B[m[32m+    )
(B[m[32m+    .expect("entry created");
(B[m     let claimed2 = entry2.claim(agent1.clone(), 300).expect("claim valid");
     let result = claimed2.release(&agent1);
     assert!(result.is_ok());
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_aggregate_invariants.rs:478:
 
     // Cannot update when claimed
     let result = claimed.update_priority(10);
[31m-    assert!(matches!(
(B[m[31m-        result,
(B[m[31m-        Err(QueueEntryError::CannotModify(_))
(B[m[31m-    ));
(B[m[32m+    assert!(matches!(result, Err(QueueEntryError::CannotModify(_))));
(B[m }
 
 #[test]
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:32:
 
     // Test JSON serialization
     let json = serialize_event(&event).expect("serialization failed");
[31m-    let deserialized = serde_json::from_str::<DomainEvent>(&json)
(B[m[31m-        .expect("deserialization failed");
(B[m[32m+    let deserialized = serde_json::from_str::<DomainEvent>(&json).expect("deserialization failed");
(B[m 
     assert_eq!(event, deserialized);
     assert_eq!(event.event_type(), "session_created");
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:50:
 
     // Test JSON serialization
     let json = serialize_event(&event).expect("serialization failed");
[31m-    let deserialized = serde_json::from_str::<DomainEvent>(&json)
(B[m[31m-        .expect("deserialization failed");
(B[m[32m+    let deserialized = serde_json::from_str::<DomainEvent>(&json).expect("deserialization failed");
(B[m 
     assert_eq!(event, deserialized);
     assert_eq!(event.event_type(), "session_completed");
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:69:
 
     // Test JSON serialization
     let json = serialize_event(&event).expect("serialization failed");
[31m-    let deserialized = serde_json::from_str::<DomainEvent>(&json)
(B[m[31m-        .expect("deserialization failed");
(B[m[32m+    let deserialized = serde_json::from_str::<DomainEvent>(&json).expect("deserialization failed");
(B[m 
     assert_eq!(event, deserialized);
     assert_eq!(event.event_type(), "session_failed");
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:98:
 
     // Test JSON serialization
     let json = serialize_event(&event).expect("serialization failed");
[31m-    let deserialized = serde_json::from_str::<DomainEvent>(&json)
(B[m[31m-        .expect("deserialization failed");
(B[m[32m+    let deserialized = serde_json::from_str::<DomainEvent>(&json).expect("deserialization failed");
(B[m 
     assert_eq!(event, deserialized);
     assert_eq!(event.event_type(), "workspace_created");
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:116:
 
     // Test JSON serialization
     let json = serialize_event(&event).expect("serialization failed");
[31m-    let deserialized = serde_json::from_str::<DomainEvent>(&json)
(B[m[31m-        .expect("deserialization failed");
(B[m[32m+    let deserialized = serde_json::from_str::<DomainEvent>(&json).expect("deserialization failed");
(B[m 
     assert_eq!(event, deserialized);
     assert_eq!(event.event_type(), "workspace_removed");
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:140:
 
     // Test JSON serialization
     let json = serialize_event(&event).expect("serialization failed");
[31m-    let deserialized = serde_json::from_str::<DomainEvent>(&json)
(B[m[31m-        .expect("deserialization failed");
(B[m[32m+    let deserialized = serde_json::from_str::<DomainEvent>(&json).expect("deserialization failed");
(B[m 
     assert_eq!(event, deserialized);
     assert_eq!(event.event_type(), "queue_entry_added");
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:169:
 
     // Test JSON serialization
     let json = serialize_event(&event).expect("serialization failed");
[31m-    let deserialized = serde_json::from_str::<DomainEvent>(&json)
(B[m[31m-        .expect("deserialization failed");
(B[m[32m+    let deserialized = serde_json::from_str::<DomainEvent>(&json).expect("deserialization failed");
(B[m 
     assert_eq!(event, deserialized);
 
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:199:
 
     // Test JSON serialization
     let json = serialize_event(&event).expect("serialization failed");
[31m-    let deserialized = serde_json::from_str::<DomainEvent>(&json)
(B[m[31m-        .expect("deserialization failed");
(B[m[32m+    let deserialized = serde_json::from_str::<DomainEvent>(&json).expect("deserialization failed");
(B[m 
     assert_eq!(event, deserialized);
     assert_eq!(event.event_type(), "queue_entry_claimed");
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:226:
 
     // Test JSON serialization
     let json = serialize_event(&event).expect("serialization failed");
[31m-    let deserialized = serde_json::from_str::<DomainEvent>(&json)
(B[m[31m-        .expect("deserialization failed");
(B[m[32m+    let deserialized = serde_json::from_str::<DomainEvent>(&json).expect("deserialization failed");
(B[m 
     assert_eq!(event, deserialized);
     assert_eq!(event.event_type(), "queue_entry_completed");
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:249:
 
     // Test JSON serialization
     let json = serialize_event(&event).expect("serialization failed");
[31m-    let deserialized = serde_json::from_str::<DomainEvent>(&json)
(B[m[31m-        .expect("deserialization failed");
(B[m[32m+    let deserialized = serde_json::from_str::<DomainEvent>(&json).expect("deserialization failed");
(B[m 
     assert_eq!(event, deserialized);
     assert_eq!(event.event_type(), "bead_created");
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:258:
     // Verify bead details
     if let DomainEvent::BeadCreated(e) = &deserialized {
         assert_eq!(e.title, "Fix the critical bug");
[31m-        assert_eq!(e.description, Some("High priority issue affecting production".to_string()));
(B[m[32m+        assert_eq!(
(B[m[32m+            e.description,
(B[m[32m+            Some("High priority issue affecting production".to_string())
(B[m[32m+        );
(B[m     } else {
         panic!("Expected BeadCreated event");
     }
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:276:
 
     // Test JSON serialization
     let json = serialize_event(&event).expect("serialization failed");
[31m-    let deserialized = serde_json::from_str::<DomainEvent>(&json)
(B[m[31m-        .expect("deserialization failed");
(B[m[32m+    let deserialized = serde_json::from_str::<DomainEvent>(&json).expect("deserialization failed");
(B[m 
     assert_eq!(event, deserialized);
 
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:303:
 
     // Test JSON serialization
     let json = serialize_event(&event).expect("serialization failed");
[31m-    let deserialized = serde_json::from_str::<DomainEvent>(&json)
(B[m[31m-        .expect("deserialization failed");
(B[m[32m+    let deserialized = serde_json::from_str::<DomainEvent>(&json).expect("deserialization failed");
(B[m 
     assert_eq!(event, deserialized);
     assert_eq!(event.event_type(), "bead_closed");
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:339:
     for event in events {
         // Test bytes serialization
         let bytes = serialize_event_bytes(&event).expect("serialization failed");
[31m-        let deserialized = serde_json::from_slice::<DomainEvent>(&bytes)
(B[m[31m-            .expect("deserialization failed");
(B[m[32m+        let deserialized =
(B[m[32m+            serde_json::from_slice::<DomainEvent>(&bytes).expect("deserialization failed");
(B[m 
         assert_eq!(event, deserialized);
     }
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:370:
 
     // Test serialization of stored event
     let json = serde_json::to_string(&stored).expect("serialization failed");
[31m-    let deserialized: StoredEvent =
(B[m[31m-        serde_json::from_str(&json).expect("deserialization failed");
(B[m[32m+    let deserialized: StoredEvent = serde_json::from_str(&json).expect("deserialization failed");
(B[m 
     assert_eq!(stored.event_number(), deserialized.event_number());
     assert_eq!(stored.stream_id(), deserialized.stream_id());
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:551:
     for event in events {
         // Test JSON serialization
         let json = serialize_event(&event).expect("serialization failed");
[31m-        let deserialized = serde_json::from_str::<DomainEvent>(&json)
(B[m[31m-            .expect("deserialization failed");
(B[m[32m+        let deserialized =
(B[m[32m+            serde_json::from_str::<DomainEvent>(&json).expect("deserialization failed");
(B[m 
         assert_eq!(event, deserialized);
 
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:559:
         // Test bytes serialization
         let bytes = serialize_event_bytes(&event).expect("serialization failed");
[31m-        let deserialized_bytes = serde_json::from_slice::<DomainEvent>(&bytes)
(B[m[31m-            .expect("deserialization failed");
(B[m[32m+        let deserialized_bytes =
(B[m[32m+            serde_json::from_slice::<DomainEvent>(&bytes).expect("deserialization failed");
(B[m 
         assert_eq!(event, deserialized_bytes);
     }
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:625:
 
     // Serialize and deserialize
     let json = serialize_event(&event).expect("serialization failed");
[31m-    let deserialized = serde_json::from_str::<DomainEvent>(&json)
(B[m[31m-        .expect("deserialization failed");
(B[m[32m+    let deserialized = serde_json::from_str::<DomainEvent>(&json).expect("deserialization failed");
(B[m 
     if let DomainEvent::BeadClosed(e) = &deserialized {
         assert_eq!(e.closed_at, timestamp - chrono::Duration::seconds(10));
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:649:
 
     // Serialize and deserialize
     let json = serialize_event(&event).expect("serialization failed");
[31m-    let deserialized = serde_json::from_str::<DomainEvent>(&json)
(B[m[31m-        .expect("deserialization failed");
(B[m[32m+    let deserialized = serde_json::from_str::<DomainEvent>(&json).expect("deserialization failed");
(B[m 
     if let DomainEvent::SessionCreated(e) = &deserialized {
         assert_eq!(e.session_name, session_name);
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:672:
 
     // Serialize and deserialize
     let json = serialize_event(&event).expect("serialization failed");
[31m-    let deserialized = serde_json::from_str::<DomainEvent>(&json)
(B[m[31m-        .expect("deserialization failed");
(B[m[32m+    let deserialized = serde_json::from_str::<DomainEvent>(&json).expect("deserialization failed");
(B[m 
     if let DomainEvent::WorkspaceCreated(e) = &deserialized {
         assert_eq!(e.workspace_name, workspace_name);
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:698:
 
     // Serialize and deserialize
     let json = serialize_event(&event).expect("serialization failed");
[31m-    let deserialized = serde_json::from_str::<DomainEvent>(&json)
(B[m[31m-        .expect("deserialization failed");
(B[m[32m+    let deserialized = serde_json::from_str::<DomainEvent>(&json).expect("deserialization failed");
(B[m 
     if let DomainEvent::QueueEntryClaimed(e) = &deserialized {
         assert_eq!(e.agent, agent_id);
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:713:
     let timestamp = Utc::now();
     let bead_id = BeadId::parse("bd-abc123def456").expect("valid id");
 
[31m-    let event = DomainEvent::bead_created(
(B[m[31m-        bead_id.clone(),
(B[m[31m-        "Test".to_string(),
(B[m[31m-        None,
(B[m[31m-        timestamp,
(B[m[31m-    );
(B[m[32m+    let event = DomainEvent::bead_created(bead_id.clone(), "Test".to_string(), None, timestamp);
(B[m 
     // Serialize and deserialize
     let json = serialize_event(&event).expect("serialization failed");
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_event_serialization.rs:725:
[31m-    let deserialized = serde_json::from_str::<DomainEvent>(&json)
(B[m[31m-        .expect("deserialization failed");
(B[m[32m+    let deserialized = serde_json::from_str::<DomainEvent>(&json).expect("deserialization failed");
(B[m 
     if let DomainEvent::BeadCreated(e) = &deserialized {
         assert_eq!(e.bead_id, bead_id);
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_repository_mocks.rs:13:
 use std::path::PathBuf;
 use std::sync::Arc;
 
[31m-use zjj_core::domain::identifiers::{
(B[m[31m-    AgentId, BeadId, SessionId, SessionName, WorkspaceName,
(B[m[31m-};
(B[m[32m+use zjj_core::domain::identifiers::{AgentId, BeadId, SessionId, SessionName, WorkspaceName};
(B[m use zjj_core::domain::repository::{
     AgentRepository, BeadRepository, ClaimState, QueueEntry, QueueRepository, QueueStats,
     RepositoryError, RepositoryResult, SessionRepository, WorkspaceRepository,
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_repository_mocks.rs:55:
         })
     }
 
[31m-    fn save(
(B[m[31m-        &self,
(B[m[31m-        _session: &zjj_core::domain::repository::Session,
(B[m[31m-    ) -> RepositoryResult<()> {
(B[m[32m+    fn save(&self, _session: &zjj_core::domain::repository::Session) -> RepositoryResult<()> {
(B[m         // Mock save - no-op
         Ok(())
     }
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_repository_mocks.rs:73:
         Ok(Vec::new())
     }
 
[31m-    fn get_current(
(B[m[31m-        &self,
(B[m[31m-    ) -> RepositoryResult<Option<zjj_core::domain::repository::Session>> {
(B[m[32m+    fn get_current(&self) -> RepositoryResult<Option<zjj_core::domain::repository::Session>> {
(B[m         Ok(None)
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_repository_mocks.rs:107:
         })
     }
 
[31m-    fn save(
(B[m[31m-        &self,
(B[m[31m-        _workspace: &zjj_core::domain::repository::Workspace,
(B[m[31m-    ) -> RepositoryResult<()> {
(B[m[32m+    fn save(&self, _workspace: &zjj_core::domain::repository::Workspace) -> RepositoryResult<()> {
(B[m         Ok(())
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_repository_mocks.rs:144:
         })
     }
 
[31m-    fn save(
(B[m[31m-        &self,
(B[m[31m-        _bead: &zjj_core::domain::repository::Bead,
(B[m[31m-    ) -> RepositoryResult<()> {
(B[m[32m+    fn save(&self, _bead: &zjj_core::domain::repository::Bead) -> RepositoryResult<()> {
(B[m         Ok(())
     }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_repository_mocks.rs:248:
         })
     }
 
[31m-    fn save(
(B[m[31m-        &self,
(B[m[31m-        _agent: &zjj_core::domain::repository::Agent,
(B[m[31m-    ) -> RepositoryResult<()> {
(B[m[32m+    fn save(&self, _agent: &zjj_core::domain::repository::Agent) -> RepositoryResult<()> {
(B[m         Ok(())
     }
 
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_state_machine_transitions.rs:12:
 use zjj_core::domain::aggregates::{
     queue_entry::QueueEntryMetadata, Bead, QueueEntry, Session, Workspace,
 };
[31m-use zjj_core::domain::identifiers::{
(B[m[31m-    AgentId, BeadId, SessionId, SessionName, WorkspaceName,
(B[m[31m-};
(B[m[32m+use zjj_core::domain::identifiers::{AgentId, BeadId, SessionId, SessionName, WorkspaceName};
(B[m use zjj_core::domain::queue::ClaimState;
 use zjj_core::domain::session::{BranchState, ParentState};
 use zjj_core::domain::workspace::WorkspaceState;
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_state_machine_transitions.rs:76:
 fn test_bead_state_blocked_transitions() {
     let id = BeadId::parse("bd-abc123").expect("valid id");
     let bead = Bead::new(id, "Test", None::<String>).expect("valid bead");
[31m-    let blocked = bead.start().and_then(|b| b.block()).expect("transition valid");
(B[m[32m+    let blocked = bead
(B[m[32m+        .start()
(B[m[32m+        .and_then(|b| b.block())
(B[m[32m+        .expect("transition valid");
(B[m 
     assert!(blocked.is_blocked());
 
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_state_machine_transitions.rs:101:
 fn test_bead_state_deferred_transitions() {
     let id = BeadId::parse("bd-abc123").expect("valid id");
     let bead = Bead::new(id, "Test", None::<String>).expect("valid bead");
[31m-    let deferred = bead.start().and_then(|b| b.defer()).expect("transition valid");
(B[m[32m+    let deferred = bead
(B[m[32m+        .start()
(B[m[32m+        .and_then(|b| b.defer())
(B[m[32m+        .expect("transition valid");
(B[m 
     assert!(deferred.is_deferred());
 
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_state_machine_transitions.rs:131:
     assert!(closed.is_closed());
 
     // Closed is terminal - no transitions allowed
[31m-    assert!(matches!(closed.open(), Err(zjj_core::domain::aggregates::BeadError::CannotModifyClosed)));
(B[m[31m-    assert!(matches!(closed.start(), Err(zjj_core::domain::aggregates::BeadError::CannotModifyClosed)));
(B[m[31m-    assert!(matches!(closed.block(), Err(zjj_core::domain::aggregates::BeadError::CannotModifyClosed)));
(B[m[31m-    assert!(matches!(closed.defer(), Err(zjj_core::domain::aggregates::BeadError::CannotModifyClosed)));
(B[m[31m-    assert!(matches!(closed.close(), Err(zjj_core::domain::aggregates::BeadError::CannotModifyClosed)));
(B[m[32m+    assert!(matches!(
(B[m[32m+        closed.open(),
(B[m[32m+        Err(zjj_core::domain::aggregates::BeadError::CannotModifyClosed)
(B[m[32m+    ));
(B[m[32m+    assert!(matches!(
(B[m[32m+        closed.start(),
(B[m[32m+        Err(zjj_core::domain::aggregates::BeadError::CannotModifyClosed)
(B[m[32m+    ));
(B[m[32m+    assert!(matches!(
(B[m[32m+        closed.block(),
(B[m[32m+        Err(zjj_core::domain::aggregates::BeadError::CannotModifyClosed)
(B[m[32m+    ));
(B[m[32m+    assert!(matches!(
(B[m[32m+        closed.defer(),
(B[m[32m+        Err(zjj_core::domain::aggregates::BeadError::CannotModifyClosed)
(B[m[32m+    ));
(B[m[32m+    assert!(matches!(
(B[m[32m+        closed.close(),
(B[m[32m+        Err(zjj_core::domain::aggregates::BeadError::CannotModifyClosed)
(B[m[32m+    ));
(B[m }
 
 #[test]
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_state_machine_transitions.rs:371:
 #[test]
 fn test_workspace_state_creating_transitions() {
     let name = WorkspaceName::parse("test-creating").expect("valid name");
[31m-    let workspace = Workspace::create(name, std::path::PathBuf::from("/tmp"))
(B[m[31m-        .expect("workspace created");
(B[m[32m+    let workspace =
(B[m[32m+        Workspace::create(name, std::path::PathBuf::from("/tmp")).expect("workspace created");
(B[m 
     assert!(workspace.is_creating());
 
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_state_machine_transitions.rs:404:
 #[test]
 fn test_workspace_state_ready_transitions() {
     let name = WorkspaceName::parse("test-ready").expect("valid name");
[31m-    let workspace = Workspace::create(name, std::path::PathBuf::from("/tmp"))
(B[m[31m-        .expect("workspace created");
(B[m[32m+    let workspace =
(B[m[32m+        Workspace::create(name, std::path::PathBuf::from("/tmp")).expect("workspace created");
(B[m     let ready = workspace.mark_ready().expect("transition valid");
 
     assert!(ready.is_ready());
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_state_machine_transitions.rs:432:
 #[test]
 fn test_workspace_state_active_transitions() {
     let name = WorkspaceName::parse("test-active").expect("valid name");
[31m-    let workspace = Workspace::create(name, std::path::PathBuf::from("/tmp"))
(B[m[31m-        .expect("workspace created");
(B[m[32m+    let workspace =
(B[m[32m+        Workspace::create(name, std::path::PathBuf::from("/tmp")).expect("workspace created");
(B[m     let active = workspace
         .mark_ready()
         .and_then(|w| w.mark_active())
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_state_machine_transitions.rs:459:
 #[test]
 fn test_workspace_state_cleaning_transitions() {
     let name = WorkspaceName::parse("test-cleaning").expect("valid name");
[31m-    let workspace = Workspace::create(name, std::path::PathBuf::from("/tmp"))
(B[m[31m-        .expect("workspace created");
(B[m[32m+    let workspace =
(B[m[32m+        Workspace::create(name, std::path::PathBuf::from("/tmp")).expect("workspace created");
(B[m     let cleaning = workspace
         .mark_ready()
         .and_then(|w| w.mark_active())
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_state_machine_transitions.rs:485:
 #[test]
 fn test_workspace_state_removed_is_terminal() {
     let name = WorkspaceName::parse("test-removed").expect("valid name");
[31m-    let workspace = Workspace::create(name, std::path::PathBuf::from("/tmp"))
(B[m[31m-        .expect("workspace created");
(B[m[32m+    let workspace =
(B[m[32m+        Workspace::create(name, std::path::PathBuf::from("/tmp")).expect("workspace created");
(B[m     let removed = workspace.mark_removed().expect("transition valid");
 
     assert!(removed.is_removed());
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_state_machine_transitions.rs:509:
 
     // Path 1: Creating -> Ready -> Active -> Cleaning -> Removed
     let name1 = WorkspaceName::parse("test-path1").expect("valid name");
[31m-    let workspace1 = Workspace::create(name1, std::path::PathBuf::from("/tmp"))
(B[m[31m-        .expect("workspace created");
(B[m[32m+    let workspace1 =
(B[m[32m+        Workspace::create(name1, std::path::PathBuf::from("/tmp")).expect("workspace created");
(B[m 
     let path1 = workspace1
         .mark_ready()
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_state_machine_transitions.rs:522:
 
     // Path 2: Creating -> Ready -> Cleaning -> Removed
     let name2 = WorkspaceName::parse("test-path2").expect("valid name");
[31m-    let workspace2 = Workspace::create(name2, std::path::PathBuf::from("/tmp"))
(B[m[31m-        .expect("workspace created");
(B[m[32m+    let workspace2 =
(B[m[32m+        Workspace::create(name2, std::path::PathBuf::from("/tmp")).expect("workspace created");
(B[m 
     let path2 = workspace2
         .mark_ready()
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_state_machine_transitions.rs:534:
 
     // Path 3: Creating -> Ready -> Removed
     let name3 = WorkspaceName::parse("test-path3").expect("valid name");
[31m-    let workspace3 = Workspace::create(name3, std::path::PathBuf::from("/tmp"))
(B[m[31m-        .expect("workspace created");
(B[m[32m+    let workspace3 =
(B[m[32m+        Workspace::create(name3, std::path::PathBuf::from("/tmp")).expect("workspace created");
(B[m 
     let path3 = workspace3.mark_ready().and_then(|w| w.mark_removed());
 
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_state_machine_transitions.rs:543:
 
     // Path 4: Creating -> Removed
     let name4 = WorkspaceName::parse("test-path4").expect("valid name");
[31m-    let workspace4 = Workspace::create(name4, std::path::PathBuf::from("/tmp"))
(B[m[31m-        .expect("workspace created");
(B[m[32m+    let workspace4 =
(B[m[32m+        Workspace::create(name4, std::path::PathBuf::from("/tmp")).expect("workspace created");
(B[m 
     let path4 = workspace4.mark_removed();
 
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_state_machine_transitions.rs:697:
     for &from in &states {
         for &to in &states {
             let name = WorkspaceName::parse("test").expect("valid name");
[31m-            let workspace = Workspace::reconstruct(
(B[m[31m-                name,
(B[m[31m-                std::path::PathBuf::from("/tmp"),
(B[m[31m-                from,
(B[m[31m-            )
(B[m[31m-            .expect("reconstruct valid");
(B[m[32m+            let workspace = Workspace::reconstruct(name, std::path::PathBuf::from("/tmp"), from)
(B[m[32m+                .expect("reconstruct valid");
(B[m 
             // Check if can_transition_to matches
             let expected_valid = from.can_transition_to(&to);
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_state_machine_transitions.rs:734:
 #[test]
 fn test_branch_state_coverage() {
     // Test all branch state transitions
[31m-    let states = vec![BranchState::Detached, BranchState::OnBranch {
(B[m[31m-        name: "main".to_string(),
(B[m[31m-    }];
(B[m[32m+    let states = vec![
(B[m[32m+        BranchState::Detached,
(B[m[32m+        BranchState::OnBranch {
(B[m[32m+            name: "main".to_string(),
(B[m[32m+        },
(B[m[32m+    ];
(B[m 
     for from in &states {
         for to in &states {
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_state_machine_transitions.rs:743:
             let id = SessionId::parse("test").expect("valid id");
             let name = SessionName::parse("test").expect("valid name");
 
[31m-            let session = Session::new_root(
(B[m[31m-                id,
(B[m[31m-                name,
(B[m[31m-                from.clone(),
(B[m[31m-                std::path::PathBuf::from("/tmp"),
(B[m[31m-            )
(B[m[31m-            .expect("session created");
(B[m[32m+            let session =
(B[m[32m+                Session::new_root(id, name, from.clone(), std::path::PathBuf::from("/tmp"))
(B[m[32m+                    .expect("session created");
(B[m 
             let result = session.transition_branch(to.clone());
 
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/domain_state_machine_transitions.rs:885:
                 (ClaimState::Claimed { .. }, ClaimState::Expired { .. }) => {
                     entry.expire_claim().map(|_| ())
                 }
[31m-                (ClaimState::Expired { .. }, ClaimState::Unclaimed) => {
(B[m[31m-                    entry.reclaim().map(|_| ())
(B[m[31m-                }
(B[m[32m+                (ClaimState::Expired { .. }, ClaimState::Unclaimed) => entry.reclaim().map(|_| ()),
(B[m                 _ => continue, // Skip invalid combinations
             };
 
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/identifier_properties.rs:33:
 
 use proptest::prelude::*;
 use zjj_core::domain::{
[32m+    agent::AgentState,
(B[m     identifiers::{
         AbsolutePath, AgentId, BeadId, IdentifierError, SessionId, SessionName, TaskId,
         WorkspaceName,
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/identifier_properties.rs:39:
     },
[31m-    agent::AgentState,
(B[m     queue::ClaimState,
     session::{BranchState, ParentState},
 };
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/identifier_properties.rs:92:
 
 /// Strategy for generating valid session IDs
 fn valid_session_id_strategy() -> impl Strategy<Value = String> {
[31m-    prop_oneof![
(B[m[31m-        "[a-zA-Z0-9_-]{1,50}",
(B[m[31m-        "[a-zA-Z][a-zA-Z0-9_-]{0,100}",
(B[m[31m-    ]
(B[m[32m+    prop_oneof!["[a-zA-Z0-9_-]{1,50}", "[a-zA-Z][a-zA-Z0-9_-]{0,100}",]
(B[m }
 
 /// Strategy for generating valid absolute paths (Unix)
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/identifier_properties.rs:438:
         IdentifierError::invalid_hex("test"),
         IdentifierError::not_absolute_path("test"),
         IdentifierError::NullBytesInPath,
[31m-        IdentifierError::NotAscii { value: "test".to_string() },
(B[m[32m+        IdentifierError::NotAscii {
(B[m[32m+            value: "test".to_string(),
(B[m[32m+        },
(B[m         IdentifierError::ContainsPathSeparators,
     ];
 
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/identifier_properties.rs:559:
         for to in &states {
             let can_transition = from.can_transition_to(to);
             let can_transition_again = from.can_transition_to(to);
[31m-            assert_eq!(can_transition, can_transition_again,
(B[m[31m-                "Transition from {:?} to {:?} should be deterministic", from, to);
(B[m[32m+            assert_eq!(
(B[m[32m+                can_transition, can_transition_again,
(B[m[32m+                "Transition from {:?} to {:?} should be deterministic",
(B[m[32m+                from, to
(B[m[32m+            );
(B[m         }
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/identifier_properties.rs:575:
     ];
 
     for state in &states {
[31m-        assert!(!state.can_transition_to(state),
(B[m[31m-            "State {:?} should not allow self-loop transition", state);
(B[m[32m+        assert!(
(B[m[32m+            !state.can_transition_to(state),
(B[m[32m+            "State {:?} should not allow self-loop transition",
(B[m[32m+            state
(B[m[32m+        );
(B[m     }
 }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/identifier_properties.rs:603:
         for to in &states {
             let can_transition = from.can_transition_to(to);
             let can_transition_again = from.can_transition_to(to);
[31m-            assert_eq!(can_transition, can_transition_again,
(B[m[31m-                "ClaimState transition should be deterministic");
(B[m[32m+            assert_eq!(
(B[m[32m+                can_transition, can_transition_again,
(B[m[32m+                "ClaimState transition should be deterministic"
(B[m[32m+            );
(B[m         }
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/identifier_properties.rs:613:
 fn test_branch_state_transition_deterministic() {
     let states = [
         BranchState::Detached,
[31m-        BranchState::OnBranch { name: "main".to_string() },
(B[m[32m+        BranchState::OnBranch {
(B[m[32m+            name: "main".to_string(),
(B[m[32m+        },
(B[m     ];
 
     for from in &states {
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/identifier_properties.rs:620:
         for to in &states {
             let can_transition = from.can_transition_to(to);
             let can_transition_again = from.can_transition_to(to);
[31m-            assert_eq!(can_transition, can_transition_again,
(B[m[31m-                "BranchState transition should be deterministic");
(B[m[32m+            assert_eq!(
(B[m[32m+                can_transition, can_transition_again,
(B[m[32m+                "BranchState transition should be deterministic"
(B[m[32m+            );
(B[m         }
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/identifier_properties.rs:629:
 #[test]
 fn test_parent_state_immutability() {
     let parent = SessionName::parse("parent").expect("valid name");
[31m-    let child = ParentState::ChildOf { parent: parent.clone() };
(B[m[32m+    let child = ParentState::ChildOf {
(B[m[32m+        parent: parent.clone(),
(B[m[32m+    };
(B[m 
     // Root cannot become child
     assert!(!ParentState::Root.can_transition_to(&child));
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/jsonl_schema_validation_test.rs:305:
 
     let variants = vec![
         OutputLine::Summary(
[31m-            Summary::new(SummaryType::Info, Message::new("Test").expect("valid"))
(B[m[31m-                .expect("valid"),
(B[m[32m+            Summary::new(SummaryType::Info, Message::new("Test").expect("valid")).expect("valid"),
(B[m         ),
         OutputLine::Session(
             SessionOutput::new(
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/jsonl_schema_validation_test.rs:518:
 #[test]
 fn test_timestamp_format() {
     // Verify timestamps are millisecond-precision Unix timestamps
[31m-    let summary = Summary::new(
(B[m[31m-        SummaryType::Status,
(B[m[31m-        Message::new("Test").expect("valid"),
(B[m[31m-    )
(B[m[31m-    .unwrap();
(B[m[32m+    let summary = Summary::new(SummaryType::Status, Message::new("Test").expect("valid")).unwrap();
(B[m     let json = serde_json::to_value(&summary).unwrap();
 
     // timestamp should be a number (milliseconds since epoch)
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/jsonl_schema_validation_test.rs:599:
     // Verify actions structure
     let actions = json.get("actions").unwrap().as_array().unwrap();
     assert_eq!(actions.len(), 1);
[31m-    validate_json_structure(
(B[m[31m-        &actions[0],
(B[m[31m-        &["order", "description", "execution"],
(B[m[31m-    );
(B[m[32m+    validate_json_structure(&actions[0], &["order", "description", "execution"]);
(B[m }
 
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/serde_validation_tests.rs:14:
 
 use chrono::{DateTime, Utc};
 use std::path::PathBuf;
[32m+use zjj_core::beads::{
(B[m[32m+    Assignee, BlockedBy, DependsOn, Description, IssueId, IssueState, IssueType, Labels, Priority,
(B[m[32m+    Title,
(B[m[32m+};
(B[m use zjj_core::domain::events::{
     serialize_event, serialize_event_bytes, DomainEvent, EventMetadata, StoredEvent,
 };
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/serde_validation_tests.rs:21:
     AbsolutePath, AgentId, BeadId, QueueEntryId, SessionId, SessionName, TaskId, WorkspaceName,
 };
 use zjj_core::domain::session::{BranchState, ParentState};
[31m-use zjj_core::beads::{
(B[m[31m-    Assignee, BlockedBy, DependsOn, Description, IssueId, IssueState, IssueType, Labels,
(B[m[31m-    Priority, Title,
(B[m[31m-};
(B[m 
 // ============================================================================
 // IDENTIFIER TYPE TESTS
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/serde_validation_tests.rs:51:
 
     // String starting with number should be rejected
     let result: Result<SessionName, _> = serde_json::from_str("\"123-session\"");
[31m-    assert!(result.is_err(), "Session name starting with number should be rejected");
(B[m[32m+    assert!(
(B[m[32m+        result.is_err(),
(B[m[32m+        "Session name starting with number should be rejected"
(B[m[32m+    );
(B[m 
     // String with special characters should be rejected
     let result: Result<SessionName, _> = serde_json::from_str("\"my.session\"");
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/serde_validation_tests.rs:102:
     assert_eq!(json, "\"my-workspace\"");
 
     // Deserialize from JSON
[31m-    let deserialized: WorkspaceName =
(B[m[31m-        serde_json::from_str(&json).expect("deserialization failed");
(B[m[32m+    let deserialized: WorkspaceName = serde_json::from_str(&json).expect("deserialization failed");
(B[m     assert_eq!(deserialized, original);
 }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/serde_validation_tests.rs:135:
 fn test_task_id_rejects_invalid_prefix() {
     // Missing bd- prefix should be rejected
     let result: Result<TaskId, _> = serde_json::from_str("\"abc123\"");
[31m-    assert!(result.is_err(), "Task ID without bd- prefix should be rejected");
(B[m[32m+    assert!(
(B[m[32m+        result.is_err(),
(B[m[32m+        "Task ID without bd- prefix should be rejected"
(B[m[32m+    );
(B[m 
     // Wrong prefix should be rejected
     let result: Result<TaskId, _> = serde_json::from_str("\"task-abc123\"");
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/serde_validation_tests.rs:142:
[31m-    assert!(result.is_err(), "Task ID with wrong prefix should be rejected");
(B[m[32m+    assert!(
(B[m[32m+        result.is_err(),
(B[m[32m+        "Task ID with wrong prefix should be rejected"
(B[m[32m+    );
(B[m }
 
 #[test]
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/serde_validation_tests.rs:166:
 fn test_session_id_rejects_non_ascii() {
     // Non-ASCII characters should be rejected
     let result: Result<SessionId, _> = serde_json::from_str("\"session-日本語\"");
[31m-    assert!(result.is_err(), "Session ID with non-ASCII should be rejected");
(B[m[32m+    assert!(
(B[m[32m+        result.is_err(),
(B[m[32m+        "Session ID with non-ASCII should be rejected"
(B[m[32m+    );
(B[m }
 
 #[test]
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/serde_validation_tests.rs:186:
 fn test_queue_entry_id_rejects_negative() {
     // Negative values should be rejected
     let result: Result<QueueEntryId, _> = serde_json::from_str("-1");
[31m-    assert!(result.is_err(), "Negative queue entry ID should be rejected");
(B[m[32m+    assert!(
(B[m[32m+        result.is_err(),
(B[m[32m+        "Negative queue entry ID should be rejected"
(B[m[32m+    );
(B[m }
 
 #[test]
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/serde_validation_tests.rs:205:
     assert_eq!(json, "\"/home/user/workspace\"");
 
     // Deserialize from JSON
[31m-    let deserialized: AbsolutePath =
(B[m[31m-        serde_json::from_str(&json).expect("deserialization failed");
(B[m[32m+    let deserialized: AbsolutePath = serde_json::from_str(&json).expect("deserialization failed");
(B[m     assert_eq!(deserialized, original);
 }
 
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/serde_validation_tests.rs:333:
         let json = serde_json::to_string(&state).expect("serialization failed");
 
         // Deserialize from JSON
[31m-        let deserialized: IssueState =
(B[m[31m-            serde_json::from_str(&json).expect("deserialization failed");
(B[m[32m+        let deserialized: IssueState = serde_json::from_str(&json).expect("deserialization failed");
(B[m         assert_eq!(deserialized, state);
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/serde_validation_tests.rs:381:
         let json = serde_json::to_string(&priority).expect("serialization failed");
 
         // Deserialize from JSON
[31m-        let deserialized: Priority =
(B[m[31m-            serde_json::from_str(&json).expect("deserialization failed");
(B[m[32m+        let deserialized: Priority = serde_json::from_str(&json).expect("deserialization failed");
(B[m         assert_eq!(deserialized, priority);
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/serde_validation_tests.rs:414:
         let json = serde_json::to_string(&issue_type).expect("serialization failed");
 
         // Deserialize from JSON
[31m-        let deserialized: IssueType =
(B[m[31m-            serde_json::from_str(&json).expect("deserialization failed");
(B[m[32m+        let deserialized: IssueType = serde_json::from_str(&json).expect("deserialization failed");
(B[m         assert_eq!(deserialized, issue_type);
     }
 }
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/serde_validation_tests.rs:516:
 
 #[test]
 fn test_depends_on_json_roundtrip() {
[31m-    let original = DependsOn::new(vec!["issue-1".to_string(), "issue-2".to_string()])
(B[m[31m-        .expect("valid");
(B[m[32m+    let original =
(B[m[32m+        DependsOn::new(vec!["issue-1".to_string(), "issue-2".to_string()]).expect("valid");
(B[m 
     // Serialize to JSON
     let json = serde_json::to_string(&original).expect("serialization failed");
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/serde_validation_tests.rs:567:
     for event in events {
         // JSON roundtrip
         let json = serialize_event(&event).expect("serialization failed");
[31m-        let deserialized = serde_json::from_str::<DomainEvent>(&json)
(B[m[31m-            .expect("deserialization failed");
(B[m[32m+        let deserialized =
(B[m[32m+            serde_json::from_str::<DomainEvent>(&json).expect("deserialization failed");
(B[m         assert_eq!(event, deserialized);
 
         // Binary roundtrip
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/serde_validation_tests.rs:674:
     let now = Utc::now();
     let json = serde_json::to_string(&now).expect("serialization failed");
 
[31m-    let deserialized: DateTime<Utc> =
(B[m[31m-        serde_json::from_str(&json).expect("deserialization failed");
(B[m[32m+    let deserialized: DateTime<Utc> = serde_json::from_str(&json).expect("deserialization failed");
(B[m 
     // Timestamps should survive roundtrip within reasonable precision
     let duration = if deserialized > now {
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/state_machine_transitions.rs:743:
         .iter()
         .filter(|s| s.valid_transitions().is_empty())
         .count();
[31m-    assert_eq!(workspace_terminals, 1, "WorkspaceState should have 1 terminal state");
(B[m[32m+    assert_eq!(
(B[m[32m+        workspace_terminals, 1,
(B[m[32m+        "WorkspaceState should have 1 terminal state"
(B[m[32m+    );
(B[m 
     // Session: Completed, Failed (2 terminal states)
     // Agent: No true terminal states (can always transition)
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/state_machine_transitions.rs:901:
     let workspace_creating = WorkspaceState::Creating;
 
     // Both are in creation phase
[31m-    let can_create_session =
(B[m[31m-        SessionContracts::is_valid_transition(session_creating, "active");
(B[m[32m+    let can_create_session = SessionContracts::is_valid_transition(session_creating, "active");
(B[m     assert!(can_create_session);
     assert!(!workspace_creating.valid_transitions().is_empty());
 }
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Diff in /home/lewis/src/zjj/crates/zjj-core/tests/test_session_validation_boundary.rs:12:
 #![cfg_attr(test, allow(clippy::unwrap_used, clippy::expect_used))]
 
 use zjj_core::{
[31m-    domain::{AbsolutePath, SessionId},
(B[m     domain::session::{BranchState, ParentState},
[32m+    domain::{AbsolutePath, SessionId},
(B[m     output::ValidatedMetadata,
     types::{Session, SessionName, SessionStatus},
     validation::infrastructure::validate_session_workspace_exists,
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
Warning: can't set `wrap_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `format_code_in_doc_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `comment_width = 100`, unstable features are only available in nightly channel.
Warning: can't set `normalize_comments = true`, unstable features are only available in nightly channel.
Warning: can't set `normalize_doc_attributes = true`, unstable features are only available in nightly channel.
Warning: can't set `fn_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `where_single_line = false`, unstable features are only available in nightly channel.
Warning: can't set `imports_granularity = Crate`, unstable features are only available in nightly channel.
Warning: can't set `group_imports = StdExternalCrate`, unstable features are only available in nightly channel.
Warning: can't set `match_arm_blocks = true`, unstable features are only available in nightly channel.
Warning: can't set `trailing_comma = Vertical`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_upper_bound = 1`, unstable features are only available in nightly channel.
Warning: can't set `blank_lines_lower_bound = 0`, unstable features are only available in nightly channel.
