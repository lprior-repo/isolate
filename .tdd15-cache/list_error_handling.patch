--- a/crates/zjj/src/commands/list.rs
+++ b/crates/zjj/src/commands/list.rs
@@ -7,6 +7,7 @@ use serde::Serialize;

 use crate::{
     commands::get_session_db,
+    json_output,
     session::{Session, SessionStatus},
 };

@@ -37,9 +38,12 @@ impl std::fmt::Display for BeadCounts {
 }

 /// Run the list command
 pub fn run(all: bool, json: bool) -> Result<()> {
-    let db = get_session_db()?;
+    // Execute in a closure to allow ? operator while catching errors for JSON mode
+    let result = (|| -> Result<()> {
+        let db = get_session_db()?;

-    // Filter sessions: exclude completed/failed unless --all is used
+        // Filter sessions: exclude completed/failed unless --all is used
-    // We always get all and filter manually since we need multiple exclusions
+        // We always get all and filter manually since we need multiple exclusions
-    let mut sessions = db.list(None)?;
+        let mut sessions = db.list(None)?;

-    // Filter out completed and failed unless --all flag is set
+        // Filter out completed and failed unless --all flag is set
-    if !all {
+        if !all {
-        sessions
+            sessions.retain(|s| {
-            .retain(|s| s.status != SessionStatus::Completed && s.status != SessionStatus::Failed);
+                s.status != SessionStatus::Completed && s.status != SessionStatus::Failed
+            });
-    }
+        }

-    if sessions.is_empty() {
+        if sessions.is_empty() {
-        if json {
+            if json {
-            println!("[]");
+                println!("[]");
-        } else {
+            } else {
-            println!("No sessions found.");
+                println!("No sessions found.");
-            println!("Use 'jjz add <name>' to create a session.");
+                println!("Use 'jjz add <name>' to create a session.");
-        }
+            }
-        return Ok(());
+            return Ok(());
-    }
+        }

-    // Build list items with enhanced data
+        // Build list items with enhanced data
-    let items: Vec<SessionListItem> = sessions
+        let items: Vec<SessionListItem> = sessions
-        .into_iter()
+            .into_iter()
-        .map(|session| {
+            .map(|session| {
-            let changes = get_session_changes(&session.workspace_path);
+                let changes = get_session_changes(&session.workspace_path);
-            let beads = get_beads_count().unwrap_or_default();
+                let beads = get_beads_count().unwrap_or_default();

-            SessionListItem {
+                SessionListItem {
-                name: session.name.clone(),
+                    name: session.name.clone(),
-                status: session.status.to_string(),
+                    status: session.status.to_string(),
-                branch: session.branch.clone().unwrap_or_else(|| "-".to_string()),
+                    branch: session.branch.clone().unwrap_or_else(|| "-".to_string()),
-                changes: changes.map_or_else(|| "-".to_string(), |c| c.to_string()),
+                    changes: changes.map_or_else(|| "-".to_string(), |c| c.to_string()),
-                beads: beads.to_string(),
+                    beads: beads.to_string(),
-                session,
+                    session,
-            }
+                }
-        })
+            })
-        .collect();
+            .collect();

-    if json {
+        if json {
-        output_json(&items)?;
+            output_json(&items)?;
-    } else {
+        } else {
-        output_table(&items);
+            output_table(&items);
-    }
+        }

-    Ok(())
+        Ok(())
+    })();
+
+    // Handle errors in JSON mode
+    if let Err(e) = result {
+        if json {
+            json_output::output_json_error_and_exit(&e);
+        } else {
+            return Err(e);
+        }
+    }
+
+    Ok(())
 }
